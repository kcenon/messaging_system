<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Messaging System: Task Module Configuration Guide</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Messaging System<span id="projectnumber">&#160;1.0.0</span>
   </div>
   <div id="projectbrief">High-Performance Cross-Platform Messaging Framework</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('dc/d1e/md_docs_2task_2CONFIGURATION.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Task Module Configuration Guide</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md1667"></a> This guide covers all configuration options for the Task module.</p>
<h1><a class="anchor" id="autotoc_md1668"></a>
Table of Contents</h1>
<ul>
<li>Task System Configuration</li>
<li>Task Queue Configuration</li>
<li>Worker Pool Configuration</li>
<li>Task Configuration</li>
<li>Environment-Specific Settings</li>
<li>Performance Tuning</li>
</ul>
<hr  />
<h1><a class="anchor" id="autotoc_md1670"></a>
Task System Configuration</h1>
<p>The <code>task_system_config</code> is the main configuration structure for the entire Task system.</p>
<h2><a class="anchor" id="autotoc_md1671"></a>
Structure</h2>
<div class="fragment"><div class="line"><span class="keyword">struct </span>task_system_config {</div>
<div class="line">    task_queue_config queue;</div>
<div class="line">    worker_config worker;</div>
<div class="line">    <span class="keywordtype">bool</span> enable_scheduler = <span class="keyword">true</span>;</div>
<div class="line">    <span class="keywordtype">bool</span> enable_monitoring = <span class="keyword">true</span>;</div>
<div class="line">    std::string result_backend_type = <span class="stringliteral">&quot;memory&quot;</span>;</div>
<div class="line">};</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1672"></a>
Options</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Option   </th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Default   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>queue</code>   </td><td class="markdownTableBodyNone"><code>task_queue_config</code>   </td><td class="markdownTableBodyNone">(see below)   </td><td class="markdownTableBodyNone">Queue configuration    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>worker</code>   </td><td class="markdownTableBodyNone"><code>worker_config</code>   </td><td class="markdownTableBodyNone">(see below)   </td><td class="markdownTableBodyNone">Worker pool configuration    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>enable_scheduler</code>   </td><td class="markdownTableBodyNone"><code>bool</code>   </td><td class="markdownTableBodyNone"><code>true</code>   </td><td class="markdownTableBodyNone">Enable task scheduler    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>enable_monitoring</code>   </td><td class="markdownTableBodyNone"><code>bool</code>   </td><td class="markdownTableBodyNone"><code>true</code>   </td><td class="markdownTableBodyNone">Enable monitoring component    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>result_backend_type</code>   </td><td class="markdownTableBodyNone"><code>std::string</code>   </td><td class="markdownTableBodyNone"><code>"memory"</code>   </td><td class="markdownTableBodyNone">Result storage backend type   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1673"></a>
Example</h2>
<div class="fragment"><div class="line">task_system_config config;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Queue settings</span></div>
<div class="line">config.queue.max_size = 50000;</div>
<div class="line">config.queue.enable_delayed_queue = <span class="keyword">true</span>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Worker settings</span></div>
<div class="line">config.worker.concurrency = 8;</div>
<div class="line">config.worker.queues = {<span class="stringliteral">&quot;default&quot;</span>, <span class="stringliteral">&quot;high-priority&quot;</span>, <span class="stringliteral">&quot;background&quot;</span>};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Enable components</span></div>
<div class="line">config.enable_scheduler = <span class="keyword">true</span>;</div>
<div class="line">config.enable_monitoring = <span class="keyword">true</span>;</div>
<div class="line">config.result_backend_type = <span class="stringliteral">&quot;memory&quot;</span>;</div>
<div class="line"> </div>
<div class="line">task_system system(config);</div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md1675"></a>
Task Queue Configuration</h1>
<p>The <code>task_queue_config</code> controls the task queue behavior.</p>
<h2><a class="anchor" id="autotoc_md1676"></a>
Structure</h2>
<div class="fragment"><div class="line"><span class="keyword">struct </span>task_queue_config {</div>
<div class="line">    <span class="keywordtype">size_t</span> max_size = 100000;</div>
<div class="line">    <span class="keywordtype">bool</span> enable_persistence = <span class="keyword">false</span>;</div>
<div class="line">    std::string persistence_path;</div>
<div class="line">    <span class="keywordtype">bool</span> enable_delayed_queue = <span class="keyword">true</span>;</div>
<div class="line">    std::chrono::milliseconds delayed_poll_interval{1000};</div>
<div class="line">};</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1677"></a>
Options</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Option   </th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Default   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>max_size</code>   </td><td class="markdownTableBodyNone"><code>size_t</code>   </td><td class="markdownTableBodyNone"><code>100000</code>   </td><td class="markdownTableBodyNone">Maximum number of tasks in queue    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>enable_persistence</code>   </td><td class="markdownTableBodyNone"><code>bool</code>   </td><td class="markdownTableBodyNone"><code>false</code>   </td><td class="markdownTableBodyNone">Enable queue persistence    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>persistence_path</code>   </td><td class="markdownTableBodyNone"><code>std::string</code>   </td><td class="markdownTableBodyNone"><code>""</code>   </td><td class="markdownTableBodyNone">Path for persistence storage    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>enable_delayed_queue</code>   </td><td class="markdownTableBodyNone"><code>bool</code>   </td><td class="markdownTableBodyNone"><code>true</code>   </td><td class="markdownTableBodyNone">Enable delayed task scheduling    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>delayed_poll_interval</code>   </td><td class="markdownTableBodyNone"><code>milliseconds</code>   </td><td class="markdownTableBodyNone"><code>1000</code>   </td><td class="markdownTableBodyNone">Poll interval for delayed tasks   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1678"></a>
Persistence Configuration</h2>
<p>When persistence is enabled, tasks survive process restarts:</p>
<div class="fragment"><div class="line">task_queue_config queue_config;</div>
<div class="line">queue_config.enable_persistence = <span class="keyword">true</span>;</div>
<div class="line">queue_config.persistence_path = <span class="stringliteral">&quot;/var/lib/task_queue/&quot;</span>;</div>
<div class="line">queue_config.max_size = 500000;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1679"></a>
Delayed Queue Settings</h2>
<p>For scheduling tasks to run later:</p>
<div class="fragment"><div class="line">task_queue_config queue_config;</div>
<div class="line">queue_config.enable_delayed_queue = <span class="keyword">true</span>;</div>
<div class="line">queue_config.delayed_poll_interval = std::chrono::milliseconds(500);</div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md1681"></a>
Worker Pool Configuration</h1>
<p>The <code>worker_config</code> controls how tasks are executed.</p>
<h2><a class="anchor" id="autotoc_md1682"></a>
Structure</h2>
<div class="fragment"><div class="line"><span class="keyword">struct </span>worker_config {</div>
<div class="line">    <span class="keywordtype">size_t</span> concurrency = std::thread::hardware_concurrency();</div>
<div class="line">    std::vector&lt;std::string&gt; queues = {<span class="stringliteral">&quot;default&quot;</span>};</div>
<div class="line">    std::chrono::milliseconds poll_interval{100};</div>
<div class="line">    <span class="keywordtype">bool</span> prefetch = <span class="keyword">true</span>;</div>
<div class="line">    <span class="keywordtype">size_t</span> prefetch_count = 10;</div>
<div class="line">};</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1683"></a>
Options</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Option   </th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Default   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>concurrency</code>   </td><td class="markdownTableBodyNone"><code>size_t</code>   </td><td class="markdownTableBodyNone">CPU cores   </td><td class="markdownTableBodyNone">Number of worker threads    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>queues</code>   </td><td class="markdownTableBodyNone"><code>vector&lt;string&gt;</code>   </td><td class="markdownTableBodyNone"><code>{"default"}</code>   </td><td class="markdownTableBodyNone">Queues to process    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>poll_interval</code>   </td><td class="markdownTableBodyNone"><code>milliseconds</code>   </td><td class="markdownTableBodyNone"><code>100</code>   </td><td class="markdownTableBodyNone">Time between polling for tasks    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>prefetch</code>   </td><td class="markdownTableBodyNone"><code>bool</code>   </td><td class="markdownTableBodyNone"><code>true</code>   </td><td class="markdownTableBodyNone">Enable task prefetching    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>prefetch_count</code>   </td><td class="markdownTableBodyNone"><code>size_t</code>   </td><td class="markdownTableBodyNone"><code>10</code>   </td><td class="markdownTableBodyNone">Number of tasks to prefetch   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1684"></a>
Concurrency Settings</h2>
<p>Match concurrency to your workload:</p>
<div class="fragment"><div class="line">worker_config worker;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// CPU-bound tasks: use CPU core count</span></div>
<div class="line">worker.concurrency = std::thread::hardware_concurrency();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// I/O-bound tasks: can use more threads</span></div>
<div class="line">worker.concurrency = std::thread::hardware_concurrency() * 2;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Limited resources: constrain threads</span></div>
<div class="line">worker.concurrency = 4;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1685"></a>
Queue Priority</h2>
<p>Queues are processed in the order specified:</p>
<div class="fragment"><div class="line">worker_config worker;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Process critical first, then high, then default</span></div>
<div class="line">worker.queues = {<span class="stringliteral">&quot;critical&quot;</span>, <span class="stringliteral">&quot;high&quot;</span>, <span class="stringliteral">&quot;default&quot;</span>, <span class="stringliteral">&quot;low&quot;</span>};</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1686"></a>
Prefetch Settings</h2>
<p>Prefetching improves throughput for short tasks:</p>
<div class="fragment"><div class="line">worker_config worker;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Enable prefetching with 20 tasks ahead</span></div>
<div class="line">worker.prefetch = <span class="keyword">true</span>;</div>
<div class="line">worker.prefetch_count = 20;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Disable for long-running tasks</span></div>
<div class="line">worker.prefetch = <span class="keyword">false</span>;</div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md1688"></a>
Task Configuration</h1>
<p>Individual task settings via <code>task_config</code>.</p>
<h2><a class="anchor" id="autotoc_md1689"></a>
Structure</h2>
<div class="fragment"><div class="line"><span class="keyword">struct </span>task_config {</div>
<div class="line">    std::chrono::milliseconds timeout{300000};</div>
<div class="line">    <span class="keywordtype">size_t</span> max_retries = 3;</div>
<div class="line">    std::chrono::milliseconds retry_delay{1000};</div>
<div class="line">    <span class="keywordtype">double</span> retry_backoff_multiplier = 2.0;</div>
<div class="line">    message_priority priority = message_priority::normal;</div>
<div class="line">    std::optional&lt;std::chrono::system_clock::time_point&gt; eta;</div>
<div class="line">    std::optional&lt;std::chrono::milliseconds&gt; expires;</div>
<div class="line">    std::string queue_name = <span class="stringliteral">&quot;default&quot;</span>;</div>
<div class="line">    std::vector&lt;std::string&gt; tags;</div>
<div class="line">};</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1690"></a>
Options</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Option   </th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Default   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>timeout</code>   </td><td class="markdownTableBodyNone"><code>milliseconds</code>   </td><td class="markdownTableBodyNone"><code>300000</code> (5min)   </td><td class="markdownTableBodyNone">Task execution timeout    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>max_retries</code>   </td><td class="markdownTableBodyNone"><code>size_t</code>   </td><td class="markdownTableBodyNone"><code>3</code>   </td><td class="markdownTableBodyNone">Maximum retry attempts    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>retry_delay</code>   </td><td class="markdownTableBodyNone"><code>milliseconds</code>   </td><td class="markdownTableBodyNone"><code>1000</code>   </td><td class="markdownTableBodyNone">Initial retry delay    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>retry_backoff_multiplier</code>   </td><td class="markdownTableBodyNone"><code>double</code>   </td><td class="markdownTableBodyNone"><code>2.0</code>   </td><td class="markdownTableBodyNone">Exponential backoff multiplier    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>priority</code>   </td><td class="markdownTableBodyNone"><code>message_priority</code>   </td><td class="markdownTableBodyNone"><code>normal</code>   </td><td class="markdownTableBodyNone">Task priority level    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>eta</code>   </td><td class="markdownTableBodyNone"><code>optional&lt;time_point&gt;</code>   </td><td class="markdownTableBodyNone"><code>nullopt</code>   </td><td class="markdownTableBodyNone">Scheduled execution time    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>expires</code>   </td><td class="markdownTableBodyNone"><code>optional&lt;milliseconds&gt;</code>   </td><td class="markdownTableBodyNone"><code>nullopt</code>   </td><td class="markdownTableBodyNone">Task expiration duration    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>queue_name</code>   </td><td class="markdownTableBodyNone"><code>string</code>   </td><td class="markdownTableBodyNone"><code>"default"</code>   </td><td class="markdownTableBodyNone">Target queue    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>tags</code>   </td><td class="markdownTableBodyNone"><code>vector&lt;string&gt;</code>   </td><td class="markdownTableBodyNone"><code>{}</code>   </td><td class="markdownTableBodyNone">Task tags   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1691"></a>
Using Task Builder</h2>
<div class="fragment"><div class="line"><span class="keyword">auto</span> task = task_builder(<span class="stringliteral">&quot;process.data&quot;</span>)</div>
<div class="line">    .payload(data)</div>
<div class="line">    .timeout(std::chrono::minutes(10))</div>
<div class="line">    .retries(5)</div>
<div class="line">    .retry_delay(std::chrono::seconds(5))</div>
<div class="line">    .backoff(1.5)</div>
<div class="line">    .priority(message_priority::high)</div>
<div class="line">    .queue(<span class="stringliteral">&quot;processing&quot;</span>)</div>
<div class="line">    .tag(<span class="stringliteral">&quot;batch&quot;</span>)</div>
<div class="line">    .tag(<span class="stringliteral">&quot;important&quot;</span>)</div>
<div class="line">    .expires_in(std::chrono::hours(1))</div>
<div class="line">    .build();</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1692"></a>
Priority Levels</h2>
<div class="fragment"><div class="line"><span class="keyword">enum class</span> message_priority {</div>
<div class="line">    lowest = 1,</div>
<div class="line">    low = 3,</div>
<div class="line">    normal = 5,    <span class="comment">// Default</span></div>
<div class="line">    high = 7,</div>
<div class="line">    highest = 9</div>
<div class="line">};</div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md1694"></a>
Environment-Specific Settings</h1>
<h2><a class="anchor" id="autotoc_md1695"></a>
Development Environment</h2>
<div class="fragment"><div class="line">task_system_config dev_config;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Fewer workers for debugging</span></div>
<div class="line">dev_config.worker.concurrency = 2;</div>
<div class="line">dev_config.worker.queues = {<span class="stringliteral">&quot;default&quot;</span>};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Smaller queue for faster feedback</span></div>
<div class="line">dev_config.queue.max_size = 1000;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Short poll interval for responsiveness</span></div>
<div class="line">dev_config.worker.poll_interval = std::chrono::milliseconds(50);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Enable all monitoring</span></div>
<div class="line">dev_config.enable_monitoring = <span class="keyword">true</span>;</div>
<div class="line">dev_config.enable_scheduler = <span class="keyword">true</span>;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1696"></a>
Staging Environment</h2>
<div class="fragment"><div class="line">task_system_config staging_config;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Moderate resources</span></div>
<div class="line">staging_config.worker.concurrency = std::thread::hardware_concurrency() / 2;</div>
<div class="line">staging_config.worker.queues = {<span class="stringliteral">&quot;critical&quot;</span>, <span class="stringliteral">&quot;default&quot;</span>, <span class="stringliteral">&quot;background&quot;</span>};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Production-like queue settings</span></div>
<div class="line">staging_config.queue.max_size = 50000;</div>
<div class="line">staging_config.queue.enable_delayed_queue = <span class="keyword">true</span>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Enable persistence for testing</span></div>
<div class="line">staging_config.queue.enable_persistence = <span class="keyword">true</span>;</div>
<div class="line">staging_config.queue.persistence_path = <span class="stringliteral">&quot;/tmp/task_queue/&quot;</span>;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1697"></a>
Production Environment</h2>
<div class="fragment"><div class="line">task_system_config prod_config;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Full resources</span></div>
<div class="line">prod_config.worker.concurrency = std::thread::hardware_concurrency();</div>
<div class="line">prod_config.worker.queues = {<span class="stringliteral">&quot;critical&quot;</span>, <span class="stringliteral">&quot;high&quot;</span>, <span class="stringliteral">&quot;default&quot;</span>, <span class="stringliteral">&quot;low&quot;</span>, <span class="stringliteral">&quot;background&quot;</span>};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Large queue capacity</span></div>
<div class="line">prod_config.queue.max_size = 500000;</div>
<div class="line">prod_config.queue.enable_delayed_queue = <span class="keyword">true</span>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Enable persistence</span></div>
<div class="line">prod_config.queue.enable_persistence = <span class="keyword">true</span>;</div>
<div class="line">prod_config.queue.persistence_path = <span class="stringliteral">&quot;/var/lib/messaging/task_queue/&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Prefetch for throughput</span></div>
<div class="line">prod_config.worker.prefetch = <span class="keyword">true</span>;</div>
<div class="line">prod_config.worker.prefetch_count = 50;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Enable monitoring</span></div>
<div class="line">prod_config.enable_monitoring = <span class="keyword">true</span>;</div>
<div class="line">prod_config.enable_scheduler = <span class="keyword">true</span>;</div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md1699"></a>
Performance Tuning</h1>
<h2><a class="anchor" id="autotoc_md1700"></a>
High Throughput Configuration</h2>
<p>For processing many short tasks:</p>
<div class="fragment"><div class="line">task_system_config high_throughput;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// More workers</span></div>
<div class="line">high_throughput.worker.concurrency = std::thread::hardware_concurrency() * 2;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Aggressive prefetching</span></div>
<div class="line">high_throughput.worker.prefetch = <span class="keyword">true</span>;</div>
<div class="line">high_throughput.worker.prefetch_count = 100;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Fast polling</span></div>
<div class="line">high_throughput.worker.poll_interval = std::chrono::milliseconds(10);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Large queue</span></div>
<div class="line">high_throughput.queue.max_size = 1000000;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Fast delayed queue polling</span></div>
<div class="line">high_throughput.queue.delayed_poll_interval = std::chrono::milliseconds(100);</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1701"></a>
Low Latency Configuration</h2>
<p>For quick task execution with minimal delay:</p>
<div class="fragment"><div class="line">task_system_config low_latency;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Dedicated workers</span></div>
<div class="line">low_latency.worker.concurrency = std::thread::hardware_concurrency();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Fast polling</span></div>
<div class="line">low_latency.worker.poll_interval = std::chrono::milliseconds(1);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Disable prefetch for immediate processing</span></div>
<div class="line">low_latency.worker.prefetch = <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Single high-priority queue</span></div>
<div class="line">low_latency.worker.queues = {<span class="stringliteral">&quot;realtime&quot;</span>};</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1702"></a>
Resource-Constrained Configuration</h2>
<p>For limited CPU/memory environments:</p>
<div class="fragment"><div class="line">task_system_config constrained;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Limited workers</span></div>
<div class="line">constrained.worker.concurrency = 2;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Single queue</span></div>
<div class="line">constrained.worker.queues = {<span class="stringliteral">&quot;default&quot;</span>};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Smaller queue</span></div>
<div class="line">constrained.queue.max_size = 10000;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Less aggressive prefetching</span></div>
<div class="line">constrained.worker.prefetch = <span class="keyword">true</span>;</div>
<div class="line">constrained.worker.prefetch_count = 5;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Longer poll interval</span></div>
<div class="line">constrained.worker.poll_interval = std::chrono::milliseconds(500);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Disable optional components</span></div>
<div class="line">constrained.enable_scheduler = <span class="keyword">false</span>;</div>
<div class="line">constrained.enable_monitoring = <span class="keyword">false</span>;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1703"></a>
Long-Running Tasks Configuration</h2>
<p>For tasks that take minutes to hours:</p>
<div class="fragment"><div class="line">task_system_config long_running;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Fewer but dedicated workers</span></div>
<div class="line">long_running.worker.concurrency = 4;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Disable prefetch (one task per worker is enough)</span></div>
<div class="line">long_running.worker.prefetch = <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Longer poll interval (tasks are long anyway)</span></div>
<div class="line">long_running.worker.poll_interval = std::chrono::seconds(1);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Task defaults for long operations</span></div>
<div class="line"><span class="comment">// (Use task_builder for individual tasks)</span></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1704"></a>
Memory Optimization</h2>
<div class="fragment"><div class="line">task_system_config memory_optimized;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Limit queue size</span></div>
<div class="line">memory_optimized.queue.max_size = 10000;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Smaller prefetch buffer</span></div>
<div class="line">memory_optimized.worker.prefetch_count = 5;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Enable persistence to offload memory</span></div>
<div class="line">memory_optimized.queue.enable_persistence = <span class="keyword">true</span>;</div>
<div class="line">memory_optimized.queue.persistence_path = <span class="stringliteral">&quot;/var/lib/task_queue/&quot;</span>;</div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md1706"></a>
Configuration Recommendations</h1>
<h2><a class="anchor" id="autotoc_md1707"></a>
By Workload Type</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Workload   </th><th class="markdownTableHeadNone">Concurrency   </th><th class="markdownTableHeadNone">Prefetch   </th><th class="markdownTableHeadNone">Poll Interval   </th><th class="markdownTableHeadNone">Queue Size    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">CPU-bound   </td><td class="markdownTableBodyNone">CPU cores   </td><td class="markdownTableBodyNone">Medium   </td><td class="markdownTableBodyNone">100ms   </td><td class="markdownTableBodyNone">Medium    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">I/O-bound   </td><td class="markdownTableBodyNone">2x CPU cores   </td><td class="markdownTableBodyNone">High   </td><td class="markdownTableBodyNone">50ms   </td><td class="markdownTableBodyNone">Large    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Mixed   </td><td class="markdownTableBodyNone">1.5x CPU cores   </td><td class="markdownTableBodyNone">Medium   </td><td class="markdownTableBodyNone">100ms   </td><td class="markdownTableBodyNone">Medium    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Long-running   </td><td class="markdownTableBodyNone">Low (2-4)   </td><td class="markdownTableBodyNone">Disabled   </td><td class="markdownTableBodyNone">1s   </td><td class="markdownTableBodyNone">Small    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Real-time   </td><td class="markdownTableBodyNone">CPU cores   </td><td class="markdownTableBodyNone">Disabled   </td><td class="markdownTableBodyNone">1-10ms   </td><td class="markdownTableBodyNone">Small   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1708"></a>
By Scale</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Scale   </th><th class="markdownTableHeadNone">Workers   </th><th class="markdownTableHeadNone">Queue Size   </th><th class="markdownTableHeadNone">Persistence   </th><th class="markdownTableHeadNone">Monitoring    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Small (&lt;100 tasks/min)   </td><td class="markdownTableBodyNone">2-4   </td><td class="markdownTableBodyNone">10,000   </td><td class="markdownTableBodyNone">Optional   </td><td class="markdownTableBodyNone">Optional    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Medium (100-1000/min)   </td><td class="markdownTableBodyNone">4-8   </td><td class="markdownTableBodyNone">50,000   </td><td class="markdownTableBodyNone">Recommended   </td><td class="markdownTableBodyNone">Recommended    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Large (1000-10000/min)   </td><td class="markdownTableBodyNone">8-16   </td><td class="markdownTableBodyNone">500,000   </td><td class="markdownTableBodyNone">Required   </td><td class="markdownTableBodyNone">Required    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Very Large (&gt;10000/min)   </td><td class="markdownTableBodyNone">16+   </td><td class="markdownTableBodyNone">1,000,000+   </td><td class="markdownTableBodyNone">Required   </td><td class="markdownTableBodyNone">Required   </td></tr>
</table>
<hr  />
<h1><a class="anchor" id="autotoc_md1710"></a>
Related Documentation</h1>
<ul>
<li><a class="el" href="../../d9/dff/md_docs_2task_2QUICK__START.html">Quick Start Guide</a></li>
<li><a class="el" href="../../d1/d5e/md_docs_2task_2ARCHITECTURE.html">Architecture Guide</a></li>
<li><a class="el" href="../../df/d18/md_docs_2task_2API__REFERENCE.html">API Reference</a></li>
<li><a class="el" href="../../d5/dd2/md_docs_2task_2PATTERNS.html">Patterns Guide</a></li>
<li><a class="el" href="../../dd/df5/md_docs_2task_2TROUBLESHOOTING.html">Troubleshooting</a> </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
