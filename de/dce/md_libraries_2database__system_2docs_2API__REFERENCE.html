<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Messaging System: Database System API Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Messaging System<span id="projectnumber">&#160;1.0.0</span>
   </div>
   <div id="projectbrief">High-Performance Cross-Platform Messaging Framework</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('de/dce/md_libraries_2database__system_2docs_2API__REFERENCE.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Database System API Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md514"></a> Complete API reference for the Database System C++20 library with multi-backend support, connection pooling, and query builders.</p>
<h1><a class="anchor" id="autotoc_md515"></a>
Table of Contents</h1>
<ul>
<li>Core Classes</li>
<li>Database Manager</li>
<li>Connection Pooling</li>
<li>Query Builders</li>
<li>ORM Framework</li>
<li>Performance Monitoring</li>
<li>Security Framework</li>
<li>Async Operations</li>
<li>Database Types</li>
<li>Error Handling</li>
<li>Examples</li>
</ul>
<h1><a class="anchor" id="autotoc_md516"></a>
Core Classes</h1>
<h2><a class="anchor" id="autotoc_md517"></a>
database_base</h2>
<p>Abstract base class for all database implementations.</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>database_base</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">virtual</span> ~database_base() = <span class="keywordflow">default</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Database identification</span></div>
<div class="line">    <span class="keyword">virtual</span> database_types database_type() = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Connection management</span></div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> connect(<span class="keyword">const</span> std::string&amp; connection_string) = 0;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> disconnect() = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Query operations</span></div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> create_query(<span class="keyword">const</span> std::string&amp; query_string) = 0;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> insert_query(<span class="keyword">const</span> std::string&amp; query_string) = 0;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> update_query(<span class="keyword">const</span> std::string&amp; query_string) = 0;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> delete_query(<span class="keyword">const</span> std::string&amp; query_string) = 0;</div>
<div class="line">    <span class="keyword">virtual</span> database_result select_query(<span class="keyword">const</span> std::string&amp; query_string) = 0;</div>
<div class="line">};</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md518"></a>
database_manager</h2>
<p>Singleton class for managing database connections and operations.</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>database_manager</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="comment">// Singleton access</span></div>
<div class="line">    <span class="keyword">static</span> database_manager&amp; handle();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Database configuration</span></div>
<div class="line">    <span class="keywordtype">bool</span> set_mode(<span class="keyword">const</span> database_types&amp; database_type);</div>
<div class="line">    database_types database_type();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Connection management</span></div>
<div class="line">    <span class="keywordtype">bool</span> connect(<span class="keyword">const</span> std::string&amp; connection_string);</div>
<div class="line">    <span class="keywordtype">bool</span> disconnect();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Query operations</span></div>
<div class="line">    <span class="keywordtype">bool</span> create_query(<span class="keyword">const</span> std::string&amp; query_string);</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> insert_query(<span class="keyword">const</span> std::string&amp; query_string);</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> update_query(<span class="keyword">const</span> std::string&amp; query_string);</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> delete_query(<span class="keyword">const</span> std::string&amp; query_string);</div>
<div class="line">    database_result select_query(<span class="keyword">const</span> std::string&amp; query_string);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Phase 3: Advanced Features</span></div>
<div class="line">    <span class="keywordtype">bool</span> create_connection_pool(database_types db_type, <span class="keyword">const</span> connection_pool_config&amp; config);</div>
<div class="line">    std::shared_ptr&lt;connection_pool_base&gt; get_connection_pool(database_types db_type);</div>
<div class="line">    std::map&lt;database_types, connection_stats&gt; get_pool_stats() <span class="keyword">const</span>;</div>
<div class="line">    query_builder create_query_builder();</div>
<div class="line">    query_builder create_query_builder(database_types db_type);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Phase 4: Enterprise Features</span></div>
<div class="line">    <span class="keywordtype">bool</span> execute_query(<span class="keyword">const</span> std::string&amp; query_string);</div>
<div class="line">    std::shared_ptr&lt;orm::entity_manager&gt; get_entity_manager();</div>
<div class="line">    std::shared_ptr&lt;monitoring::performance_monitor&gt; get_performance_monitor();</div>
<div class="line">    std::shared_ptr&lt;security::access_control&gt; get_access_control();</div>
<div class="line">    std::shared_ptr&lt;async::async_database&gt; get_async_database();</div>
<div class="line">};</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md519"></a>
Database Manager</h1>
<h2><a class="anchor" id="autotoc_md520"></a>
Basic Usage</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../d9/da9/database__manager_8h.html">database/database_manager.h</a>&gt;</span></div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="../../da/df2/namespacedatabase.html">database</a>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Get singleton instance</span></div>
<div class="line"><a class="code hl_class" href="../../df/d8d/classdatabase_1_1database__manager.html">database_manager</a>&amp; db = database_manager::handle();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Set database type</span></div>
<div class="line">db.set_mode(database_types::postgres);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Connect</span></div>
<div class="line">std::string conn_str = <span class="stringliteral">&quot;host=localhost port=5432 dbname=test user=admin password=secret&quot;</span>;</div>
<div class="line"><span class="keywordflow">if</span> (!db.connect(conn_str)) {</div>
<div class="line">    <span class="comment">// Handle connection error</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Execute queries</span></div>
<div class="line">db.create_query(<span class="stringliteral">&quot;CREATE TABLE users (id SERIAL PRIMARY KEY, name VARCHAR(100))&quot;</span>);</div>
<div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> rows = db.insert_query(<span class="stringliteral">&quot;INSERT INTO users (name) VALUES (&#39;John&#39;)&quot;</span>);</div>
<div class="line"><a class="code hl_typedef" href="../../da/df2/namespacedatabase.html#aefd19fdc143c6142e8e67853b536103a">database_result</a> result = db.select_query(<span class="stringliteral">&quot;SELECT * FROM users&quot;</span>);</div>
<div class="ttc" id="aclassdatabase_1_1database__manager_html"><div class="ttname"><a href="../../df/d8d/classdatabase_1_1database__manager.html">database::database_manager</a></div><div class="ttdoc">Manages database connections and operations in a singleton pattern.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/da9/database__manager_8h_source.html#l00056">database_manager.h:57</a></div></div>
<div class="ttc" id="adatabase__manager_8h_html"><div class="ttname"><a href="../../d9/da9/database__manager_8h.html">database_manager.h</a></div></div>
<div class="ttc" id="anamespacedatabase_html"><div class="ttname"><a href="../../da/df2/namespacedatabase.html">database</a></div><div class="ttdef"><b>Definition</b> <a href="../../da/dc5/async__operations_8h_source.html#l00051">async_operations.h:52</a></div></div>
<div class="ttc" id="anamespacedatabase_html_aefd19fdc143c6142e8e67853b536103a"><div class="ttname"><a href="../../da/df2/namespacedatabase.html#aefd19fdc143c6142e8e67853b536103a">database::database_result</a></div><div class="ttdeci">std::vector&lt; database_row &gt; database_result</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d46/database__base_8h_source.html#l00049">database_base.h:49</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md521"></a>
Supported Methods</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Description   </th><th class="markdownTableHeadNone">Returns    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>set_mode(database_types)</code>   </td><td class="markdownTableBodyNone">Set database backend type   </td><td class="markdownTableBodyNone"><code>bool</code> success    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>database_type()</code>   </td><td class="markdownTableBodyNone">Get current database type   </td><td class="markdownTableBodyNone"><code>database_types</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>connect(connection_string)</code>   </td><td class="markdownTableBodyNone">Connect to database   </td><td class="markdownTableBodyNone"><code>bool</code> success    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>disconnect()</code>   </td><td class="markdownTableBodyNone">Disconnect from database   </td><td class="markdownTableBodyNone"><code>bool</code> success    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>create_query(query)</code>   </td><td class="markdownTableBodyNone">Execute DDL query   </td><td class="markdownTableBodyNone"><code>bool</code> success    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>insert_query(query)</code>   </td><td class="markdownTableBodyNone">Execute INSERT query   </td><td class="markdownTableBodyNone"><code>unsigned int</code> rows affected    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>update_query(query)</code>   </td><td class="markdownTableBodyNone">Execute UPDATE query   </td><td class="markdownTableBodyNone"><code>unsigned int</code> rows affected    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>delete_query(query)</code>   </td><td class="markdownTableBodyNone">Execute DELETE query   </td><td class="markdownTableBodyNone"><code>unsigned int</code> rows affected    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>select_query(query)</code>   </td><td class="markdownTableBodyNone">Execute SELECT query   </td><td class="markdownTableBodyNone"><code>database_result</code>   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md522"></a>
Connection Pooling</h1>
<h2><a class="anchor" id="autotoc_md523"></a>
connection_pool_config</h2>
<p>Configuration structure for connection pools.</p>
<div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code hl_struct" href="../../d2/da7/structdatabase_1_1connection__pool__config.html">connection_pool_config</a></div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">size_t</span> min_connections = 2;                              <span class="comment">// Minimum connections to maintain</span></div>
<div class="line">    <span class="keywordtype">size_t</span> max_connections = 20;                             <span class="comment">// Maximum connections allowed</span></div>
<div class="line">    std::chrono::milliseconds acquire_timeout{5000};         <span class="comment">// Timeout for acquiring connections</span></div>
<div class="line">    std::chrono::milliseconds idle_timeout{30000};           <span class="comment">// Timeout for idle connections</span></div>
<div class="line">    std::chrono::milliseconds health_check_interval{60000};   <span class="comment">// Health check interval</span></div>
<div class="line">    <span class="keywordtype">bool</span> enable_health_checks = <span class="keyword">true</span>;                        <span class="comment">// Enable periodic health checks</span></div>
<div class="line">    std::string connection_string;                           <span class="comment">// Database connection string</span></div>
<div class="line">};</div>
<div class="ttc" id="astructdatabase_1_1connection__pool__config_html"><div class="ttname"><a href="../../d2/da7/structdatabase_1_1connection__pool__config.html">database::connection_pool_config</a></div><div class="ttdoc">Configuration parameters for connection pools.</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dbc/connection__pool_8h_source.html#l00052">connection_pool.h:53</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md524"></a>
connection_stats</h2>
<p>Statistics structure for monitoring connection pools.</p>
<div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code hl_struct" href="../../d2/ddd/structdatabase_1_1connection__stats.html">connection_stats</a></div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">size_t</span> total_connections = 0;                             <span class="comment">// Total connections created</span></div>
<div class="line">    <span class="keywordtype">size_t</span> active_connections = 0;                            <span class="comment">// Currently active connections</span></div>
<div class="line">    <span class="keywordtype">size_t</span> available_connections = 0;                         <span class="comment">// Available connections in pool</span></div>
<div class="line">    <span class="keywordtype">size_t</span> failed_acquisitions = 0;                           <span class="comment">// Number of failed acquisitions</span></div>
<div class="line">    <span class="keywordtype">size_t</span> successful_acquisitions = 0;                       <span class="comment">// Number of successful acquisitions</span></div>
<div class="line">    std::chrono::steady_clock::time_point last_health_check;  <span class="comment">// Last health check time</span></div>
<div class="line">};</div>
<div class="ttc" id="astructdatabase_1_1connection__stats_html"><div class="ttname"><a href="../../d2/ddd/structdatabase_1_1connection__stats.html">database::connection_stats</a></div><div class="ttdoc">Statistics for connection pool monitoring.</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dbc/connection__pool_8h_source.html#l00067">connection_pool.h:68</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md525"></a>
connection_pool_base</h2>
<p>Abstract base class for connection pools.</p>
<div class="fragment"><div class="line"><span class="keyword">class </span><a class="code hl_class" href="../../d5/d24/classdatabase_1_1connection__pool__base.html">connection_pool_base</a></div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">virtual</span> <a class="code hl_class" href="../../d5/d24/classdatabase_1_1connection__pool__base.html">~connection_pool_base</a>() = <span class="keywordflow">default</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">virtual</span> std::shared_ptr&lt;connection_wrapper&gt; acquire_connection() = 0;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> release_connection(std::shared_ptr&lt;connection_wrapper&gt; connection) = 0;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">size_t</span> active_connections() <span class="keyword">const</span> = 0;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">size_t</span> available_connections() <span class="keyword">const</span> = 0;</div>
<div class="line">    <span class="keyword">virtual</span> <a class="code hl_struct" href="../../d2/ddd/structdatabase_1_1connection__stats.html">connection_stats</a> get_stats() <span class="keyword">const</span> = 0;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> shutdown() = 0;</div>
<div class="line">};</div>
<div class="ttc" id="aclassdatabase_1_1connection__pool__base_html"><div class="ttname"><a href="../../d5/d24/classdatabase_1_1connection__pool__base.html">database::connection_pool_base</a></div><div class="ttdoc">Abstract base class for database connection pools.</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dbc/connection__pool_8h_source.html#l00108">connection_pool.h:109</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md526"></a>
Usage Example</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../d9/da9/database__manager_8h.html">database/database_manager.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../d6/dbc/connection__pool_8h.html">database/connection_pool.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Configure connection pool</span></div>
<div class="line"><a class="code hl_struct" href="../../d2/da7/structdatabase_1_1connection__pool__config.html">connection_pool_config</a> config;</div>
<div class="line">config.min_connections = 5;</div>
<div class="line">config.max_connections = 20;</div>
<div class="line">config.acquire_timeout = std::chrono::seconds(5);</div>
<div class="line">config.connection_string = <span class="stringliteral">&quot;host=localhost port=5432 dbname=test user=admin password=secret&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Create pool</span></div>
<div class="line"><a class="code hl_class" href="../../df/d8d/classdatabase_1_1database__manager.html">database_manager</a>&amp; db = database_manager::handle();</div>
<div class="line"><span class="keywordflow">if</span> (!db.create_connection_pool(database_types::postgres, config)) {</div>
<div class="line">    <span class="comment">// Handle error</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Use pool</span></div>
<div class="line"><span class="keyword">auto</span> pool = db.get_connection_pool(database_types::postgres);</div>
<div class="line"><span class="keyword">auto</span> connection = pool-&gt;acquire_connection();</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> (connection) {</div>
<div class="line">    <span class="comment">// Use connection</span></div>
<div class="line">    <span class="keyword">auto</span> result = connection-&gt;select_query(<span class="stringliteral">&quot;SELECT * FROM users&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Connection automatically returned to pool when destroyed</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Monitor statistics</span></div>
<div class="line"><span class="keyword">auto</span> stats = db.get_pool_stats();</div>
<div class="line"><span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [db_type, stat] : stats) {</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Active: &quot;</span> &lt;&lt; stat.active_connections</div>
<div class="line">              &lt;&lt; <span class="stringliteral">&quot; Available: &quot;</span> &lt;&lt; stat.available_connections &lt;&lt; std::endl;</div>
<div class="line">}</div>
<div class="ttc" id="aconnection__pool_8h_html"><div class="ttname"><a href="../../d6/dbc/connection__pool_8h.html">connection_pool.h</a></div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md527"></a>
Query Builders</h1>
<h2><a class="anchor" id="autotoc_md528"></a>
query_builder</h2>
<p>Universal query builder that adapts to different database types.</p>
<div class="fragment"><div class="line"><span class="keyword">class </span><a class="code hl_class" href="../../d6/d4b/classdatabase_1_1query__builder.html">query_builder</a></div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">explicit</span> <a class="code hl_class" href="../../d6/d4b/classdatabase_1_1query__builder.html">query_builder</a>(<a class="code hl_enumeration" href="../../da/df2/namespacedatabase.html#a9b50450d1f477d5f2fea4e15975023e4">database_types</a> db_type = database_types::none);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Database type selection</span></div>
<div class="line">    <a class="code hl_class" href="../../d6/d4b/classdatabase_1_1query__builder.html">query_builder</a>&amp; for_database(<a class="code hl_enumeration" href="../../da/df2/namespacedatabase.html#a9b50450d1f477d5f2fea4e15975023e4">database_types</a> db_type);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// SQL-style interface (PostgreSQL, MySQL, SQLite)</span></div>
<div class="line">    <a class="code hl_class" href="../../d6/d4b/classdatabase_1_1query__builder.html">query_builder</a>&amp; select(<span class="keyword">const</span> std::vector&lt;std::string&gt;&amp; columns);</div>
<div class="line">    <a class="code hl_class" href="../../d6/d4b/classdatabase_1_1query__builder.html">query_builder</a>&amp; from(<span class="keyword">const</span> std::string&amp; table);</div>
<div class="line">    <a class="code hl_class" href="../../d6/d4b/classdatabase_1_1query__builder.html">query_builder</a>&amp; where(<span class="keyword">const</span> std::string&amp; field, <span class="keyword">const</span> std::string&amp; op, <span class="keyword">const</span> <a class="code hl_typedef" href="../../da/df2/namespacedatabase.html#a207a0dd48101812e44efc3772079828f">database_value</a>&amp; value);</div>
<div class="line">    <a class="code hl_class" href="../../d6/d4b/classdatabase_1_1query__builder.html">query_builder</a>&amp; join(<span class="keyword">const</span> std::string&amp; table, <span class="keyword">const</span> std::string&amp; condition);</div>
<div class="line">    <a class="code hl_class" href="../../d6/d4b/classdatabase_1_1query__builder.html">query_builder</a>&amp; order_by(<span class="keyword">const</span> std::string&amp; column, <a class="code hl_enumeration" href="../../da/df2/namespacedatabase.html#abd03ff7ff96381e479fb0a5add52a92d">sort_order</a> order = sort_order::asc);</div>
<div class="line">    <a class="code hl_class" href="../../d6/d4b/classdatabase_1_1query__builder.html">query_builder</a>&amp; limit(<span class="keywordtype">size_t</span> count);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// NoSQL-style interface</span></div>
<div class="line">    <a class="code hl_class" href="../../d6/d4b/classdatabase_1_1query__builder.html">query_builder</a>&amp; collection(<span class="keyword">const</span> std::string&amp; name); <span class="comment">// MongoDB</span></div>
<div class="line">    <a class="code hl_class" href="../../d6/d4b/classdatabase_1_1query__builder.html">query_builder</a>&amp; key(<span class="keyword">const</span> std::string&amp; key);         <span class="comment">// Redis</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Universal operations</span></div>
<div class="line">    <a class="code hl_class" href="../../d6/d4b/classdatabase_1_1query__builder.html">query_builder</a>&amp; insert(<span class="keyword">const</span> std::map&lt;std::string, database_value&gt;&amp; data);</div>
<div class="line">    <a class="code hl_class" href="../../d6/d4b/classdatabase_1_1query__builder.html">query_builder</a>&amp; update(<span class="keyword">const</span> std::map&lt;std::string, database_value&gt;&amp; data);</div>
<div class="line">    <a class="code hl_class" href="../../d6/d4b/classdatabase_1_1query__builder.html">query_builder</a>&amp; remove(); <span class="comment">// DELETE/DROP</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Build and execute</span></div>
<div class="line">    std::string build() <span class="keyword">const</span>;</div>
<div class="line">    <a class="code hl_typedef" href="../../da/df2/namespacedatabase.html#aefd19fdc143c6142e8e67853b536103a">database_result</a> execute(<a class="code hl_class" href="../../d5/df0/classdatabase_1_1database__base.html">database_base</a>* db) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Reset builder</span></div>
<div class="line">    <span class="keywordtype">void</span> reset();</div>
<div class="line">};</div>
<div class="ttc" id="aclassdatabase_1_1database__base_html"><div class="ttname"><a href="../../d5/df0/classdatabase_1_1database__base.html">database::database_base</a></div><div class="ttdoc">Abstract base class defining common database operations.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d46/database__base_8h_source.html#l00059">database_base.h:60</a></div></div>
<div class="ttc" id="aclassdatabase_1_1query__builder_html"><div class="ttname"><a href="../../d6/d4b/classdatabase_1_1query__builder.html">database::query_builder</a></div><div class="ttdoc">Universal query builder that adapts to different database types.</div><div class="ttdef"><b>Definition</b> <a href="../../db/d0a/query__builder_8h_source.html#l00313">query_builder.h:314</a></div></div>
<div class="ttc" id="anamespacedatabase_html_a207a0dd48101812e44efc3772079828f"><div class="ttname"><a href="../../da/df2/namespacedatabase.html#a207a0dd48101812e44efc3772079828f">database::database_value</a></div><div class="ttdeci">std::variant&lt; std::string, int64_t, double, bool, std::nullptr_t &gt; database_value</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d46/database__base_8h_source.html#l00047">database_base.h:47</a></div></div>
<div class="ttc" id="anamespacedatabase_html_a9b50450d1f477d5f2fea4e15975023e4"><div class="ttname"><a href="../../da/df2/namespacedatabase.html#a9b50450d1f477d5f2fea4e15975023e4">database::database_types</a></div><div class="ttdeci">database_types</div><div class="ttdoc">Represents various database backends or modes.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/dac/database__types_8h_source.html#l00019">database_types.h:19</a></div></div>
<div class="ttc" id="anamespacedatabase_html_abd03ff7ff96381e479fb0a5add52a92d"><div class="ttname"><a href="../../da/df2/namespacedatabase.html#abd03ff7ff96381e479fb0a5add52a92d">database::sort_order</a></div><div class="ttdeci">sort_order</div><div class="ttdoc">Sort order for ORDER BY clauses.</div><div class="ttdef"><b>Definition</b> <a href="../../db/d0a/query__builder_8h_source.html#l00063">query_builder.h:64</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md529"></a>
sql_query_builder</h2>
<p>Specialized query builder for SQL databases.</p>
<div class="fragment"><div class="line"><span class="keyword">class </span><a class="code hl_class" href="../../d7/d7f/classdatabase_1_1sql__query__builder.html">sql_query_builder</a></div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="comment">// SELECT operations</span></div>
<div class="line">    <a class="code hl_class" href="../../d7/d7f/classdatabase_1_1sql__query__builder.html">sql_query_builder</a>&amp; select(<span class="keyword">const</span> std::vector&lt;std::string&gt;&amp; columns);</div>
<div class="line">    <a class="code hl_class" href="../../d7/d7f/classdatabase_1_1sql__query__builder.html">sql_query_builder</a>&amp; select(<span class="keyword">const</span> std::string&amp; column);</div>
<div class="line">    <a class="code hl_class" href="../../d7/d7f/classdatabase_1_1sql__query__builder.html">sql_query_builder</a>&amp; select_raw(<span class="keyword">const</span> std::string&amp; raw_select);</div>
<div class="line">    <a class="code hl_class" href="../../d7/d7f/classdatabase_1_1sql__query__builder.html">sql_query_builder</a>&amp; from(<span class="keyword">const</span> std::string&amp; table);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// WHERE conditions</span></div>
<div class="line">    <a class="code hl_class" href="../../d7/d7f/classdatabase_1_1sql__query__builder.html">sql_query_builder</a>&amp; where(<span class="keyword">const</span> std::string&amp; field, <span class="keyword">const</span> std::string&amp; op, <span class="keyword">const</span> <a class="code hl_typedef" href="../../da/df2/namespacedatabase.html#a207a0dd48101812e44efc3772079828f">database_value</a>&amp; value);</div>
<div class="line">    <a class="code hl_class" href="../../d7/d7f/classdatabase_1_1sql__query__builder.html">sql_query_builder</a>&amp; where(<span class="keyword">const</span> <a class="code hl_class" href="../../d6/da8/classdatabase_1_1query__condition.html">query_condition</a>&amp; condition);</div>
<div class="line">    <a class="code hl_class" href="../../d7/d7f/classdatabase_1_1sql__query__builder.html">sql_query_builder</a>&amp; where_raw(<span class="keyword">const</span> std::string&amp; raw_where);</div>
<div class="line">    <a class="code hl_class" href="../../d7/d7f/classdatabase_1_1sql__query__builder.html">sql_query_builder</a>&amp; or_where(<span class="keyword">const</span> std::string&amp; field, <span class="keyword">const</span> std::string&amp; op, <span class="keyword">const</span> <a class="code hl_typedef" href="../../da/df2/namespacedatabase.html#a207a0dd48101812e44efc3772079828f">database_value</a>&amp; value);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// JOIN operations</span></div>
<div class="line">    <a class="code hl_class" href="../../d7/d7f/classdatabase_1_1sql__query__builder.html">sql_query_builder</a>&amp; join(<span class="keyword">const</span> std::string&amp; table, <span class="keyword">const</span> std::string&amp; condition, <a class="code hl_enumeration" href="../../da/df2/namespacedatabase.html#afc7f2e426d6384a1dce826746ec2adf0">join_type</a> type = join_type::inner);</div>
<div class="line">    <a class="code hl_class" href="../../d7/d7f/classdatabase_1_1sql__query__builder.html">sql_query_builder</a>&amp; left_join(<span class="keyword">const</span> std::string&amp; table, <span class="keyword">const</span> std::string&amp; condition);</div>
<div class="line">    <a class="code hl_class" href="../../d7/d7f/classdatabase_1_1sql__query__builder.html">sql_query_builder</a>&amp; right_join(<span class="keyword">const</span> std::string&amp; table, <span class="keyword">const</span> std::string&amp; condition);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// GROUP BY and HAVING</span></div>
<div class="line">    <a class="code hl_class" href="../../d7/d7f/classdatabase_1_1sql__query__builder.html">sql_query_builder</a>&amp; group_by(<span class="keyword">const</span> std::vector&lt;std::string&gt;&amp; columns);</div>
<div class="line">    <a class="code hl_class" href="../../d7/d7f/classdatabase_1_1sql__query__builder.html">sql_query_builder</a>&amp; group_by(<span class="keyword">const</span> std::string&amp; column);</div>
<div class="line">    <a class="code hl_class" href="../../d7/d7f/classdatabase_1_1sql__query__builder.html">sql_query_builder</a>&amp; having(<span class="keyword">const</span> std::string&amp; condition);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// ORDER BY</span></div>
<div class="line">    <a class="code hl_class" href="../../d7/d7f/classdatabase_1_1sql__query__builder.html">sql_query_builder</a>&amp; order_by(<span class="keyword">const</span> std::string&amp; column, <a class="code hl_enumeration" href="../../da/df2/namespacedatabase.html#abd03ff7ff96381e479fb0a5add52a92d">sort_order</a> order = sort_order::asc);</div>
<div class="line">    <a class="code hl_class" href="../../d7/d7f/classdatabase_1_1sql__query__builder.html">sql_query_builder</a>&amp; order_by_raw(<span class="keyword">const</span> std::string&amp; raw_order);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// LIMIT and OFFSET</span></div>
<div class="line">    <a class="code hl_class" href="../../d7/d7f/classdatabase_1_1sql__query__builder.html">sql_query_builder</a>&amp; limit(<span class="keywordtype">size_t</span> count);</div>
<div class="line">    <a class="code hl_class" href="../../d7/d7f/classdatabase_1_1sql__query__builder.html">sql_query_builder</a>&amp; offset(<span class="keywordtype">size_t</span> count);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// INSERT operations</span></div>
<div class="line">    <a class="code hl_class" href="../../d7/d7f/classdatabase_1_1sql__query__builder.html">sql_query_builder</a>&amp; insert_into(<span class="keyword">const</span> std::string&amp; table);</div>
<div class="line">    <a class="code hl_class" href="../../d7/d7f/classdatabase_1_1sql__query__builder.html">sql_query_builder</a>&amp; values(<span class="keyword">const</span> std::map&lt;std::string, database_value&gt;&amp; data);</div>
<div class="line">    <a class="code hl_class" href="../../d7/d7f/classdatabase_1_1sql__query__builder.html">sql_query_builder</a>&amp; values(<span class="keyword">const</span> std::vector&lt;std::map&lt;std::string, database_value&gt;&gt;&amp; rows);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// UPDATE operations</span></div>
<div class="line">    <a class="code hl_class" href="../../d7/d7f/classdatabase_1_1sql__query__builder.html">sql_query_builder</a>&amp; update(<span class="keyword">const</span> std::string&amp; table);</div>
<div class="line">    <a class="code hl_class" href="../../d7/d7f/classdatabase_1_1sql__query__builder.html">sql_query_builder</a>&amp; set(<span class="keyword">const</span> std::string&amp; field, <span class="keyword">const</span> <a class="code hl_typedef" href="../../da/df2/namespacedatabase.html#a207a0dd48101812e44efc3772079828f">database_value</a>&amp; value);</div>
<div class="line">    <a class="code hl_class" href="../../d7/d7f/classdatabase_1_1sql__query__builder.html">sql_query_builder</a>&amp; set(<span class="keyword">const</span> std::map&lt;std::string, database_value&gt;&amp; data);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// DELETE operations</span></div>
<div class="line">    <a class="code hl_class" href="../../d7/d7f/classdatabase_1_1sql__query__builder.html">sql_query_builder</a>&amp; delete_from(<span class="keyword">const</span> std::string&amp; table);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Build final query</span></div>
<div class="line">    std::string build() <span class="keyword">const</span>;</div>
<div class="line">    std::string build_for_database(<a class="code hl_enumeration" href="../../da/df2/namespacedatabase.html#a9b50450d1f477d5f2fea4e15975023e4">database_types</a> db_type) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Reset builder</span></div>
<div class="line">    <span class="keywordtype">void</span> reset();</div>
<div class="line">};</div>
<div class="ttc" id="aclassdatabase_1_1query__condition_html"><div class="ttname"><a href="../../d6/da8/classdatabase_1_1query__condition.html">database::query_condition</a></div><div class="ttdoc">Represents a WHERE condition in a query.</div><div class="ttdef"><b>Definition</b> <a href="../../db/d0a/query__builder_8h_source.html#l00073">query_builder.h:74</a></div></div>
<div class="ttc" id="aclassdatabase_1_1sql__query__builder_html"><div class="ttname"><a href="../../d7/d7f/classdatabase_1_1sql__query__builder.html">database::sql_query_builder</a></div><div class="ttdoc">Builder for SQL queries (PostgreSQL, MySQL, SQLite).</div><div class="ttdef"><b>Definition</b> <a href="../../db/d0a/query__builder_8h_source.html#l00100">query_builder.h:101</a></div></div>
<div class="ttc" id="anamespacedatabase_html_afc7f2e426d6384a1dce826746ec2adf0"><div class="ttname"><a href="../../da/df2/namespacedatabase.html#afc7f2e426d6384a1dce826746ec2adf0">database::join_type</a></div><div class="ttdeci">join_type</div><div class="ttdoc">Types of SQL joins.</div><div class="ttdef"><b>Definition</b> <a href="../../db/d0a/query__builder_8h_source.html#l00050">query_builder.h:51</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md530"></a>
mongodb_query_builder</h2>
<p>Specialized query builder for MongoDB.</p>
<div class="fragment"><div class="line"><span class="keyword">class </span><a class="code hl_class" href="../../dd/dab/classdatabase_1_1mongodb__query__builder.html">mongodb_query_builder</a></div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="comment">// Collection operations</span></div>
<div class="line">    <a class="code hl_class" href="../../dd/dab/classdatabase_1_1mongodb__query__builder.html">mongodb_query_builder</a>&amp; collection(<span class="keyword">const</span> std::string&amp; name);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Find operations</span></div>
<div class="line">    <a class="code hl_class" href="../../dd/dab/classdatabase_1_1mongodb__query__builder.html">mongodb_query_builder</a>&amp; find(<span class="keyword">const</span> std::map&lt;std::string, database_value&gt;&amp; filter = {});</div>
<div class="line">    <a class="code hl_class" href="../../dd/dab/classdatabase_1_1mongodb__query__builder.html">mongodb_query_builder</a>&amp; find_one(<span class="keyword">const</span> std::map&lt;std::string, database_value&gt;&amp; filter = {});</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Projection</span></div>
<div class="line">    <a class="code hl_class" href="../../dd/dab/classdatabase_1_1mongodb__query__builder.html">mongodb_query_builder</a>&amp; project(<span class="keyword">const</span> std::vector&lt;std::string&gt;&amp; fields);</div>
<div class="line">    <a class="code hl_class" href="../../dd/dab/classdatabase_1_1mongodb__query__builder.html">mongodb_query_builder</a>&amp; exclude(<span class="keyword">const</span> std::vector&lt;std::string&gt;&amp; fields);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Sorting</span></div>
<div class="line">    <a class="code hl_class" href="../../dd/dab/classdatabase_1_1mongodb__query__builder.html">mongodb_query_builder</a>&amp; sort(<span class="keyword">const</span> std::map&lt;std::string, int&gt;&amp; sort_spec);</div>
<div class="line">    <a class="code hl_class" href="../../dd/dab/classdatabase_1_1mongodb__query__builder.html">mongodb_query_builder</a>&amp; sort(<span class="keyword">const</span> std::string&amp; field, <span class="keywordtype">int</span> direction = 1);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Limit and Skip</span></div>
<div class="line">    <a class="code hl_class" href="../../dd/dab/classdatabase_1_1mongodb__query__builder.html">mongodb_query_builder</a>&amp; limit(<span class="keywordtype">size_t</span> count);</div>
<div class="line">    <a class="code hl_class" href="../../dd/dab/classdatabase_1_1mongodb__query__builder.html">mongodb_query_builder</a>&amp; <a class="code hl_enumvalue" href="../../d2/d97/namespacekcenon_1_1messaging_1_1routing.html#acbb9d2cb916452bc9b770494271e5ef4a08b43519a7e36ee4c6c5615d1663bcfd">skip</a>(<span class="keywordtype">size_t</span> count);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Insert operations</span></div>
<div class="line">    <a class="code hl_class" href="../../dd/dab/classdatabase_1_1mongodb__query__builder.html">mongodb_query_builder</a>&amp; insert_one(<span class="keyword">const</span> std::map&lt;std::string, database_value&gt;&amp; document);</div>
<div class="line">    <a class="code hl_class" href="../../dd/dab/classdatabase_1_1mongodb__query__builder.html">mongodb_query_builder</a>&amp; insert_many(<span class="keyword">const</span> std::vector&lt;std::map&lt;std::string, database_value&gt;&gt;&amp; documents);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Update operations</span></div>
<div class="line">    <a class="code hl_class" href="../../dd/dab/classdatabase_1_1mongodb__query__builder.html">mongodb_query_builder</a>&amp; update_one(<span class="keyword">const</span> std::map&lt;std::string, database_value&gt;&amp; filter,</div>
<div class="line">                                     <span class="keyword">const</span> std::map&lt;std::string, database_value&gt;&amp; update);</div>
<div class="line">    <a class="code hl_class" href="../../dd/dab/classdatabase_1_1mongodb__query__builder.html">mongodb_query_builder</a>&amp; update_many(<span class="keyword">const</span> std::map&lt;std::string, database_value&gt;&amp; filter,</div>
<div class="line">                                      <span class="keyword">const</span> std::map&lt;std::string, database_value&gt;&amp; update);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Delete operations</span></div>
<div class="line">    <a class="code hl_class" href="../../dd/dab/classdatabase_1_1mongodb__query__builder.html">mongodb_query_builder</a>&amp; delete_one(<span class="keyword">const</span> std::map&lt;std::string, database_value&gt;&amp; filter);</div>
<div class="line">    <a class="code hl_class" href="../../dd/dab/classdatabase_1_1mongodb__query__builder.html">mongodb_query_builder</a>&amp; delete_many(<span class="keyword">const</span> std::map&lt;std::string, database_value&gt;&amp; filter);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Aggregation pipeline</span></div>
<div class="line">    <a class="code hl_class" href="../../dd/dab/classdatabase_1_1mongodb__query__builder.html">mongodb_query_builder</a>&amp; match(<span class="keyword">const</span> std::map&lt;std::string, database_value&gt;&amp; conditions);</div>
<div class="line">    <a class="code hl_class" href="../../dd/dab/classdatabase_1_1mongodb__query__builder.html">mongodb_query_builder</a>&amp; group(<span class="keyword">const</span> std::map&lt;std::string, database_value&gt;&amp; group_spec);</div>
<div class="line">    <a class="code hl_class" href="../../dd/dab/classdatabase_1_1mongodb__query__builder.html">mongodb_query_builder</a>&amp; unwind(<span class="keyword">const</span> std::string&amp; field);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Build final query</span></div>
<div class="line">    std::string build() <span class="keyword">const</span>;</div>
<div class="line">    std::string build_json() <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Reset builder</span></div>
<div class="line">    <span class="keywordtype">void</span> reset();</div>
<div class="line">};</div>
<div class="ttc" id="aclassdatabase_1_1mongodb__query__builder_html"><div class="ttname"><a href="../../dd/dab/classdatabase_1_1mongodb__query__builder.html">database::mongodb_query_builder</a></div><div class="ttdoc">Builder for MongoDB queries.</div><div class="ttdef"><b>Definition</b> <a href="../../db/d0a/query__builder_8h_source.html#l00184">query_builder.h:185</a></div></div>
<div class="ttc" id="anamespacekcenon_1_1messaging_1_1routing_html_acbb9d2cb916452bc9b770494271e5ef4a08b43519a7e36ee4c6c5615d1663bcfd"><div class="ttname"><a href="../../d2/d97/namespacekcenon_1_1messaging_1_1routing.html#acbb9d2cb916452bc9b770494271e5ef4a08b43519a7e36ee4c6c5615d1663bcfd">kcenon::messaging::routing::transform_result::skip</a></div><div class="ttdeci">@ skip</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md531"></a>
redis_query_builder</h2>
<p>Specialized query builder for Redis.</p>
<div class="fragment"><div class="line"><span class="keyword">class </span><a class="code hl_class" href="../../d2/d26/classdatabase_1_1redis__query__builder.html">redis_query_builder</a></div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="comment">// String operations</span></div>
<div class="line">    <a class="code hl_class" href="../../d2/d26/classdatabase_1_1redis__query__builder.html">redis_query_builder</a>&amp; set(<span class="keyword">const</span> std::string&amp; key, <span class="keyword">const</span> std::string&amp; value);</div>
<div class="line">    <a class="code hl_class" href="../../d2/d26/classdatabase_1_1redis__query__builder.html">redis_query_builder</a>&amp; get(<span class="keyword">const</span> std::string&amp; key);</div>
<div class="line">    <a class="code hl_class" href="../../d2/d26/classdatabase_1_1redis__query__builder.html">redis_query_builder</a>&amp; del(<span class="keyword">const</span> std::string&amp; key);</div>
<div class="line">    <a class="code hl_class" href="../../d2/d26/classdatabase_1_1redis__query__builder.html">redis_query_builder</a>&amp; exists(<span class="keyword">const</span> std::string&amp; key);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Hash operations</span></div>
<div class="line">    <a class="code hl_class" href="../../d2/d26/classdatabase_1_1redis__query__builder.html">redis_query_builder</a>&amp; hset(<span class="keyword">const</span> std::string&amp; key, <span class="keyword">const</span> std::string&amp; field, <span class="keyword">const</span> std::string&amp; value);</div>
<div class="line">    <a class="code hl_class" href="../../d2/d26/classdatabase_1_1redis__query__builder.html">redis_query_builder</a>&amp; hget(<span class="keyword">const</span> std::string&amp; key, <span class="keyword">const</span> std::string&amp; field);</div>
<div class="line">    <a class="code hl_class" href="../../d2/d26/classdatabase_1_1redis__query__builder.html">redis_query_builder</a>&amp; hdel(<span class="keyword">const</span> std::string&amp; key, <span class="keyword">const</span> std::string&amp; field);</div>
<div class="line">    <a class="code hl_class" href="../../d2/d26/classdatabase_1_1redis__query__builder.html">redis_query_builder</a>&amp; hgetall(<span class="keyword">const</span> std::string&amp; key);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// List operations</span></div>
<div class="line">    <a class="code hl_class" href="../../d2/d26/classdatabase_1_1redis__query__builder.html">redis_query_builder</a>&amp; lpush(<span class="keyword">const</span> std::string&amp; key, <span class="keyword">const</span> std::string&amp; value);</div>
<div class="line">    <a class="code hl_class" href="../../d2/d26/classdatabase_1_1redis__query__builder.html">redis_query_builder</a>&amp; rpush(<span class="keyword">const</span> std::string&amp; key, <span class="keyword">const</span> std::string&amp; value);</div>
<div class="line">    <a class="code hl_class" href="../../d2/d26/classdatabase_1_1redis__query__builder.html">redis_query_builder</a>&amp; lpop(<span class="keyword">const</span> std::string&amp; key);</div>
<div class="line">    <a class="code hl_class" href="../../d2/d26/classdatabase_1_1redis__query__builder.html">redis_query_builder</a>&amp; rpop(<span class="keyword">const</span> std::string&amp; key);</div>
<div class="line">    <a class="code hl_class" href="../../d2/d26/classdatabase_1_1redis__query__builder.html">redis_query_builder</a>&amp; lrange(<span class="keyword">const</span> std::string&amp; key, <span class="keywordtype">int</span> start, <span class="keywordtype">int</span> stop);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Set operations</span></div>
<div class="line">    <a class="code hl_class" href="../../d2/d26/classdatabase_1_1redis__query__builder.html">redis_query_builder</a>&amp; sadd(<span class="keyword">const</span> std::string&amp; key, <span class="keyword">const</span> std::string&amp; member);</div>
<div class="line">    <a class="code hl_class" href="../../d2/d26/classdatabase_1_1redis__query__builder.html">redis_query_builder</a>&amp; srem(<span class="keyword">const</span> std::string&amp; key, <span class="keyword">const</span> std::string&amp; member);</div>
<div class="line">    <a class="code hl_class" href="../../d2/d26/classdatabase_1_1redis__query__builder.html">redis_query_builder</a>&amp; sismember(<span class="keyword">const</span> std::string&amp; key, <span class="keyword">const</span> std::string&amp; member);</div>
<div class="line">    <a class="code hl_class" href="../../d2/d26/classdatabase_1_1redis__query__builder.html">redis_query_builder</a>&amp; smembers(<span class="keyword">const</span> std::string&amp; key);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Expiration</span></div>
<div class="line">    <a class="code hl_class" href="../../d2/d26/classdatabase_1_1redis__query__builder.html">redis_query_builder</a>&amp; expire(<span class="keyword">const</span> std::string&amp; key, <span class="keywordtype">int</span> seconds);</div>
<div class="line">    <a class="code hl_class" href="../../d2/d26/classdatabase_1_1redis__query__builder.html">redis_query_builder</a>&amp; ttl(<span class="keyword">const</span> std::string&amp; key);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Build command</span></div>
<div class="line">    std::string build() <span class="keyword">const</span>;</div>
<div class="line">    std::vector&lt;std::string&gt; build_args() <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Reset builder</span></div>
<div class="line">    <span class="keywordtype">void</span> reset();</div>
<div class="line">};</div>
<div class="ttc" id="aclassdatabase_1_1redis__query__builder_html"><div class="ttname"><a href="../../d2/d26/classdatabase_1_1redis__query__builder.html">database::redis_query_builder</a></div><div class="ttdoc">Builder for Redis commands.</div><div class="ttdef"><b>Definition</b> <a href="../../db/d0a/query__builder_8h_source.html#l00262">query_builder.h:263</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md532"></a>
Query Builder Examples</h2>
<div class="fragment"><div class="line"><span class="comment">// SQL Query Builder</span></div>
<div class="line"><span class="keyword">auto</span> sql_query = db.create_query_builder(database_types::postgres)</div>
<div class="line">    .select({<span class="stringliteral">&quot;name&quot;</span>, <span class="stringliteral">&quot;email&quot;</span>, <span class="stringliteral">&quot;created_at&quot;</span>})</div>
<div class="line">    .from(<span class="stringliteral">&quot;users&quot;</span>)</div>
<div class="line">    .where(<span class="stringliteral">&quot;age&quot;</span>, <span class="stringliteral">&quot;&gt;&quot;</span>, <a class="code hl_typedef" href="../../da/df2/namespacedatabase.html#a207a0dd48101812e44efc3772079828f">database_value</a>{int64_t(18)})</div>
<div class="line">    .where(<span class="stringliteral">&quot;status&quot;</span>, <span class="stringliteral">&quot;=&quot;</span>, <a class="code hl_typedef" href="../../da/df2/namespacedatabase.html#a207a0dd48101812e44efc3772079828f">database_value</a>{std::string(<span class="stringliteral">&quot;active&quot;</span>)})</div>
<div class="line">    .order_by(<span class="stringliteral">&quot;created_at&quot;</span>, sort_order::desc)</div>
<div class="line">    .limit(10);</div>
<div class="line"> </div>
<div class="line">std::string query = sql_query.build();</div>
<div class="line"><span class="comment">// Output: SELECT &quot;name&quot;, &quot;email&quot;, &quot;created_at&quot; FROM &quot;users&quot; WHERE age &gt; 18 AND status = &#39;active&#39; ORDER BY created_at DESC LIMIT 10</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// MongoDB Query Builder</span></div>
<div class="line"><span class="keyword">auto</span> mongo_query = db.create_query_builder(database_types::mongodb)</div>
<div class="line">    .collection(<span class="stringliteral">&quot;users&quot;</span>)</div>
<div class="line">    .find({{<span class="stringliteral">&quot;status&quot;</span>, <a class="code hl_typedef" href="../../da/df2/namespacedatabase.html#a207a0dd48101812e44efc3772079828f">database_value</a>{std::string(<span class="stringliteral">&quot;active&quot;</span>)}}})</div>
<div class="line">    .sort(<span class="stringliteral">&quot;created_at&quot;</span>, -1)</div>
<div class="line">    .limit(10);</div>
<div class="line"> </div>
<div class="line">std::string mongo_cmd = mongo_query.build();</div>
<div class="line"><span class="comment">// Output: db.users.find({ &quot;status&quot;: &quot;active&quot; }).sort({&quot;created_at&quot;: -1}).limit(10)</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Redis Query Builder</span></div>
<div class="line"><span class="keyword">auto</span> redis_query = db.create_query_builder(database_types::redis)</div>
<div class="line">    .hget(<span class="stringliteral">&quot;user:123&quot;</span>, <span class="stringliteral">&quot;email&quot;</span>);</div>
<div class="line"> </div>
<div class="line">std::string redis_cmd = redis_query.build();</div>
<div class="line"><span class="comment">// Output: HGET user:123 email</span></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md533"></a>
Database Types</h1>
<h2><a class="anchor" id="autotoc_md534"></a>
database_types</h2>
<p>Enumeration of supported database types.</p>
<div class="fragment"><div class="line"><span class="keyword">enum class</span> <a class="code hl_enumeration" href="../../da/df2/namespacedatabase.html#a9b50450d1f477d5f2fea4e15975023e4">database_types</a> : uint8_t</div>
<div class="line">{</div>
<div class="line">    none = 0,           <span class="comment">// No database backend</span></div>
<div class="line">    postgres = 1,       <span class="comment">// PostgreSQL backend</span></div>
<div class="line">    mysql = 2,          <span class="comment">// MySQL/MariaDB backend</span></div>
<div class="line">    sqlite = 3,         <span class="comment">// SQLite backend</span></div>
<div class="line">    oracle = 4,         <span class="comment">// Oracle backend (future)</span></div>
<div class="line">    mongodb = 5,        <span class="comment">// MongoDB backend</span></div>
<div class="line">    redis = 6           <span class="comment">// Redis backend</span></div>
<div class="line">};</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md535"></a>
database_value</h2>
<p>Variant type for database values.</p>
<div class="fragment"><div class="line"><span class="keyword">using </span><a class="code hl_typedef" href="../../da/df2/namespacedatabase.html#a207a0dd48101812e44efc3772079828f">database_value</a> = std::variant&lt;std::string, int64_t, double, bool, std::monostate&gt;;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md536"></a>
database_result</h2>
<p>Type definitions for database results.</p>
<div class="fragment"><div class="line"><span class="keyword">using </span><a class="code hl_typedef" href="../../da/df2/namespacedatabase.html#a04f31a8044c65bf283f7bb4ecd174906">database_row</a> = std::map&lt;std::string, database_value&gt;;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_typedef" href="../../da/df2/namespacedatabase.html#aefd19fdc143c6142e8e67853b536103a">database_result</a> = std::vector&lt;database_row&gt;;</div>
<div class="ttc" id="anamespacedatabase_html_a04f31a8044c65bf283f7bb4ecd174906"><div class="ttname"><a href="../../da/df2/namespacedatabase.html#a04f31a8044c65bf283f7bb4ecd174906">database::database_row</a></div><div class="ttdeci">std::map&lt; std::string, database_value &gt; database_row</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d46/database__base_8h_source.html#l00048">database_base.h:48</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md537"></a>
Working with database_value</h2>
<div class="fragment"><div class="line"><span class="comment">// Creating values</span></div>
<div class="line"><a class="code hl_typedef" href="../../da/df2/namespacedatabase.html#a207a0dd48101812e44efc3772079828f">database_value</a> str_val{std::string(<span class="stringliteral">&quot;hello&quot;</span>)};</div>
<div class="line"><a class="code hl_typedef" href="../../da/df2/namespacedatabase.html#a207a0dd48101812e44efc3772079828f">database_value</a> int_val{int64_t(42)};</div>
<div class="line"><a class="code hl_typedef" href="../../da/df2/namespacedatabase.html#a207a0dd48101812e44efc3772079828f">database_value</a> double_val{3.14};</div>
<div class="line"><a class="code hl_typedef" href="../../da/df2/namespacedatabase.html#a207a0dd48101812e44efc3772079828f">database_value</a> bool_val{<span class="keyword">true</span>};</div>
<div class="line"><a class="code hl_typedef" href="../../da/df2/namespacedatabase.html#a207a0dd48101812e44efc3772079828f">database_value</a> null_val{std::monostate{}};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Visiting values</span></div>
<div class="line">std::visit([](<span class="keyword">const</span> <span class="keyword">auto</span>&amp; value) {</div>
<div class="line">    <span class="keyword">using </span>T = std::decay_t&lt;<span class="keyword">decltype</span>(value)&gt;;</div>
<div class="line">    <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (std::is_same_v&lt;T, std::string&gt;) {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;String: &quot;</span> &lt;&lt; value &lt;&lt; std::endl;</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (std::is_same_v&lt;T, int64_t&gt;) {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Integer: &quot;</span> &lt;&lt; value &lt;&lt; std::endl;</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (std::is_same_v&lt;T, double&gt;) {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Double: &quot;</span> &lt;&lt; value &lt;&lt; std::endl;</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (std::is_same_v&lt;T, bool&gt;) {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Boolean: &quot;</span> &lt;&lt; (value ? <span class="stringliteral">&quot;true&quot;</span> : <span class="stringliteral">&quot;false&quot;</span>) &lt;&lt; std::endl;</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (std::is_same_v&lt;T, std::monostate&gt;) {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;NULL&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line">}, str_val);</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md538"></a>
Error Handling</h1>
<h2><a class="anchor" id="autotoc_md539"></a>
Exception Safety</h2>
<p>All database operations are exception-safe with RAII resource management.</p>
<div class="fragment"><div class="line"><span class="keywordflow">try</span> {</div>
<div class="line">    <a class="code hl_class" href="../../df/d8d/classdatabase_1_1database__manager.html">database_manager</a>&amp; db = database_manager::handle();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!db.set_mode(database_types::postgres)) {</div>
<div class="line">        <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Failed to set database mode&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!db.connect(connection_string)) {</div>
<div class="line">        <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Failed to connect to database&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> result = db.select_query(<span class="stringliteral">&quot;SELECT * FROM users&quot;</span>);</div>
<div class="line">    <span class="comment">// Process result</span></div>
<div class="line"> </div>
<div class="line">} <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line">    std::cerr &lt;&lt; <span class="stringliteral">&quot;Database error: &quot;</span> &lt;&lt; e.what() &lt;&lt; std::endl;</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md540"></a>
Mock Implementations</h2>
<p>When database libraries are not available, the system provides mock implementations that return empty results but don't throw exceptions.</p>
<div class="fragment"><div class="line"><span class="comment">// Even without PostgreSQL libraries, this won&#39;t crash</span></div>
<div class="line"><a class="code hl_class" href="../../df/d8d/classdatabase_1_1database__manager.html">database_manager</a>&amp; db = database_manager::handle();</div>
<div class="line">db.set_mode(database_types::postgres);</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> (!db.connect(<span class="stringliteral">&quot;mock://connection&quot;</span>)) {</div>
<div class="line">    <span class="comment">// This will fail gracefully with mock implementation</span></div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Mock connection - no actual database required&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> result = db.select_query(<span class="stringliteral">&quot;SELECT * FROM users&quot;</span>);</div>
<div class="line"><span class="comment">// Returns empty result with mock implementation</span></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md541"></a>
Examples</h1>
<h2><a class="anchor" id="autotoc_md542"></a>
Complete Usage Example</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../d9/da9/database__manager_8h.html">database/database_manager.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../d6/dbc/connection__pool_8h.html">database/connection_pool.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../db/d0a/query__builder_8h.html">database/query_builder.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="../../db/d5d/basic__usage__example_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>() {</div>
<div class="line">    <span class="keywordflow">try</span> {</div>
<div class="line">        <span class="comment">// Initialize database manager</span></div>
<div class="line">        <a class="code hl_class" href="../../df/d8d/classdatabase_1_1database__manager.html">database_manager</a>&amp; db = database_manager::handle();</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Configure PostgreSQL</span></div>
<div class="line">        <span class="keywordflow">if</span> (!db.set_mode(database_types::postgres)) {</div>
<div class="line">            std::cerr &lt;&lt; <span class="stringliteral">&quot;Failed to set database mode&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">            <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Setup connection pool</span></div>
<div class="line">        <a class="code hl_struct" href="../../d2/da7/structdatabase_1_1connection__pool__config.html">connection_pool_config</a> config;</div>
<div class="line">        config.min_connections = 2;</div>
<div class="line">        config.max_connections = 10;</div>
<div class="line">        config.connection_string = <span class="stringliteral">&quot;host=localhost port=5432 dbname=test user=admin password=secret&quot;</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (!db.create_connection_pool(database_types::postgres, config)) {</div>
<div class="line">            std::cerr &lt;&lt; <span class="stringliteral">&quot;Failed to create connection pool&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">            <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Create table using query builder</span></div>
<div class="line">        <span class="keyword">auto</span> create_table = db.create_query_builder()</div>
<div class="line">            .create_raw(<span class="stringliteral">&quot;CREATE TABLE IF NOT EXISTS users (&quot;</span></div>
<div class="line">                       <span class="stringliteral">&quot;id SERIAL PRIMARY KEY, &quot;</span></div>
<div class="line">                       <span class="stringliteral">&quot;name VARCHAR(100) NOT NULL, &quot;</span></div>
<div class="line">                       <span class="stringliteral">&quot;email VARCHAR(100) UNIQUE, &quot;</span></div>
<div class="line">                       <span class="stringliteral">&quot;created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP)&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Insert data</span></div>
<div class="line">        <span class="keyword">auto</span> insert_query = db.create_query_builder()</div>
<div class="line">            .insert_into(<span class="stringliteral">&quot;users&quot;</span>)</div>
<div class="line">            .values({</div>
<div class="line">                {<span class="stringliteral">&quot;name&quot;</span>, <a class="code hl_typedef" href="../../da/df2/namespacedatabase.html#a207a0dd48101812e44efc3772079828f">database_value</a>{std::string(<span class="stringliteral">&quot;John Doe&quot;</span>)}},</div>
<div class="line">                {<span class="stringliteral">&quot;email&quot;</span>, <a class="code hl_typedef" href="../../da/df2/namespacedatabase.html#a207a0dd48101812e44efc3772079828f">database_value</a>{std::string(<span class="stringliteral">&quot;john@example.com&quot;</span>)}}</div>
<div class="line">            });</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Select data with conditions</span></div>
<div class="line">        <span class="keyword">auto</span> select_query = db.create_query_builder()</div>
<div class="line">            .select({<span class="stringliteral">&quot;id&quot;</span>, <span class="stringliteral">&quot;name&quot;</span>, <span class="stringliteral">&quot;email&quot;</span>, <span class="stringliteral">&quot;created_at&quot;</span>})</div>
<div class="line">            .from(<span class="stringliteral">&quot;users&quot;</span>)</div>
<div class="line">            .where(<span class="stringliteral">&quot;name&quot;</span>, <span class="stringliteral">&quot;LIKE&quot;</span>, <a class="code hl_typedef" href="../../da/df2/namespacedatabase.html#a207a0dd48101812e44efc3772079828f">database_value</a>{std::string(<span class="stringliteral">&quot;%John%&quot;</span>)})</div>
<div class="line">            .order_by(<span class="stringliteral">&quot;created_at&quot;</span>, sort_order::desc)</div>
<div class="line">            .limit(10);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Execute queries</span></div>
<div class="line">        <span class="keyword">auto</span> pool = db.get_connection_pool(database_types::postgres);</div>
<div class="line">        <span class="keyword">auto</span> connection = pool-&gt;acquire_connection();</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (connection) {</div>
<div class="line">            <span class="comment">// Execute through connection</span></div>
<div class="line">            <span class="keyword">auto</span> result = select_query.execute(connection.get());</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// Process results</span></div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; row : result) {</div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [column, value] : row) {</div>
<div class="line">                    std::cout &lt;&lt; column &lt;&lt; <span class="stringliteral">&quot;: &quot;</span>;</div>
<div class="line">                    std::visit([](<span class="keyword">const</span> <span class="keyword">auto</span>&amp; v) {</div>
<div class="line">                        <span class="keyword">using </span>T = std::decay_t&lt;<span class="keyword">decltype</span>(v)&gt;;</div>
<div class="line">                        <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (std::is_same_v&lt;T, std::monostate&gt;) {</div>
<div class="line">                            std::cout &lt;&lt; <span class="stringliteral">&quot;NULL&quot;</span>;</div>
<div class="line">                        } <span class="keywordflow">else</span> {</div>
<div class="line">                            std::cout &lt;&lt; v;</div>
<div class="line">                        }</div>
<div class="line">                    }, value);</div>
<div class="line">                    std::cout &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line">                }</div>
<div class="line">                std::cout &lt;&lt; std::endl;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Monitor pool statistics</span></div>
<div class="line">        <span class="keyword">auto</span> stats = db.get_pool_stats();</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [db_type, stat] : stats) {</div>
<div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;Pool Stats - Active: &quot;</span> &lt;&lt; stat.active_connections</div>
<div class="line">                      &lt;&lt; <span class="stringliteral">&quot; Available: &quot;</span> &lt;&lt; stat.available_connections &lt;&lt; std::endl;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line">        std::cerr &lt;&lt; <span class="stringliteral">&quot;Error: &quot;</span> &lt;&lt; e.what() &lt;&lt; std::endl;</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="abasic__usage__example_8cpp_html_ae66f6b31b5ad750f1fe042a706a4e3d4"><div class="ttname"><a href="../../db/d5d/basic__usage__example_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a></div><div class="ttdeci">int main()</div><div class="ttdef"><b>Definition</b> <a href="../../db/d5d/basic__usage__example_8cpp_source.html#l00015">basic_usage_example.cpp:15</a></div></div>
<div class="ttc" id="aquery__builder_8h_html"><div class="ttname"><a href="../../db/d0a/query__builder_8h.html">query_builder.h</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md543"></a>
Multi-Database Example</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../d9/da9/database__manager_8h.html">database/database_manager.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../db/d0a/query__builder_8h.html">database/query_builder.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="../../db/d5d/basic__usage__example_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>() {</div>
<div class="line">    <a class="code hl_class" href="../../df/d8d/classdatabase_1_1database__manager.html">database_manager</a>&amp; db = database_manager::handle();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// PostgreSQL operations</span></div>
<div class="line">    <span class="keyword">auto</span> pg_query = db.create_query_builder(database_types::postgres)</div>
<div class="line">        .select({<span class="stringliteral">&quot;id&quot;</span>, <span class="stringliteral">&quot;name&quot;</span>})</div>
<div class="line">        .from(<span class="stringliteral">&quot;users&quot;</span>)</div>
<div class="line">        .where(<span class="stringliteral">&quot;status&quot;</span>, <span class="stringliteral">&quot;=&quot;</span>, <a class="code hl_typedef" href="../../da/df2/namespacedatabase.html#a207a0dd48101812e44efc3772079828f">database_value</a>{std::string(<span class="stringliteral">&quot;active&quot;</span>)});</div>
<div class="line"> </div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;PostgreSQL: &quot;</span> &lt;&lt; pg_query.build() &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// MySQL operations (different identifier quoting)</span></div>
<div class="line">    <span class="keyword">auto</span> mysql_query = db.create_query_builder(database_types::mysql)</div>
<div class="line">        .select({<span class="stringliteral">&quot;id&quot;</span>, <span class="stringliteral">&quot;name&quot;</span>})</div>
<div class="line">        .from(<span class="stringliteral">&quot;users&quot;</span>)</div>
<div class="line">        .where(<span class="stringliteral">&quot;status&quot;</span>, <span class="stringliteral">&quot;=&quot;</span>, <a class="code hl_typedef" href="../../da/df2/namespacedatabase.html#a207a0dd48101812e44efc3772079828f">database_value</a>{std::string(<span class="stringliteral">&quot;active&quot;</span>)});</div>
<div class="line"> </div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;MySQL: &quot;</span> &lt;&lt; mysql_query.build() &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// MongoDB operations</span></div>
<div class="line">    <span class="keyword">auto</span> mongo_query = db.create_query_builder(database_types::mongodb)</div>
<div class="line">        .collection(<span class="stringliteral">&quot;users&quot;</span>)</div>
<div class="line">        .find({{<span class="stringliteral">&quot;status&quot;</span>, <a class="code hl_typedef" href="../../da/df2/namespacedatabase.html#a207a0dd48101812e44efc3772079828f">database_value</a>{std::string(<span class="stringliteral">&quot;active&quot;</span>)}}})</div>
<div class="line">        .project({<span class="stringliteral">&quot;_id&quot;</span>, <span class="stringliteral">&quot;name&quot;</span>});</div>
<div class="line"> </div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;MongoDB: &quot;</span> &lt;&lt; mongo_query.build() &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Redis operations</span></div>
<div class="line">    <span class="keyword">auto</span> redis_query = db.create_query_builder(database_types::redis)</div>
<div class="line">        .hgetall(<span class="stringliteral">&quot;user:123&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Redis: &quot;</span> &lt;&lt; redis_query.build() &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md545"></a>
Phase 4: Enterprise APIs</h1>
<h2><a class="anchor" id="autotoc_md546"></a>
ORM Framework</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../d8/d83/entity_8h.html">database/orm/entity.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Entity definition</span></div>
<div class="line"><span class="keyword">class </span><a class="code hl_class" href="../../d9/dc0/classUser.html">User</a> : <span class="keyword">public</span> <a class="code hl_function" href="../../d1/d29/classdatabase_1_1orm_1_1entity__base.html#ab55560f2d6fc66eb1c77c2248bbb3a56">entity_base</a> {</div>
<div class="line">    <a class="code hl_define" href="../../d8/d83/entity_8h.html#a1fcd981b01ac4e09e94a8f8bc2a67c83">ENTITY_TABLE</a>(<span class="stringliteral">&quot;users&quot;</span>)</div>
<div class="line">    <a class="code hl_define" href="../../d8/d83/entity_8h.html#a7965232918d8618d125fb31f6598db1d">ENTITY_FIELD</a>(int64_t, <span class="keywordtype">id</span>, <a class="code hl_function" href="../../d1/d62/namespacedatabase_1_1orm.html#a7d653b0ef39699785eab3257815e7e97">primary_key</a>() | <a class="code hl_function" href="../../d1/d62/namespacedatabase_1_1orm.html#a1718af947e4cd204639939a59dd21fc8">auto_increment</a>())</div>
<div class="line">    <a class="code hl_define" href="../../d8/d83/entity_8h.html#a7965232918d8618d125fb31f6598db1d">ENTITY_FIELD</a>(std::<span class="keywordtype">string</span>, username, <a class="code hl_function" href="../../d1/d62/namespacedatabase_1_1orm.html#a76aee01e940cd11aa3e92a9b1c2315c6">not_null</a>() | <a class="code hl_enumvalue" href="../../d1/d62/namespacedatabase_1_1orm.html#a42c92e40cc713527b0bed526b0ff9d76a6a992d5529f459a44fee58c733255e86">index</a>(&quot;idx_username&quot;))</div>
<div class="line">    <a class="code hl_define" href="../../d8/d83/entity_8h.html#a7965232918d8618d125fb31f6598db1d">ENTITY_FIELD</a>(std::<span class="keywordtype">string</span>, email, <a class="code hl_function" href="../../d1/d62/namespacedatabase_1_1orm.html#a3cdd6462051272562b60eb298d260d6d">unique</a>())</div>
<div class="line">    <a class="code hl_define" href="../../d8/d83/entity_8h.html#a380c8b524e53f0d1db87bb7d760d8ea4">ENTITY_METADATA</a>()</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Entity operations</span></div>
<div class="line">entity_manager::instance().create_tables(db);</div>
<div class="line">auto users = <a class="code hl_class" href="../../d9/dc0/classUser.html">User</a>::query(db).where(&quot;age &gt; 18&quot;).execute();</div>
<div class="ttc" id="aclassUser_html"><div class="ttname"><a href="../../d9/dc0/classUser.html">User</a></div><div class="ttdef"><b>Definition</b> <a href="../../d3/de2/orm__framework__demo_8cpp_source.html#l00020">orm_framework_demo.cpp:21</a></div></div>
<div class="ttc" id="aclassdatabase_1_1orm_1_1entity__base_html_ab55560f2d6fc66eb1c77c2248bbb3a56"><div class="ttname"><a href="../../d1/d29/classdatabase_1_1orm_1_1entity__base.html#ab55560f2d6fc66eb1c77c2248bbb3a56">database::orm::entity_base::entity_base</a></div><div class="ttdeci">entity_base()=default</div></div>
<div class="ttc" id="aentity_8h_html"><div class="ttname"><a href="../../d8/d83/entity_8h.html">entity.h</a></div></div>
<div class="ttc" id="aentity_8h_html_a1fcd981b01ac4e09e94a8f8bc2a67c83"><div class="ttname"><a href="../../d8/d83/entity_8h.html#a1fcd981b01ac4e09e94a8f8bc2a67c83">ENTITY_TABLE</a></div><div class="ttdeci">#define ENTITY_TABLE(table_name)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d83/entity_8h_source.html#l00290">entity.h:290</a></div></div>
<div class="ttc" id="aentity_8h_html_a380c8b524e53f0d1db87bb7d760d8ea4"><div class="ttname"><a href="../../d8/d83/entity_8h.html#a380c8b524e53f0d1db87bb7d760d8ea4">ENTITY_METADATA</a></div><div class="ttdeci">#define ENTITY_METADATA()</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d83/entity_8h_source.html#l00297">entity.h:297</a></div></div>
<div class="ttc" id="aentity_8h_html_a7965232918d8618d125fb31f6598db1d"><div class="ttname"><a href="../../d8/d83/entity_8h.html#a7965232918d8618d125fb31f6598db1d">ENTITY_FIELD</a></div><div class="ttdeci">#define ENTITY_FIELD(type, name,...)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d83/entity_8h_source.html#l00282">entity.h:282</a></div></div>
<div class="ttc" id="anamespacedatabase_1_1orm_html_a1718af947e4cd204639939a59dd21fc8"><div class="ttname"><a href="../../d1/d62/namespacedatabase_1_1orm.html#a1718af947e4cd204639939a59dd21fc8">database::orm::auto_increment</a></div><div class="ttdeci">field_constraint auto_increment()</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d83/entity_8h_source.html#l00314">entity.h:314</a></div></div>
<div class="ttc" id="anamespacedatabase_1_1orm_html_a3cdd6462051272562b60eb298d260d6d"><div class="ttname"><a href="../../d1/d62/namespacedatabase_1_1orm.html#a3cdd6462051272562b60eb298d260d6d">database::orm::unique</a></div><div class="ttdeci">field_constraint unique()</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d83/entity_8h_source.html#l00313">entity.h:313</a></div></div>
<div class="ttc" id="anamespacedatabase_1_1orm_html_a42c92e40cc713527b0bed526b0ff9d76a6a992d5529f459a44fee58c733255e86"><div class="ttname"><a href="../../d1/d62/namespacedatabase_1_1orm.html#a42c92e40cc713527b0bed526b0ff9d76a6a992d5529f459a44fee58c733255e86">database::orm::field_constraint::index</a></div><div class="ttdeci">@ index</div></div>
<div class="ttc" id="anamespacedatabase_1_1orm_html_a76aee01e940cd11aa3e92a9b1c2315c6"><div class="ttname"><a href="../../d1/d62/namespacedatabase_1_1orm.html#a76aee01e940cd11aa3e92a9b1c2315c6">database::orm::not_null</a></div><div class="ttdeci">field_constraint not_null()</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d83/entity_8h_source.html#l00312">entity.h:312</a></div></div>
<div class="ttc" id="anamespacedatabase_1_1orm_html_a7d653b0ef39699785eab3257815e7e97"><div class="ttname"><a href="../../d1/d62/namespacedatabase_1_1orm.html#a7d653b0ef39699785eab3257815e7e97">database::orm::primary_key</a></div><div class="ttdeci">field_constraint primary_key()</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d83/entity_8h_source.html#l00311">entity.h:311</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md547"></a>
Performance Monitoring</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../d4/db5/database__system_2database_2monitoring_2performance__monitor_8h.html">database/monitoring/performance_monitor.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Performance monitoring</span></div>
<div class="line"><span class="keyword">auto</span>&amp; monitor = performance_monitor::instance();</div>
<div class="line">monitor.set_alert_thresholds(0.05, std::chrono::milliseconds(1000));</div>
<div class="line"><span class="keyword">auto</span> summary = monitor.get_performance_summary();</div>
<div class="ttc" id="adatabase__system_2database_2monitoring_2performance__monitor_8h_html"><div class="ttname"><a href="../../d4/db5/database__system_2database_2monitoring_2performance__monitor_8h.html">performance_monitor.h</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md548"></a>
Security Framework</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../dd/d91/secure__connection_8h.html">database/security/secure_connection.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Access control</span></div>
<div class="line"><span class="keyword">auto</span>&amp; access = access_control::instance();</div>
<div class="line">access.create_role(admin_role);</div>
<div class="line"><span class="keywordtype">bool</span> allowed = access.check_permission(<span class="stringliteral">&quot;user123&quot;</span>, <span class="stringliteral">&quot;users&quot;</span>, <span class="stringliteral">&quot;SELECT&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Audit logging</span></div>
<div class="line"><a class="code hl_define" href="../../dd/d91/secure__connection_8h.html#a37be14d714920c1ef9c2fc6234b3c615">AUDIT_LOG_ACCESS</a>(<span class="stringliteral">&quot;user123&quot;</span>, <span class="stringliteral">&quot;session456&quot;</span>, <span class="stringliteral">&quot;SELECT&quot;</span>, <span class="stringliteral">&quot;users&quot;</span>, <span class="stringliteral">&quot;query_hash&quot;</span>, <span class="keyword">true</span>, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="ttc" id="asecure__connection_8h_html"><div class="ttname"><a href="../../dd/d91/secure__connection_8h.html">secure_connection.h</a></div></div>
<div class="ttc" id="asecure__connection_8h_html_a37be14d714920c1ef9c2fc6234b3c615"><div class="ttname"><a href="../../dd/d91/secure__connection_8h.html#a37be14d714920c1ef9c2fc6234b3c615">AUDIT_LOG_ACCESS</a></div><div class="ttdeci">#define AUDIT_LOG_ACCESS(user, session, op, table, query, success, error)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d91/secure__connection_8h_source.html#l00405">secure_connection.h:405</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md549"></a>
Async Operations</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../da/dc5/async__operations_8h.html">database/async/async_operations.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Coroutine support</span></div>
<div class="line">database_awaitable&lt;bool&gt; async_operation() {</div>
<div class="line">    <span class="keyword">auto</span> result = <span class="keyword">co_await</span> async_db.execute_coro(<span class="stringliteral">&quot;SELECT * FROM users&quot;</span>);</div>
<div class="line">    <span class="keyword">co_return</span> result;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Distributed transactions</span></div>
<div class="line"><span class="keyword">auto</span>&amp; coordinator = transaction_coordinator::instance();</div>
<div class="line"><span class="keyword">auto</span> tx_id = coordinator.begin_distributed_transaction({db1, db2});</div>
<div class="ttc" id="aasync__operations_8h_html"><div class="ttname"><a href="../../da/dc5/async__operations_8h.html">async_operations.h</a></div></div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md551"></a>
System Requirements</h1>
<ul>
<li><b>C++ Standard</b>: C++20</li>
<li><b>Supported Compilers</b>: GCC 10+, Clang 11+, MSVC 2019+</li>
<li><b>Supported Platforms</b>: Windows, macOS, Linux</li>
</ul>
<p>For the latest API updates and changes, see the <a class="el" href="../../df/df7/md_libraries_2database__system_2CHANGELOG.html">CHANGELOG</a>. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
