<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Messaging System: Task Module API Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Messaging System<span id="projectnumber">&#160;1.0.0</span>
   </div>
   <div id="projectbrief">High-Performance Cross-Platform Messaging Framework</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('df/d18/md_docs_2task_2API__REFERENCE.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Task Module API Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md1366"></a> Complete API documentation for the Task module.</p>
<h1><a class="anchor" id="autotoc_md1367"></a>
Table of Contents</h1>
<ul>
<li>task</li>
<li>task_config</li>
<li>task_builder</li>
<li>task_handler_interface</li>
<li>task_context</li>
<li>task_queue</li>
<li>worker_pool</li>
<li>task_client</li>
<li>async_result</li>
<li>result_backend_interface</li>
<li>memory_result_backend</li>
<li>task_scheduler</li>
<li>cron_parser</li>
<li>task_monitor</li>
<li>task_system</li>
</ul>
<hr  />
<h1><a class="anchor" id="autotoc_md1369"></a>
task</h1>
<p>Represents a unit of work to be executed asynchronously.</p>
<p><b>Header:</b> <code>&lt;kcenon/messaging/task/task.h&gt;</code></p>
<h2><a class="anchor" id="autotoc_md1370"></a>
Enumerations</h2>
<h3><a class="anchor" id="autotoc_md1371"></a>
task_state</h3>
<div class="fragment"><div class="line"><span class="keyword">enum class</span> task_state {</div>
<div class="line">    pending,    <span class="comment">// Waiting to be queued</span></div>
<div class="line">    queued,     <span class="comment">// Added to queue</span></div>
<div class="line">    running,    <span class="comment">// Currently executing</span></div>
<div class="line">    succeeded,  <span class="comment">// Completed successfully</span></div>
<div class="line">    failed,     <span class="comment">// Execution failed</span></div>
<div class="line">    retrying,   <span class="comment">// Retrying after failure</span></div>
<div class="line">    cancelled,  <span class="comment">// Cancelled by user</span></div>
<div class="line">    expired     <span class="comment">// Expired before execution</span></div>
<div class="line">};</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1372"></a>
Constructors</h2>
<div class="fragment"><div class="line">task();</div>
<div class="line">task(<span class="keyword">const</span> std::string&amp; task_name);</div>
<div class="line">task(<span class="keyword">const</span> std::string&amp; task_name, <span class="keyword">const</span> container_module::value_container&amp; payload);</div>
<div class="line">task(<span class="keyword">const</span> std::string&amp; task_name, std::shared_ptr&lt;container_module::value_container&gt; payload);</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1373"></a>
Identification Methods</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>task_id()</code>   </td><td class="markdownTableBodyNone"><code>const std::string&amp;</code>   </td><td class="markdownTableBodyNone">Get the unique task identifier    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>task_name()</code>   </td><td class="markdownTableBodyNone"><code>const std::string&amp;</code>   </td><td class="markdownTableBodyNone">Get the handler name for this task   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1374"></a>
State Methods</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>state()</code>   </td><td class="markdownTableBodyNone"><code>task_state</code>   </td><td class="markdownTableBodyNone">Get current task state    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>set_state(task_state)</code>   </td><td class="markdownTableBodyNone"><code>void</code>   </td><td class="markdownTableBodyNone">Set task state    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>is_terminal_state()</code>   </td><td class="markdownTableBodyNone"><code>bool</code>   </td><td class="markdownTableBodyNone">Check if state is terminal (succeeded, failed, cancelled, expired)   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1375"></a>
Configuration Methods</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>config()</code>   </td><td class="markdownTableBodyNone"><code>const task_config&amp;</code>   </td><td class="markdownTableBodyNone">Get task configuration (const)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>config()</code>   </td><td class="markdownTableBodyNone"><code>task_config&amp;</code>   </td><td class="markdownTableBodyNone">Get task configuration (mutable)   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1376"></a>
Execution Tracking</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>attempt_count()</code>   </td><td class="markdownTableBodyNone"><code>size_t</code>   </td><td class="markdownTableBodyNone">Get number of execution attempts    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>increment_attempt()</code>   </td><td class="markdownTableBodyNone"><code>void</code>   </td><td class="markdownTableBodyNone">Increment attempt counter    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>started_at()</code>   </td><td class="markdownTableBodyNone"><code>const time_point&amp;</code>   </td><td class="markdownTableBodyNone">Get execution start time    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>completed_at()</code>   </td><td class="markdownTableBodyNone"><code>const time_point&amp;</code>   </td><td class="markdownTableBodyNone">Get execution completion time   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1377"></a>
Progress Tracking</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>progress()</code>   </td><td class="markdownTableBodyNone"><code>double</code>   </td><td class="markdownTableBodyNone">Get progress (0.0 to 1.0), thread-safe    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>set_progress(double)</code>   </td><td class="markdownTableBodyNone"><code>void</code>   </td><td class="markdownTableBodyNone">Set progress value    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>progress_message()</code>   </td><td class="markdownTableBodyNone"><code>const std::string&amp;</code>   </td><td class="markdownTableBodyNone">Get progress message    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>set_progress_message(const std::string&amp;)</code>   </td><td class="markdownTableBodyNone"><code>void</code>   </td><td class="markdownTableBodyNone">Set progress message   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1378"></a>
Result/Error Handling</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>has_result()</code>   </td><td class="markdownTableBodyNone"><code>bool</code>   </td><td class="markdownTableBodyNone">Check if result is available    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>result()</code>   </td><td class="markdownTableBodyNone"><code>const value_container&amp;</code>   </td><td class="markdownTableBodyNone">Get task result    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>set_result(shared_ptr&lt;value_container&gt;)</code>   </td><td class="markdownTableBodyNone"><code>void</code>   </td><td class="markdownTableBodyNone">Set task result    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>has_error()</code>   </td><td class="markdownTableBodyNone"><code>bool</code>   </td><td class="markdownTableBodyNone">Check if error occurred    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>error_message()</code>   </td><td class="markdownTableBodyNone"><code>const std::string&amp;</code>   </td><td class="markdownTableBodyNone">Get error message    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>error_traceback()</code>   </td><td class="markdownTableBodyNone"><code>const std::string&amp;</code>   </td><td class="markdownTableBodyNone">Get error traceback    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>set_error(message, traceback)</code>   </td><td class="markdownTableBodyNone"><code>void</code>   </td><td class="markdownTableBodyNone">Set error information   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1379"></a>
Retry Methods</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>is_expired()</code>   </td><td class="markdownTableBodyNone"><code>bool</code>   </td><td class="markdownTableBodyNone">Check if task has expired    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>should_retry()</code>   </td><td class="markdownTableBodyNone"><code>bool</code>   </td><td class="markdownTableBodyNone">Check if task should be retried    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>get_next_retry_delay()</code>   </td><td class="markdownTableBodyNone"><code>milliseconds</code>   </td><td class="markdownTableBodyNone">Calculate next retry delay with backoff   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1380"></a>
Serialization</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>serialize()</code>   </td><td class="markdownTableBodyNone"><code>Result&lt;vector&lt;uint8_t&gt;&gt;</code>   </td><td class="markdownTableBodyNone">Serialize task to bytes    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>deserialize(data)</code>   </td><td class="markdownTableBodyNone"><code>Result&lt;task&gt;</code>   </td><td class="markdownTableBodyNone">Static: Deserialize task from bytes   </td></tr>
</table>
<hr  />
<h1><a class="anchor" id="autotoc_md1382"></a>
task_config</h1>
<p>Configuration options for task execution.</p>
<p><b>Header:</b> <code>&lt;kcenon/messaging/task/task.h&gt;</code></p>
<h2><a class="anchor" id="autotoc_md1383"></a>
Fields</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Field   </th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Default   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>timeout</code>   </td><td class="markdownTableBodyNone"><code>milliseconds</code>   </td><td class="markdownTableBodyNone">300000 (5 min)   </td><td class="markdownTableBodyNone">Maximum execution time    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>max_retries</code>   </td><td class="markdownTableBodyNone"><code>size_t</code>   </td><td class="markdownTableBodyNone">3   </td><td class="markdownTableBodyNone">Maximum retry attempts    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>retry_delay</code>   </td><td class="markdownTableBodyNone"><code>milliseconds</code>   </td><td class="markdownTableBodyNone">1000   </td><td class="markdownTableBodyNone">Initial retry delay    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>retry_backoff_multiplier</code>   </td><td class="markdownTableBodyNone"><code>double</code>   </td><td class="markdownTableBodyNone">2.0   </td><td class="markdownTableBodyNone">Backoff multiplier    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>priority</code>   </td><td class="markdownTableBodyNone"><code>message_priority</code>   </td><td class="markdownTableBodyNone">normal   </td><td class="markdownTableBodyNone">Task priority level    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>eta</code>   </td><td class="markdownTableBodyNone"><code>optional&lt;time_point&gt;</code>   </td><td class="markdownTableBodyNone">nullopt   </td><td class="markdownTableBodyNone">Scheduled execution time    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>expires</code>   </td><td class="markdownTableBodyNone"><code>optional&lt;milliseconds&gt;</code>   </td><td class="markdownTableBodyNone">nullopt   </td><td class="markdownTableBodyNone">Expiration duration    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>queue_name</code>   </td><td class="markdownTableBodyNone"><code>std::string</code>   </td><td class="markdownTableBodyNone">"default"   </td><td class="markdownTableBodyNone">Target queue name    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>tags</code>   </td><td class="markdownTableBodyNone"><code>vector&lt;string&gt;</code>   </td><td class="markdownTableBodyNone">{}   </td><td class="markdownTableBodyNone">Task tags for filtering   </td></tr>
</table>
<hr  />
<h1><a class="anchor" id="autotoc_md1385"></a>
task_builder</h1>
<p>Fluent builder for constructing tasks.</p>
<p><b>Header:</b> <code>&lt;kcenon/messaging/task/task.h&gt;</code></p>
<h2><a class="anchor" id="autotoc_md1386"></a>
Constructor</h2>
<div class="fragment"><div class="line"><span class="keyword">explicit</span> task_builder(<span class="keyword">const</span> std::string&amp; task_name);</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1387"></a>
Builder Methods</h2>
<p>All methods return <code>task_builder&amp;</code> for chaining.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Parameters   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>payload(const value_container&amp;)</code>   </td><td class="markdownTableBodyNone">Payload data   </td><td class="markdownTableBodyNone">Set task payload    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>payload(shared_ptr&lt;value_container&gt;)</code>   </td><td class="markdownTableBodyNone">Payload pointer   </td><td class="markdownTableBodyNone">Set task payload    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>priority(message_priority)</code>   </td><td class="markdownTableBodyNone">Priority level   </td><td class="markdownTableBodyNone">Set priority    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>timeout(milliseconds)</code>   </td><td class="markdownTableBodyNone">Timeout duration   </td><td class="markdownTableBodyNone">Set timeout    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>retries(size_t)</code>   </td><td class="markdownTableBodyNone">Max retries   </td><td class="markdownTableBodyNone">Set max retry count    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>retry_delay(milliseconds)</code>   </td><td class="markdownTableBodyNone">Delay duration   </td><td class="markdownTableBodyNone">Set initial retry delay    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>backoff(double)</code>   </td><td class="markdownTableBodyNone">Multiplier   </td><td class="markdownTableBodyNone">Set backoff multiplier    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>queue(const string&amp;)</code>   </td><td class="markdownTableBodyNone">Queue name   </td><td class="markdownTableBodyNone">Set target queue    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>eta(time_point)</code>   </td><td class="markdownTableBodyNone">Scheduled time   </td><td class="markdownTableBodyNone">Set scheduled execution time    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>delay(milliseconds)</code>   </td><td class="markdownTableBodyNone">Delay duration   </td><td class="markdownTableBodyNone">Set execution delay from now    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>expires_in(milliseconds)</code>   </td><td class="markdownTableBodyNone">Duration   </td><td class="markdownTableBodyNone">Set expiration    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>tag(const string&amp;)</code>   </td><td class="markdownTableBodyNone">Tag name   </td><td class="markdownTableBodyNone">Add a tag    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>tags(const vector&lt;string&gt;&amp;)</code>   </td><td class="markdownTableBodyNone">Tag list   </td><td class="markdownTableBodyNone">Add multiple tags   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1388"></a>
Build Method</h2>
<div class="fragment"><div class="line">common::Result&lt;task&gt; build();</div>
</div><!-- fragment --><p>Returns <code>Result&lt;task&gt;</code> containing the constructed task or an error.</p>
<h2><a class="anchor" id="autotoc_md1389"></a>
Example</h2>
<div class="fragment"><div class="line"><span class="keyword">auto</span> result = task_builder(<span class="stringliteral">&quot;email.send&quot;</span>)</div>
<div class="line">    .payload(email_data)</div>
<div class="line">    .priority(message_priority::high)</div>
<div class="line">    .timeout(std::chrono::minutes(2))</div>
<div class="line">    .retries(5)</div>
<div class="line">    .queue(<span class="stringliteral">&quot;email-queue&quot;</span>)</div>
<div class="line">    .tag(<span class="stringliteral">&quot;notifications&quot;</span>)</div>
<div class="line">    .build();</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> (result.is_ok()) {</div>
<div class="line">    <span class="keyword">auto</span> task = result.value();</div>
<div class="line">}</div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md1391"></a>
task_handler_interface</h1>
<p>Abstract interface for task handlers.</p>
<p><b>Header:</b> <code>&lt;kcenon/messaging/task/task_handler.h&gt;</code></p>
<h2><a class="anchor" id="autotoc_md1392"></a>
Pure Virtual Methods</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>name()</code>   </td><td class="markdownTableBodyNone"><code>std::string</code>   </td><td class="markdownTableBodyNone">Get handler name    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>execute(task, context)</code>   </td><td class="markdownTableBodyNone"><code>Result&lt;value_container&gt;</code>   </td><td class="markdownTableBodyNone">Execute the task   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1393"></a>
Virtual Lifecycle Hooks</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Parameters   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>on_retry(task, attempt)</code>   </td><td class="markdownTableBodyNone">Task and attempt number   </td><td class="markdownTableBodyNone">Called before retry    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>on_failure(task, error)</code>   </td><td class="markdownTableBodyNone">Task and error message   </td><td class="markdownTableBodyNone">Called on failure    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>on_success(task, result)</code>   </td><td class="markdownTableBodyNone">Task and result   </td><td class="markdownTableBodyNone">Called on success   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1394"></a>
Example</h2>
<div class="fragment"><div class="line"><span class="keyword">class </span>email_handler : <span class="keyword">public</span> task_handler_interface {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    std::string name()<span class="keyword"> const override </span>{</div>
<div class="line">        <span class="keywordflow">return</span> <span class="stringliteral">&quot;email.send&quot;</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    common::Result&lt;value_container&gt; execute(</div>
<div class="line">        <span class="keyword">const</span> task&amp; t,</div>
<div class="line">        task_context&amp; ctx)<span class="keyword"> override</span></div>
<div class="line"><span class="keyword">    </span>{</div>
<div class="line">        <span class="keyword">auto</span> to = t.payload().get_string(<span class="stringliteral">&quot;to&quot;</span>).value();</div>
<div class="line">        <span class="comment">// Send email...</span></div>
<div class="line">        value_container result;</div>
<div class="line">        result.add(<span class="stringliteral">&quot;status&quot;</span>, <span class="stringliteral">&quot;sent&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> common::ok(result);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> on_failure(<span class="keyword">const</span> task&amp; t, <span class="keyword">const</span> std::string&amp; error)<span class="keyword"> override </span>{</div>
<div class="line">        <span class="comment">// Log failure, send alert, etc.</span></div>
<div class="line">    }</div>
<div class="line">};</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1395"></a>
Helper Functions</h2>
<div class="fragment"><div class="line"><span class="comment">// Create handler from lambda</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> Func&gt;</div>
<div class="line">std::shared_ptr&lt;task_handler_interface&gt; make_handler(</div>
<div class="line">    <span class="keyword">const</span> std::string&amp; name,</div>
<div class="line">    Func&amp;&amp; func);</div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md1397"></a>
task_context</h1>
<p>Execution context provided to handlers.</p>
<p><b>Header:</b> <code>&lt;kcenon/messaging/task/task_context.h&gt;</code></p>
<h2><a class="anchor" id="autotoc_md1398"></a>
Structures</h2>
<h3><a class="anchor" id="autotoc_md1399"></a>
progress_info</h3>
<div class="fragment"><div class="line"><span class="keyword">struct </span>progress_info {</div>
<div class="line">    <span class="keywordtype">double</span> progress;</div>
<div class="line">    std::string message;</div>
<div class="line">    std::chrono::system_clock::time_point timestamp;</div>
<div class="line">};</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md1400"></a>
task_log_entry</h3>
<div class="fragment"><div class="line"><span class="keyword">struct </span>task_log_entry {</div>
<div class="line">    <span class="keyword">enum class</span> level { info, warning, error };</div>
<div class="line">    level log_level;</div>
<div class="line">    std::string message;</div>
<div class="line">    std::chrono::system_clock::time_point timestamp;</div>
<div class="line">};</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1401"></a>
Progress Tracking</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>update_progress(double, string)</code>   </td><td class="markdownTableBodyNone"><code>void</code>   </td><td class="markdownTableBodyNone">Update progress (0.0-1.0) with message    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>progress()</code>   </td><td class="markdownTableBodyNone"><code>double</code>   </td><td class="markdownTableBodyNone">Get current progress    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>progress_history()</code>   </td><td class="markdownTableBodyNone"><code>vector&lt;progress_info&gt;</code>   </td><td class="markdownTableBodyNone">Get progress history   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1402"></a>
Checkpoint Management</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>save_checkpoint(value_container)</code>   </td><td class="markdownTableBodyNone"><code>void</code>   </td><td class="markdownTableBodyNone">Save checkpoint state    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>load_checkpoint()</code>   </td><td class="markdownTableBodyNone"><code>value_container</code>   </td><td class="markdownTableBodyNone">Load saved checkpoint    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>has_checkpoint()</code>   </td><td class="markdownTableBodyNone"><code>bool</code>   </td><td class="markdownTableBodyNone">Check if checkpoint exists    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>clear_checkpoint()</code>   </td><td class="markdownTableBodyNone"><code>void</code>   </td><td class="markdownTableBodyNone">Clear checkpoint   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1403"></a>
Subtask Management</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>set_subtask_spawner(spawner)</code>   </td><td class="markdownTableBodyNone"><code>void</code>   </td><td class="markdownTableBodyNone">Set spawner function    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>spawn_subtask(task)</code>   </td><td class="markdownTableBodyNone"><code>Result&lt;string&gt;</code>   </td><td class="markdownTableBodyNone">Spawn a subtask, returns task ID    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>spawned_subtask_ids()</code>   </td><td class="markdownTableBodyNone"><code>vector&lt;string&gt;</code>   </td><td class="markdownTableBodyNone">Get IDs of spawned subtasks   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1404"></a>
Cancellation</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>is_cancelled()</code>   </td><td class="markdownTableBodyNone"><code>bool</code>   </td><td class="markdownTableBodyNone">Check if cancellation requested    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>request_cancellation()</code>   </td><td class="markdownTableBodyNone"><code>void</code>   </td><td class="markdownTableBodyNone">Request cancellation   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1405"></a>
Logging</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Parameters   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>log_info(message)</code>   </td><td class="markdownTableBodyNone">Log message   </td><td class="markdownTableBodyNone">Log info level message    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>log_warning(message)</code>   </td><td class="markdownTableBodyNone">Log message   </td><td class="markdownTableBodyNone">Log warning level message    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>log_error(message)</code>   </td><td class="markdownTableBodyNone">Log message   </td><td class="markdownTableBodyNone">Log error level message    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>logs()</code>   </td><td class="markdownTableBodyNone">-   </td><td class="markdownTableBodyNone">Get all log entries   </td></tr>
</table>
<hr  />
<h1><a class="anchor" id="autotoc_md1407"></a>
task_queue</h1>
<p>Manages task queuing with multiple named queues.</p>
<p><b>Header:</b> <code>&lt;kcenon/messaging/task/task_queue.h&gt;</code></p>
<h2><a class="anchor" id="autotoc_md1408"></a>
Configuration</h2>
<div class="fragment"><div class="line"><span class="keyword">struct </span>task_queue_config {</div>
<div class="line">    <span class="keywordtype">size_t</span> max_size = 100000;</div>
<div class="line">    <span class="keywordtype">bool</span> enable_persistence = <span class="keyword">false</span>;</div>
<div class="line">    std::string persistence_path;</div>
<div class="line">    <span class="keywordtype">bool</span> enable_delayed_queue = <span class="keyword">true</span>;</div>
<div class="line">    std::chrono::milliseconds delayed_poll_interval{1000};</div>
<div class="line">};</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1409"></a>
Constructor</h2>
<div class="fragment"><div class="line"><span class="keyword">explicit</span> task_queue(<span class="keyword">const</span> task_queue_config&amp; config = {});</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1410"></a>
Lifecycle</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>start()</code>   </td><td class="markdownTableBodyNone"><code>VoidResult</code>   </td><td class="markdownTableBodyNone">Start the queue    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>stop()</code>   </td><td class="markdownTableBodyNone"><code>void</code>   </td><td class="markdownTableBodyNone">Stop the queue    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>is_running()</code>   </td><td class="markdownTableBodyNone"><code>bool</code>   </td><td class="markdownTableBodyNone">Check if running   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1411"></a>
Enqueue Operations</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>enqueue(task)</code>   </td><td class="markdownTableBodyNone"><code>Result&lt;string&gt;</code>   </td><td class="markdownTableBodyNone">Add task, returns task ID    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>enqueue_bulk(vector&lt;task&gt;)</code>   </td><td class="markdownTableBodyNone"><code>Result&lt;vector&lt;string&gt;&gt;</code>   </td><td class="markdownTableBodyNone">Add multiple tasks   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1412"></a>
Dequeue Operations</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>dequeue(queues, timeout)</code>   </td><td class="markdownTableBodyNone"><code>Result&lt;task&gt;</code>   </td><td class="markdownTableBodyNone">Wait for task from queues    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>try_dequeue(queues)</code>   </td><td class="markdownTableBodyNone"><code>Result&lt;task&gt;</code>   </td><td class="markdownTableBodyNone">Non-blocking dequeue   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1413"></a>
Cancellation</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>cancel(task_id)</code>   </td><td class="markdownTableBodyNone"><code>VoidResult</code>   </td><td class="markdownTableBodyNone">Cancel by task ID    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>cancel_by_tag(tag)</code>   </td><td class="markdownTableBodyNone"><code>VoidResult</code>   </td><td class="markdownTableBodyNone">Cancel by tag   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1414"></a>
Query Operations</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>get_task(task_id)</code>   </td><td class="markdownTableBodyNone"><code>Result&lt;task&gt;</code>   </td><td class="markdownTableBodyNone">Get task by ID    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>queue_size(queue_name)</code>   </td><td class="markdownTableBodyNone"><code>size_t</code>   </td><td class="markdownTableBodyNone">Get queue size    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>total_size()</code>   </td><td class="markdownTableBodyNone"><code>size_t</code>   </td><td class="markdownTableBodyNone">Get total tasks    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>delayed_size()</code>   </td><td class="markdownTableBodyNone"><code>size_t</code>   </td><td class="markdownTableBodyNone">Get delayed task count    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>list_queues()</code>   </td><td class="markdownTableBodyNone"><code>vector&lt;string&gt;</code>   </td><td class="markdownTableBodyNone">List queue names    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>has_queue(name)</code>   </td><td class="markdownTableBodyNone"><code>bool</code>   </td><td class="markdownTableBodyNone">Check queue exists   </td></tr>
</table>
<hr  />
<h1><a class="anchor" id="autotoc_md1416"></a>
worker_pool</h1>
<p>Thread pool for executing tasks.</p>
<p><b>Header:</b> <code>&lt;kcenon/messaging/task/worker_pool.h&gt;</code></p>
<h2><a class="anchor" id="autotoc_md1417"></a>
Configuration</h2>
<div class="fragment"><div class="line"><span class="keyword">struct </span>worker_config {</div>
<div class="line">    <span class="keywordtype">size_t</span> concurrency = std::thread::hardware_concurrency();</div>
<div class="line">    std::vector&lt;std::string&gt; queues = {<span class="stringliteral">&quot;default&quot;</span>};</div>
<div class="line">    std::chrono::milliseconds poll_interval{100};</div>
<div class="line">    <span class="keywordtype">bool</span> prefetch = <span class="keyword">true</span>;</div>
<div class="line">    <span class="keywordtype">size_t</span> prefetch_count = 10;</div>
<div class="line">};</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1418"></a>
Statistics</h2>
<div class="fragment"><div class="line"><span class="keyword">struct </span>worker_statistics {</div>
<div class="line">    <span class="keywordtype">size_t</span> total_tasks_processed = 0;</div>
<div class="line">    <span class="keywordtype">size_t</span> total_tasks_succeeded = 0;</div>
<div class="line">    <span class="keywordtype">size_t</span> total_tasks_failed = 0;</div>
<div class="line">    <span class="keywordtype">size_t</span> total_tasks_retried = 0;</div>
<div class="line">    <span class="keywordtype">size_t</span> total_tasks_timed_out = 0;</div>
<div class="line">    std::chrono::milliseconds total_execution_time{0};</div>
<div class="line">    std::chrono::milliseconds avg_execution_time{0};</div>
<div class="line">    std::chrono::system_clock::time_point started_at;</div>
<div class="line">    std::chrono::system_clock::time_point last_task_at;</div>
<div class="line">};</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1419"></a>
Handler Registration</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>register_handler(shared_ptr&lt;handler&gt;)</code>   </td><td class="markdownTableBodyNone"><code>void</code>   </td><td class="markdownTableBodyNone">Register class-based handler    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>register_handler(name, func)</code>   </td><td class="markdownTableBodyNone"><code>void</code>   </td><td class="markdownTableBodyNone">Register lambda handler    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>unregister_handler(name)</code>   </td><td class="markdownTableBodyNone"><code>bool</code>   </td><td class="markdownTableBodyNone">Unregister handler    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>has_handler(name)</code>   </td><td class="markdownTableBodyNone"><code>bool</code>   </td><td class="markdownTableBodyNone">Check handler exists    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>list_handlers()</code>   </td><td class="markdownTableBodyNone"><code>vector&lt;string&gt;</code>   </td><td class="markdownTableBodyNone">List handler names   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1420"></a>
Lifecycle</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>start()</code>   </td><td class="markdownTableBodyNone"><code>VoidResult</code>   </td><td class="markdownTableBodyNone">Start worker pool    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>stop()</code>   </td><td class="markdownTableBodyNone"><code>VoidResult</code>   </td><td class="markdownTableBodyNone">Stop immediately    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>shutdown_graceful(timeout)</code>   </td><td class="markdownTableBodyNone"><code>VoidResult</code>   </td><td class="markdownTableBodyNone">Graceful shutdown   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1421"></a>
Status</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>is_running()</code>   </td><td class="markdownTableBodyNone"><code>bool</code>   </td><td class="markdownTableBodyNone">Check if running    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>active_workers()</code>   </td><td class="markdownTableBodyNone"><code>size_t</code>   </td><td class="markdownTableBodyNone">Count of busy workers    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>idle_workers()</code>   </td><td class="markdownTableBodyNone"><code>size_t</code>   </td><td class="markdownTableBodyNone">Count of idle workers    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>total_workers()</code>   </td><td class="markdownTableBodyNone"><code>size_t</code>   </td><td class="markdownTableBodyNone">Total worker count   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1422"></a>
Statistics</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>get_statistics()</code>   </td><td class="markdownTableBodyNone"><code>worker_statistics</code>   </td><td class="markdownTableBodyNone">Get execution statistics    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>reset_statistics()</code>   </td><td class="markdownTableBodyNone"><code>void</code>   </td><td class="markdownTableBodyNone">Reset statistics   </td></tr>
</table>
<hr  />
<h1><a class="anchor" id="autotoc_md1424"></a>
task_client</h1>
<p>High-level API for task submission.</p>
<p><b>Header:</b> <code>&lt;kcenon/messaging/task/task_client.h&gt;</code></p>
<h2><a class="anchor" id="autotoc_md1425"></a>
Constructor</h2>
<div class="fragment"><div class="line">task_client(</div>
<div class="line">    std::shared_ptr&lt;task_queue&gt; queue,</div>
<div class="line">    std::shared_ptr&lt;result_backend_interface&gt; backend);</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1426"></a>
Immediate Execution</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>send(task)</code>   </td><td class="markdownTableBodyNone"><code>async_result</code>   </td><td class="markdownTableBodyNone">Submit task    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>send(name, payload)</code>   </td><td class="markdownTableBodyNone"><code>async_result</code>   </td><td class="markdownTableBodyNone">Submit with name and payload   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1427"></a>
Delayed Execution</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>send_later(task, delay)</code>   </td><td class="markdownTableBodyNone"><code>async_result</code>   </td><td class="markdownTableBodyNone">Submit with delay    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>send_at(task, time_point)</code>   </td><td class="markdownTableBodyNone"><code>async_result</code>   </td><td class="markdownTableBodyNone">Submit for specific time   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1428"></a>
Batch Operations</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>send_batch(vector&lt;task&gt;)</code>   </td><td class="markdownTableBodyNone"><code>vector&lt;async_result&gt;</code>   </td><td class="markdownTableBodyNone">Submit multiple tasks   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1429"></a>
Workflow Patterns</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>chain(vector&lt;task&gt;)</code>   </td><td class="markdownTableBodyNone"><code>async_result</code>   </td><td class="markdownTableBodyNone">Sequential execution    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>chord(tasks, callback)</code>   </td><td class="markdownTableBodyNone"><code>async_result</code>   </td><td class="markdownTableBodyNone">Parallel with callback   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1430"></a>
Result/Cancellation</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>get_result(task_id)</code>   </td><td class="markdownTableBodyNone"><code>async_result</code>   </td><td class="markdownTableBodyNone">Get result handle    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>cancel(task_id)</code>   </td><td class="markdownTableBodyNone"><code>VoidResult</code>   </td><td class="markdownTableBodyNone">Cancel task    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>cancel_by_tag(tag)</code>   </td><td class="markdownTableBodyNone"><code>VoidResult</code>   </td><td class="markdownTableBodyNone">Cancel by tag   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1431"></a>
Status</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>pending_count(queue)</code>   </td><td class="markdownTableBodyNone"><code>size_t</code>   </td><td class="markdownTableBodyNone">Count pending tasks    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>is_connected()</code>   </td><td class="markdownTableBodyNone"><code>bool</code>   </td><td class="markdownTableBodyNone">Check connection status   </td></tr>
</table>
<hr  />
<h1><a class="anchor" id="autotoc_md1433"></a>
async_result</h1>
<p>Handle for asynchronous task results.</p>
<p><b>Header:</b> <code>&lt;kcenon/messaging/task/async_result.h&gt;</code></p>
<h2><a class="anchor" id="autotoc_md1434"></a>
Status Methods</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>task_id()</code>   </td><td class="markdownTableBodyNone"><code>const string&amp;</code>   </td><td class="markdownTableBodyNone">Get task ID    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>is_valid()</code>   </td><td class="markdownTableBodyNone"><code>bool</code>   </td><td class="markdownTableBodyNone">Check if handle is valid    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>state()</code>   </td><td class="markdownTableBodyNone"><code>task_state</code>   </td><td class="markdownTableBodyNone">Get current state    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>is_ready()</code>   </td><td class="markdownTableBodyNone"><code>bool</code>   </td><td class="markdownTableBodyNone">Check if completed    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>is_successful()</code>   </td><td class="markdownTableBodyNone"><code>bool</code>   </td><td class="markdownTableBodyNone">Check if succeeded    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>is_failed()</code>   </td><td class="markdownTableBodyNone"><code>bool</code>   </td><td class="markdownTableBodyNone">Check if failed    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>is_cancelled()</code>   </td><td class="markdownTableBodyNone"><code>bool</code>   </td><td class="markdownTableBodyNone">Check if cancelled   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1435"></a>
Progress Methods</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>progress()</code>   </td><td class="markdownTableBodyNone"><code>double</code>   </td><td class="markdownTableBodyNone">Get progress (0.0-1.0)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>progress_message()</code>   </td><td class="markdownTableBodyNone"><code>string</code>   </td><td class="markdownTableBodyNone">Get progress message   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1436"></a>
Blocking Result Retrieval</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>get(timeout)</code>   </td><td class="markdownTableBodyNone"><code>Result&lt;value_container&gt;</code>   </td><td class="markdownTableBodyNone">Wait for result    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>wait(timeout)</code>   </td><td class="markdownTableBodyNone"><code>bool</code>   </td><td class="markdownTableBodyNone">Wait for completion   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1437"></a>
Callback-Based</h2>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> then(</div>
<div class="line">    std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> value_container&amp;)&gt; on_success,</div>
<div class="line">    std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> std::string&amp;)&gt; on_failure = <span class="keyword">nullptr</span>);</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1438"></a>
Task Control</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>revoke()</code>   </td><td class="markdownTableBodyNone"><code>VoidResult</code>   </td><td class="markdownTableBodyNone">Cancel the task    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>children()</code>   </td><td class="markdownTableBodyNone"><code>vector&lt;async_result&gt;</code>   </td><td class="markdownTableBodyNone">Get child task handles    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>add_child(task_id)</code>   </td><td class="markdownTableBodyNone"><code>void</code>   </td><td class="markdownTableBodyNone">Add child task    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>error_message()</code>   </td><td class="markdownTableBodyNone"><code>string</code>   </td><td class="markdownTableBodyNone">Get error message    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>error_traceback()</code>   </td><td class="markdownTableBodyNone"><code>string</code>   </td><td class="markdownTableBodyNone">Get error traceback   </td></tr>
</table>
<hr  />
<h1><a class="anchor" id="autotoc_md1440"></a>
result_backend_interface</h1>
<p>Abstract interface for result storage.</p>
<p><b>Header:</b> <code>&lt;kcenon/messaging/task/result_backend.h&gt;</code></p>
<h2><a class="anchor" id="autotoc_md1441"></a>
Structures</h2>
<div class="fragment"><div class="line"><span class="keyword">struct </span>progress_data {</div>
<div class="line">    <span class="keywordtype">double</span> progress{0.0};</div>
<div class="line">    std::string message;</div>
<div class="line">    std::chrono::system_clock::time_point updated_at;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>error_data {</div>
<div class="line">    std::string message;</div>
<div class="line">    std::string traceback;</div>
<div class="line">    std::chrono::system_clock::time_point occurred_at;</div>
<div class="line">};</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1442"></a>
Pure Virtual Methods</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>store_state(task_id, state)</code>   </td><td class="markdownTableBodyNone"><code>VoidResult</code>   </td><td class="markdownTableBodyNone">Store task state    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>store_result(task_id, result)</code>   </td><td class="markdownTableBodyNone"><code>VoidResult</code>   </td><td class="markdownTableBodyNone">Store result    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>store_error(task_id, error, traceback)</code>   </td><td class="markdownTableBodyNone"><code>VoidResult</code>   </td><td class="markdownTableBodyNone">Store error    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>store_progress(task_id, progress, message)</code>   </td><td class="markdownTableBodyNone"><code>VoidResult</code>   </td><td class="markdownTableBodyNone">Store progress    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>get_state(task_id)</code>   </td><td class="markdownTableBodyNone"><code>Result&lt;task_state&gt;</code>   </td><td class="markdownTableBodyNone">Get state    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>get_result(task_id)</code>   </td><td class="markdownTableBodyNone"><code>Result&lt;value_container&gt;</code>   </td><td class="markdownTableBodyNone">Get result    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>get_progress(task_id)</code>   </td><td class="markdownTableBodyNone"><code>Result&lt;progress_data&gt;</code>   </td><td class="markdownTableBodyNone">Get progress    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>get_error(task_id)</code>   </td><td class="markdownTableBodyNone"><code>Result&lt;error_data&gt;</code>   </td><td class="markdownTableBodyNone">Get error    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>wait_for_result(task_id, timeout)</code>   </td><td class="markdownTableBodyNone"><code>Result&lt;value_container&gt;</code>   </td><td class="markdownTableBodyNone">Blocking wait    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>cleanup_expired(max_age)</code>   </td><td class="markdownTableBodyNone"><code>VoidResult</code>   </td><td class="markdownTableBodyNone">Cleanup old entries   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1443"></a>
Optional Virtual Methods</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Default   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>exists(task_id)</code>   </td><td class="markdownTableBodyNone"><code>bool</code>   </td><td class="markdownTableBodyNone">false   </td><td class="markdownTableBodyNone">Check if exists    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>remove(task_id)</code>   </td><td class="markdownTableBodyNone"><code>VoidResult</code>   </td><td class="markdownTableBodyNone">no-op   </td><td class="markdownTableBodyNone">Remove entry    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>size()</code>   </td><td class="markdownTableBodyNone"><code>size_t</code>   </td><td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">Get entry count   </td></tr>
</table>
<hr  />
<h1><a class="anchor" id="autotoc_md1445"></a>
memory_result_backend</h1>
<p>In-memory implementation of result_backend_interface.</p>
<p><b>Header:</b> <code>&lt;kcenon/messaging/task/memory_result_backend.h&gt;</code></p>
<h2><a class="anchor" id="autotoc_md1446"></a>
Constructor</h2>
<div class="fragment"><div class="line">memory_result_backend();</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1447"></a>
Additional Methods</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>clear()</code>   </td><td class="markdownTableBodyNone"><code>void</code>   </td><td class="markdownTableBodyNone">Clear all stored data   </td></tr>
</table>
<p>All methods from <code>result_backend_interface</code> are implemented.</p>
<hr  />
<h1><a class="anchor" id="autotoc_md1449"></a>
task_scheduler</h1>
<p>Manages periodic and cron-based task scheduling.</p>
<p><b>Header:</b> <code>&lt;kcenon/messaging/task/scheduler.h&gt;</code></p>
<h2><a class="anchor" id="autotoc_md1450"></a>
Structures</h2>
<div class="fragment"><div class="line"><span class="keyword">struct </span>schedule_entry {</div>
<div class="line">    std::string name;</div>
<div class="line">    task task_template;</div>
<div class="line">    std::variant&lt;std::chrono::seconds, std::string&gt; schedule;</div>
<div class="line">    <span class="keywordtype">bool</span> enabled = <span class="keyword">true</span>;</div>
<div class="line">    std::optional&lt;time_point&gt; last_run;</div>
<div class="line">    std::optional&lt;time_point&gt; next_run;</div>
<div class="line">    <span class="keywordtype">size_t</span> run_count = 0;</div>
<div class="line">    <span class="keywordtype">size_t</span> failure_count = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">bool</span> is_cron() <span class="keyword">const</span>;</div>
<div class="line">    <span class="keywordtype">bool</span> is_periodic() <span class="keyword">const</span>;</div>
<div class="line">    std::string cron_expression() <span class="keyword">const</span>;</div>
<div class="line">    std::chrono::seconds interval() <span class="keyword">const</span>;</div>
<div class="line">};</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1451"></a>
Constructor</h2>
<div class="fragment"><div class="line"><span class="keyword">explicit</span> task_scheduler(task_client&amp; client);</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1452"></a>
Schedule Registration</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>add_periodic(name, task, interval)</code>   </td><td class="markdownTableBodyNone"><code>VoidResult</code>   </td><td class="markdownTableBodyNone">Add periodic schedule    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>add_cron(name, task, expression)</code>   </td><td class="markdownTableBodyNone"><code>VoidResult</code>   </td><td class="markdownTableBodyNone">Add cron schedule   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1453"></a>
Schedule Management</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>remove(name)</code>   </td><td class="markdownTableBodyNone"><code>VoidResult</code>   </td><td class="markdownTableBodyNone">Remove schedule    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>enable(name)</code>   </td><td class="markdownTableBodyNone"><code>VoidResult</code>   </td><td class="markdownTableBodyNone">Enable schedule    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>disable(name)</code>   </td><td class="markdownTableBodyNone"><code>VoidResult</code>   </td><td class="markdownTableBodyNone">Disable schedule    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>trigger_now(name)</code>   </td><td class="markdownTableBodyNone"><code>VoidResult</code>   </td><td class="markdownTableBodyNone">Trigger immediate execution    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>update_interval(name, interval)</code>   </td><td class="markdownTableBodyNone"><code>VoidResult</code>   </td><td class="markdownTableBodyNone">Update periodic interval    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>update_cron(name, expression)</code>   </td><td class="markdownTableBodyNone"><code>VoidResult</code>   </td><td class="markdownTableBodyNone">Update cron expression   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1454"></a>
Lifecycle</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>start()</code>   </td><td class="markdownTableBodyNone"><code>VoidResult</code>   </td><td class="markdownTableBodyNone">Start scheduler    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>stop()</code>   </td><td class="markdownTableBodyNone"><code>VoidResult</code>   </td><td class="markdownTableBodyNone">Stop scheduler    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>is_running()</code>   </td><td class="markdownTableBodyNone"><code>bool</code>   </td><td class="markdownTableBodyNone">Check if running   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1455"></a>
Query</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>list_schedules()</code>   </td><td class="markdownTableBodyNone"><code>vector&lt;schedule_entry&gt;</code>   </td><td class="markdownTableBodyNone">List all schedules    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>get_schedule(name)</code>   </td><td class="markdownTableBodyNone"><code>Result&lt;schedule_entry&gt;</code>   </td><td class="markdownTableBodyNone">Get specific schedule    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>schedule_count()</code>   </td><td class="markdownTableBodyNone"><code>size_t</code>   </td><td class="markdownTableBodyNone">Count schedules    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>has_schedule(name)</code>   </td><td class="markdownTableBodyNone"><code>bool</code>   </td><td class="markdownTableBodyNone">Check schedule exists   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1456"></a>
Event Callbacks</h2>
<div class="fragment"><div class="line"><span class="keyword">using </span>schedule_callback = std::function&lt;void(<span class="keyword">const</span> schedule_entry&amp;)&gt;;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> on_task_executed(schedule_callback callback);</div>
<div class="line"><span class="keywordtype">void</span> on_task_failed(schedule_callback callback);</div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md1458"></a>
cron_parser</h1>
<p>Utility for parsing and evaluating cron expressions.</p>
<p><b>Header:</b> <code>&lt;kcenon/messaging/task/cron_parser.h&gt;</code></p>
<h2><a class="anchor" id="autotoc_md1459"></a>
Cron Expression Format</h2>
<div class="fragment"><div class="line">* * * * *</div>
<div class="line">    </div>
<div class="line">     Day of week (0-6, 0=Sunday)</div>
<div class="line">    Month (1-12)</div>
<div class="line">   Day of month (1-31)</div>
<div class="line">  Hour (0-23)</div>
<div class="line"> Minute (0-59)</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1460"></a>
Supported Syntax</h2>
<ul>
<li><code>*</code> - All values</li>
<li><code>5</code> - Specific value</li>
<li><code>*/15</code> - Every N units</li>
<li><code>1-5</code> - Range</li>
<li><code>1,3,5</code> - List</li>
</ul>
<h2><a class="anchor" id="autotoc_md1461"></a>
Structure</h2>
<div class="fragment"><div class="line"><span class="keyword">struct </span>cron_expression {</div>
<div class="line">    std::set&lt;int&gt; minutes;   <span class="comment">// 0-59</span></div>
<div class="line">    std::set&lt;int&gt; hours;     <span class="comment">// 0-23</span></div>
<div class="line">    std::set&lt;int&gt; days;      <span class="comment">// 1-31</span></div>
<div class="line">    std::set&lt;int&gt; months;    <span class="comment">// 1-12</span></div>
<div class="line">    std::set&lt;int&gt; weekdays;  <span class="comment">// 0-6</span></div>
<div class="line">};</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1462"></a>
Static Methods</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>parse(expr)</code>   </td><td class="markdownTableBodyNone"><code>Result&lt;cron_expression&gt;</code>   </td><td class="markdownTableBodyNone">Parse cron string    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>next_run_time(expr, from)</code>   </td><td class="markdownTableBodyNone"><code>Result&lt;time_point&gt;</code>   </td><td class="markdownTableBodyNone">Calculate next run    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>is_valid(expr)</code>   </td><td class="markdownTableBodyNone"><code>bool</code>   </td><td class="markdownTableBodyNone">Validate expression    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>to_string(expr)</code>   </td><td class="markdownTableBodyNone"><code>string</code>   </td><td class="markdownTableBodyNone">Convert to string   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1463"></a>
Examples</h2>
<div class="fragment"><div class="line"><span class="comment">// Every hour at minute 0</span></div>
<div class="line"><span class="keyword">auto</span> expr = cron_parser::parse(<span class="stringliteral">&quot;0 * * * *&quot;</span>).value();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Daily at 3:00 AM</span></div>
<div class="line"><span class="keyword">auto</span> expr = cron_parser::parse(<span class="stringliteral">&quot;0 3 * * *&quot;</span>).value();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Every 15 minutes</span></div>
<div class="line"><span class="keyword">auto</span> expr = cron_parser::parse(<span class="stringliteral">&quot;*/15 * * * *&quot;</span>).value();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Weekdays at 9 AM</span></div>
<div class="line"><span class="keyword">auto</span> expr = cron_parser::parse(<span class="stringliteral">&quot;0 9 * * 1-5&quot;</span>).value();</div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md1465"></a>
task_monitor</h1>
<p>System monitoring and event subscriptions.</p>
<p><b>Header:</b> <code>&lt;kcenon/messaging/task/monitor.h&gt;</code></p>
<h2><a class="anchor" id="autotoc_md1466"></a>
Structures</h2>
<div class="fragment"><div class="line"><span class="keyword">struct </span>queue_stats {</div>
<div class="line">    std::string name;</div>
<div class="line">    <span class="keywordtype">size_t</span> pending_count = 0;</div>
<div class="line">    <span class="keywordtype">size_t</span> running_count = 0;</div>
<div class="line">    <span class="keywordtype">size_t</span> delayed_count = 0;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>worker_info {</div>
<div class="line">    std::string worker_id;</div>
<div class="line">    std::vector&lt;std::string&gt; queues;</div>
<div class="line">    <span class="keywordtype">size_t</span> active_tasks = 0;</div>
<div class="line">    std::chrono::system_clock::time_point last_heartbeat;</div>
<div class="line">    <span class="keywordtype">bool</span> is_healthy = <span class="keyword">true</span>;</div>
<div class="line">};</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1467"></a>
Constructor</h2>
<div class="fragment"><div class="line">task_monitor(</div>
<div class="line">    std::shared_ptr&lt;task_queue&gt; queue,</div>
<div class="line">    worker_pool* workers);</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1468"></a>
Queue Statistics</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>get_queue_stats()</code>   </td><td class="markdownTableBodyNone"><code>vector&lt;queue_stats&gt;</code>   </td><td class="markdownTableBodyNone">All queue stats    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>get_queue_stats(name)</code>   </td><td class="markdownTableBodyNone"><code>Result&lt;queue_stats&gt;</code>   </td><td class="markdownTableBodyNone">Specific queue stats   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1469"></a>
Worker Status</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>get_workers()</code>   </td><td class="markdownTableBodyNone"><code>vector&lt;worker_info&gt;</code>   </td><td class="markdownTableBodyNone">All worker info    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>get_worker_statistics()</code>   </td><td class="markdownTableBodyNone"><code>optional&lt;worker_statistics&gt;</code>   </td><td class="markdownTableBodyNone">Worker pool stats   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1470"></a>
Task Queries</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>list_active_tasks()</code>   </td><td class="markdownTableBodyNone"><code>vector&lt;task&gt;</code>   </td><td class="markdownTableBodyNone">Running tasks    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>list_pending_tasks(queue)</code>   </td><td class="markdownTableBodyNone"><code>vector&lt;task&gt;</code>   </td><td class="markdownTableBodyNone">Pending tasks    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>list_failed_tasks(limit)</code>   </td><td class="markdownTableBodyNone"><code>vector&lt;task&gt;</code>   </td><td class="markdownTableBodyNone">Failed tasks   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1471"></a>
Task Management</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>cancel_task(task_id)</code>   </td><td class="markdownTableBodyNone"><code>VoidResult</code>   </td><td class="markdownTableBodyNone">Cancel task    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>retry_task(task_id)</code>   </td><td class="markdownTableBodyNone"><code>VoidResult</code>   </td><td class="markdownTableBodyNone">Retry failed task    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>purge_queue(name)</code>   </td><td class="markdownTableBodyNone"><code>VoidResult</code>   </td><td class="markdownTableBodyNone">Clear queue   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1472"></a>
Event Subscriptions</h2>
<div class="fragment"><div class="line"><span class="keyword">using </span>task_started_handler = std::function&lt;void(<span class="keyword">const</span> task&amp;)&gt;;</div>
<div class="line"><span class="keyword">using </span>task_completed_handler = std::function&lt;void(<span class="keyword">const</span> task&amp;, <span class="keywordtype">bool</span> success)&gt;;</div>
<div class="line"><span class="keyword">using </span>task_failed_handler = std::function&lt;void(<span class="keyword">const</span> task&amp;, <span class="keyword">const</span> std::string&amp; error)&gt;;</div>
<div class="line"><span class="keyword">using </span>worker_offline_handler = std::function&lt;void(<span class="keyword">const</span> std::string&amp; worker_id)&gt;;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> on_task_started(task_started_handler handler);</div>
<div class="line"><span class="keywordtype">void</span> on_task_completed(task_completed_handler handler);</div>
<div class="line"><span class="keywordtype">void</span> on_task_failed(task_failed_handler handler);</div>
<div class="line"><span class="keywordtype">void</span> on_worker_offline(worker_offline_handler handler);</div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md1474"></a>
task_system</h1>
<p>Unified facade integrating all task components.</p>
<p><b>Header:</b> <code>&lt;kcenon/messaging/task/task_system.h&gt;</code></p>
<h2><a class="anchor" id="autotoc_md1475"></a>
Configuration</h2>
<div class="fragment"><div class="line"><span class="keyword">struct </span>task_system_config {</div>
<div class="line">    task_queue_config queue;</div>
<div class="line">    worker_config worker;</div>
<div class="line">    <span class="keywordtype">bool</span> enable_scheduler = <span class="keyword">true</span>;</div>
<div class="line">    <span class="keywordtype">bool</span> enable_monitoring = <span class="keyword">true</span>;</div>
<div class="line">    std::string result_backend_type = <span class="stringliteral">&quot;memory&quot;</span>;</div>
<div class="line">};</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1476"></a>
Constructor</h2>
<div class="fragment"><div class="line"><span class="keyword">explicit</span> task_system(<span class="keyword">const</span> task_system_config&amp; config = {});</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1477"></a>
Lifecycle</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>start()</code>   </td><td class="markdownTableBodyNone"><code>VoidResult</code>   </td><td class="markdownTableBodyNone">Start all components    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>stop()</code>   </td><td class="markdownTableBodyNone"><code>VoidResult</code>   </td><td class="markdownTableBodyNone">Stop all components    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>shutdown_graceful(timeout)</code>   </td><td class="markdownTableBodyNone"><code>VoidResult</code>   </td><td class="markdownTableBodyNone">Graceful shutdown    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>is_running()</code>   </td><td class="markdownTableBodyNone"><code>bool</code>   </td><td class="markdownTableBodyNone">Check if running   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1478"></a>
Component Access</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>client()</code>   </td><td class="markdownTableBodyNone"><code>task_client&amp;</code>   </td><td class="markdownTableBodyNone">Get task client    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>workers()</code>   </td><td class="markdownTableBodyNone"><code>worker_pool&amp;</code>   </td><td class="markdownTableBodyNone">Get worker pool    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>scheduler()</code>   </td><td class="markdownTableBodyNone"><code>task_scheduler*</code>   </td><td class="markdownTableBodyNone">Get scheduler (nullable)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>monitor()</code>   </td><td class="markdownTableBodyNone"><code>task_monitor*</code>   </td><td class="markdownTableBodyNone">Get monitor (nullable)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>queue()</code>   </td><td class="markdownTableBodyNone"><code>shared_ptr&lt;task_queue&gt;</code>   </td><td class="markdownTableBodyNone">Get queue    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>results()</code>   </td><td class="markdownTableBodyNone"><code>shared_ptr&lt;result_backend&gt;</code>   </td><td class="markdownTableBodyNone">Get result backend   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1479"></a>
Handler Registration (Convenience)</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>register_handler(shared_ptr&lt;handler&gt;)</code>   </td><td class="markdownTableBodyNone"><code>void</code>   </td><td class="markdownTableBodyNone">Register handler    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>register_handler(name, func)</code>   </td><td class="markdownTableBodyNone"><code>void</code>   </td><td class="markdownTableBodyNone">Register lambda    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>unregister_handler(name)</code>   </td><td class="markdownTableBodyNone"><code>bool</code>   </td><td class="markdownTableBodyNone">Unregister handler   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1480"></a>
Task Submission (Convenience)</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>submit(name, payload)</code>   </td><td class="markdownTableBodyNone"><code>async_result</code>   </td><td class="markdownTableBodyNone">Submit task    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>submit(task)</code>   </td><td class="markdownTableBodyNone"><code>async_result</code>   </td><td class="markdownTableBodyNone">Submit task    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>submit_later(task, delay)</code>   </td><td class="markdownTableBodyNone"><code>async_result</code>   </td><td class="markdownTableBodyNone">Submit delayed    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>submit_batch(tasks)</code>   </td><td class="markdownTableBodyNone"><code>vector&lt;async_result&gt;</code>   </td><td class="markdownTableBodyNone">Submit batch   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1481"></a>
Scheduling (Convenience)</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>schedule_periodic(name, task, interval)</code>   </td><td class="markdownTableBodyNone"><code>VoidResult</code>   </td><td class="markdownTableBodyNone">Add periodic    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>schedule_cron(name, task, expression)</code>   </td><td class="markdownTableBodyNone"><code>VoidResult</code>   </td><td class="markdownTableBodyNone">Add cron   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1482"></a>
Statistics</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Return Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>get_statistics()</code>   </td><td class="markdownTableBodyNone"><code>worker_statistics</code>   </td><td class="markdownTableBodyNone">Get worker stats    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>pending_count(queue)</code>   </td><td class="markdownTableBodyNone"><code>size_t</code>   </td><td class="markdownTableBodyNone">Pending task count    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>active_workers()</code>   </td><td class="markdownTableBodyNone"><code>size_t</code>   </td><td class="markdownTableBodyNone">Active worker count    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>total_workers()</code>   </td><td class="markdownTableBodyNone"><code>size_t</code>   </td><td class="markdownTableBodyNone">Total worker count   </td></tr>
</table>
<hr  />
<h1><a class="anchor" id="autotoc_md1484"></a>
Related Documentation</h1>
<ul>
<li><a class="el" href="../../d9/dff/md_docs_2task_2QUICK__START.html">Quick Start Guide</a></li>
<li><a class="el" href="../../d1/d5e/md_docs_2task_2ARCHITECTURE.html">Architecture Guide</a></li>
<li><a class="el" href="../../d5/dd2/md_docs_2task_2PATTERNS.html">Patterns Guide</a></li>
<li><a class="el" href="../../dc/d1e/md_docs_2task_2CONFIGURATION.html">Configuration Guide</a></li>
<li><a class="el" href="../../dd/df5/md_docs_2task_2TROUBLESHOOTING.html">Troubleshooting</a> </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
