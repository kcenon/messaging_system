<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Messaging System: Phase 1: Build System and Dependency Refactoring - Design Document</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Messaging System<span id="projectnumber">&#160;1.0.0</span>
   </div>
   <div id="projectbrief">High-Performance Cross-Platform Messaging Framework</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d5/d7c/md_docs_2phase1_2DESIGN.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Phase 1: Build System and Dependency Refactoring - Design Document</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md785"></a> </p>
<h1><a class="anchor" id="autotoc_md786"></a>
Overview</h1>
<p>This document provides detailed design specifications for Phase 1: integrating 7 external systems and removing legacy code from the build system.</p>
<h1><a class="anchor" id="autotoc_md787"></a>
Architecture Diagram</h1>
<div class="fragment"><div class="line">messaging_system (v2.0)</div>
<div class="line">│</div>
<div class="line">├── External Systems (via find_package or FetchContent)</div>
<div class="line">│   ├── CommonSystem::common</div>
<div class="line">│   ├── ThreadSystem::Core</div>
<div class="line">│   ├── LoggerSystem::logger</div>
<div class="line">│   ├── MonitoringSystem::monitoring</div>
<div class="line">│   ├── ContainerSystem::container</div>
<div class="line">│   ├── DatabaseSystem::database</div>
<div class="line">│   └── NetworkSystem::network</div>
<div class="line">│</div>
<div class="line">├── Internal Components (messaging-specific)</div>
<div class="line">│   ├── MessageBus</div>
<div class="line">│   ├── TopicRouter</div>
<div class="line">│   ├── MessageProcessor</div>
<div class="line">│   └── ServiceContainer</div>
<div class="line">│</div>
<div class="line">└── Configuration Layer</div>
<div class="line">    ├── CMake Build System</div>
<div class="line">    ├── CMake Presets</div>
<div class="line">    └── Validation Scripts</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md788"></a>
Task 1.1: External Module Integration</h1>
<h2><a class="anchor" id="autotoc_md789"></a>
Updated CMakeLists.txt Structure</h2>
<p><b>File:</b> <code>CMakeLists.txt</code> (root)</p>
<div class="fragment"><div class="line">cmake_minimum_required(VERSION 3.16)</div>
<div class="line"> </div>
<div class="line">project(messaging_system</div>
<div class="line">    VERSION 2.0.0</div>
<div class="line">    DESCRIPTION &quot;High-performance distributed messaging system&quot;</div>
<div class="line">    LANGUAGES CXX</div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line"># C++ Standard</div>
<div class="line">set(CMAKE_CXX_STANDARD 20)</div>
<div class="line">set(CMAKE_CXX_STANDARD_REQUIRED ON)</div>
<div class="line">set(CMAKE_CXX_EXTENSIONS OFF)</div>
<div class="line"> </div>
<div class="line"># Export compile commands for IDEs</div>
<div class="line">set(CMAKE_EXPORT_COMPILE_COMMANDS ON)</div>
<div class="line"> </div>
<div class="line"># ============================================================================</div>
<div class="line"># Build Options</div>
<div class="line"># ============================================================================</div>
<div class="line"> </div>
<div class="line"># Feature flags</div>
<div class="line">option(MESSAGING_USE_LOCKFREE &quot;Enable lock-free data structures&quot; OFF)</div>
<div class="line">option(MESSAGING_ENABLE_MONITORING &quot;Enable runtime monitoring&quot; ON)</div>
<div class="line">option(MESSAGING_ENABLE_LOGGING &quot;Enable logging system&quot; ON)</div>
<div class="line">option(MESSAGING_ENABLE_METRICS &quot;Enable metrics collection&quot; ON)</div>
<div class="line">option(MESSAGING_ENABLE_TLS &quot;Enable TLS/SSL support&quot; OFF)</div>
<div class="line"> </div>
<div class="line"># Dependency strategy</div>
<div class="line">option(MESSAGING_USE_EXTERNAL_SYSTEMS &quot;Use external system packages&quot; ON)</div>
<div class="line">option(MESSAGING_USE_FETCHCONTENT &quot;Use FetchContent for dependencies&quot; OFF)</div>
<div class="line"> </div>
<div class="line"># Development options</div>
<div class="line">option(MESSAGING_BUILD_TESTS &quot;Build unit tests&quot; ON)</div>
<div class="line">option(MESSAGING_BUILD_BENCHMARKS &quot;Build performance benchmarks&quot; OFF)</div>
<div class="line">option(MESSAGING_BUILD_EXAMPLES &quot;Build example applications&quot; ON)</div>
<div class="line">option(MESSAGING_BUILD_DOCS &quot;Build documentation with Doxygen&quot; OFF)</div>
<div class="line"> </div>
<div class="line"># Build profile</div>
<div class="line">set(MESSAGING_BUILD_PROFILE &quot;Release&quot; CACHE STRING &quot;Build profile&quot;)</div>
<div class="line">set_property(CACHE MESSAGING_BUILD_PROFILE PROPERTY STRINGS</div>
<div class="line">    &quot;Debug&quot; &quot;Release&quot; &quot;RelWithDebInfo&quot; &quot;MinSizeRel&quot;</div>
<div class="line">    &quot;ASAN&quot; &quot;TSAN&quot; &quot;UBSAN&quot; &quot;MSAN&quot;</div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line"># ============================================================================</div>
<div class="line"># Compiler Settings</div>
<div class="line"># ============================================================================</div>
<div class="line"> </div>
<div class="line"># Warning level</div>
<div class="line">set(MESSAGING_WARNING_LEVEL &quot;High&quot; CACHE STRING &quot;Compiler warning level&quot;)</div>
<div class="line"> </div>
<div class="line">if(MESSAGING_WARNING_LEVEL STREQUAL &quot;High&quot; OR MESSAGING_WARNING_LEVEL STREQUAL &quot;Pedantic&quot;)</div>
<div class="line">    if(CMAKE_CXX_COMPILER_ID MATCHES &quot;GNU|Clang&quot;)</div>
<div class="line">        add_compile_options(-Wall -Wextra -Wpedantic)</div>
<div class="line">        if(MESSAGING_WARNING_LEVEL STREQUAL &quot;Pedantic&quot;)</div>
<div class="line">            add_compile_options(-Werror -Wconversion -Wsign-conversion)</div>
<div class="line">        endif()</div>
<div class="line">    elseif(MSVC)</div>
<div class="line">        add_compile_options(/W4)</div>
<div class="line">        if(MESSAGING_WARNING_LEVEL STREQUAL &quot;Pedantic&quot;)</div>
<div class="line">            add_compile_options(/WX)</div>
<div class="line">        endif()</div>
<div class="line">    endif()</div>
<div class="line">endif()</div>
<div class="line"> </div>
<div class="line"># Build profile flags</div>
<div class="line">if(MESSAGING_BUILD_PROFILE STREQUAL &quot;ASAN&quot;)</div>
<div class="line">    set(CMAKE_CXX_FLAGS &quot;${CMAKE_CXX_FLAGS} -fsanitize=address -fno-omit-frame-pointer -g&quot;)</div>
<div class="line">    set(CMAKE_LINKER_FLAGS &quot;${CMAKE_LINKER_FLAGS} -fsanitize=address&quot;)</div>
<div class="line">elseif(MESSAGING_BUILD_PROFILE STREQUAL &quot;TSAN&quot;)</div>
<div class="line">    set(CMAKE_CXX_FLAGS &quot;${CMAKE_CXX_FLAGS} -fsanitize=thread -g&quot;)</div>
<div class="line">    set(CMAKE_LINKER_FLAGS &quot;${CMAKE_LINKER_FLAGS} -fsanitize=thread&quot;)</div>
<div class="line">elseif(MESSAGING_BUILD_PROFILE STREQUAL &quot;UBSAN&quot;)</div>
<div class="line">    set(CMAKE_CXX_FLAGS &quot;${CMAKE_CXX_FLAGS} -fsanitize=undefined -fno-sanitize-recover=all -g&quot;)</div>
<div class="line">    set(CMAKE_LINKER_FLAGS &quot;${CMAKE_LINKER_FLAGS} -fsanitize=undefined&quot;)</div>
<div class="line">elseif(MESSAGING_BUILD_PROFILE STREQUAL &quot;MSAN&quot;)</div>
<div class="line">    set(CMAKE_CXX_FLAGS &quot;${CMAKE_CXX_FLAGS} -fsanitize=memory -fno-omit-frame-pointer -g&quot;)</div>
<div class="line">    set(CMAKE_LINKER_FLAGS &quot;${CMAKE_LINKER_FLAGS} -fsanitize=memory&quot;)</div>
<div class="line">endif()</div>
<div class="line"> </div>
<div class="line"># ============================================================================</div>
<div class="line"># External System Integration</div>
<div class="line"># ============================================================================</div>
<div class="line"> </div>
<div class="line">if(MESSAGING_USE_EXTERNAL_SYSTEMS)</div>
<div class="line">    message(STATUS &quot;Using external system packages&quot;)</div>
<div class="line"> </div>
<div class="line">    if(MESSAGING_USE_FETCHCONTENT)</div>
<div class="line">        # FetchContent mode (development)</div>
<div class="line">        message(STATUS &quot;Using FetchContent for external systems&quot;)</div>
<div class="line">        include(FetchContent)</div>
<div class="line"> </div>
<div class="line">        # Common System</div>
<div class="line">        FetchContent_Declare(</div>
<div class="line">            CommonSystem</div>
<div class="line">            GIT_REPOSITORY https://github.com/kcenon/common_system.git</div>
<div class="line">            GIT_TAG v1.0.0</div>
<div class="line">            GIT_SHALLOW TRUE</div>
<div class="line">        )</div>
<div class="line"> </div>
<div class="line">        # Thread System</div>
<div class="line">        FetchContent_Declare(</div>
<div class="line">            ThreadSystem</div>
<div class="line">            GIT_REPOSITORY https://github.com/kcenon/thread_system.git</div>
<div class="line">            GIT_TAG v1.0.0</div>
<div class="line">            GIT_SHALLOW TRUE</div>
<div class="line">        )</div>
<div class="line"> </div>
<div class="line">        # Logger System</div>
<div class="line">        FetchContent_Declare(</div>
<div class="line">            LoggerSystem</div>
<div class="line">            GIT_REPOSITORY https://github.com/kcenon/logger_system.git</div>
<div class="line">            GIT_TAG v1.0.0</div>
<div class="line">            GIT_SHALLOW TRUE</div>
<div class="line">        )</div>
<div class="line"> </div>
<div class="line">        # Monitoring System</div>
<div class="line">        FetchContent_Declare(</div>
<div class="line">            MonitoringSystem</div>
<div class="line">            GIT_REPOSITORY https://github.com/kcenon/monitoring_system.git</div>
<div class="line">            GIT_TAG v1.0.0</div>
<div class="line">            GIT_SHALLOW TRUE</div>
<div class="line">        )</div>
<div class="line"> </div>
<div class="line">        # Container System</div>
<div class="line">        FetchContent_Declare(</div>
<div class="line">            ContainerSystem</div>
<div class="line">            GIT_REPOSITORY https://github.com/kcenon/container_system.git</div>
<div class="line">            GIT_TAG v1.0.0</div>
<div class="line">            GIT_SHALLOW TRUE</div>
<div class="line">        )</div>
<div class="line"> </div>
<div class="line">        # Database System</div>
<div class="line">        FetchContent_Declare(</div>
<div class="line">            DatabaseSystem</div>
<div class="line">            GIT_REPOSITORY https://github.com/kcenon/database_system.git</div>
<div class="line">            GIT_TAG v1.0.0</div>
<div class="line">            GIT_SHALLOW TRUE</div>
<div class="line">        )</div>
<div class="line"> </div>
<div class="line">        # Network System</div>
<div class="line">        FetchContent_Declare(</div>
<div class="line">            NetworkSystem</div>
<div class="line">            GIT_REPOSITORY https://github.com/kcenon/network_system.git</div>
<div class="line">            GIT_TAG v1.0.0</div>
<div class="line">            GIT_SHALLOW TRUE</div>
<div class="line">        )</div>
<div class="line"> </div>
<div class="line">        FetchContent_MakeAvailable(</div>
<div class="line">            CommonSystem</div>
<div class="line">            ThreadSystem</div>
<div class="line">            LoggerSystem</div>
<div class="line">            MonitoringSystem</div>
<div class="line">            ContainerSystem</div>
<div class="line">            DatabaseSystem</div>
<div class="line">            NetworkSystem</div>
<div class="line">        )</div>
<div class="line"> </div>
<div class="line">    else()</div>
<div class="line">        # find_package mode (production)</div>
<div class="line">        message(STATUS &quot;Using find_package for external systems&quot;)</div>
<div class="line"> </div>
<div class="line">        list(APPEND CMAKE_MODULE_PATH ${CMAKE_CURRENT_SOURCE_DIR}/cmake)</div>
<div class="line"> </div>
<div class="line">        find_package(CommonSystem 1.0 REQUIRED)</div>
<div class="line">        find_package(ThreadSystem 1.0 REQUIRED)</div>
<div class="line">        find_package(LoggerSystem 1.0 REQUIRED)</div>
<div class="line">        find_package(MonitoringSystem 1.0 REQUIRED)</div>
<div class="line">        find_package(ContainerSystem 1.0 REQUIRED)</div>
<div class="line">        find_package(DatabaseSystem 1.0 REQUIRED)</div>
<div class="line">        find_package(NetworkSystem 1.0 REQUIRED)</div>
<div class="line">    endif()</div>
<div class="line"> </div>
<div class="line">    # Validate dependencies</div>
<div class="line">    include(cmake/validate_dependencies.cmake)</div>
<div class="line">    validate_messaging_dependencies()</div>
<div class="line"> </div>
<div class="line">    # Create backward-compatible aliases</div>
<div class="line">    if(NOT TARGET common)</div>
<div class="line">        add_library(common ALIAS CommonSystem::common)</div>
<div class="line">    endif()</div>
<div class="line"> </div>
<div class="line">    if(NOT TARGET thread_pool)</div>
<div class="line">        add_library(thread_pool ALIAS ThreadSystem::Core)</div>
<div class="line">    endif()</div>
<div class="line"> </div>
<div class="line">    if(NOT TARGET logger)</div>
<div class="line">        add_library(logger ALIAS LoggerSystem::logger)</div>
<div class="line">    endif()</div>
<div class="line"> </div>
<div class="line">    if(NOT TARGET monitoring)</div>
<div class="line">        add_library(monitoring ALIAS MonitoringSystem::monitoring)</div>
<div class="line">    endif()</div>
<div class="line"> </div>
<div class="line">    if(NOT TARGET container)</div>
<div class="line">        add_library(container ALIAS ContainerSystem::container)</div>
<div class="line">    endif()</div>
<div class="line"> </div>
<div class="line">    if(NOT TARGET database)</div>
<div class="line">        add_library(database ALIAS DatabaseSystem::database)</div>
<div class="line">    endif()</div>
<div class="line"> </div>
<div class="line">    if(NOT TARGET network)</div>
<div class="line">        add_library(network ALIAS NetworkSystem::network)</div>
<div class="line">    endif()</div>
<div class="line"> </div>
<div class="line">    # Define HAS_* macros for legacy_guard.h</div>
<div class="line">    target_compile_definitions(messaging_system PUBLIC</div>
<div class="line">        HAS_COMMON_SYSTEM</div>
<div class="line">        HAS_THREAD_SYSTEM</div>
<div class="line">        HAS_LOGGER_SYSTEM</div>
<div class="line">        HAS_MONITORING_SYSTEM</div>
<div class="line">        HAS_CONTAINER_SYSTEM</div>
<div class="line">        HAS_DATABASE_SYSTEM</div>
<div class="line">        HAS_NETWORK_SYSTEM</div>
<div class="line">        MESSAGING_USE_EXTERNAL_SYSTEMS</div>
<div class="line">    )</div>
<div class="line"> </div>
<div class="line">else()</div>
<div class="line">    message(WARNING &quot;Building without external systems (legacy mode)&quot;)</div>
<div class="line">    # Fall back to internal implementations (deprecated)</div>
<div class="line">    add_subdirectory(libraries/container_system)</div>
<div class="line">    add_subdirectory(libraries/network_system)</div>
<div class="line">    add_subdirectory(libraries/thread_system)</div>
<div class="line">endif()</div>
<div class="line"> </div>
<div class="line"># ============================================================================</div>
<div class="line"># Propagate Options to External Systems</div>
<div class="line"># ============================================================================</div>
<div class="line"> </div>
<div class="line">if(MESSAGING_USE_LOCKFREE)</div>
<div class="line">    set(USE_LOCKFREE_BY_DEFAULT ON CACHE BOOL &quot;&quot; FORCE)</div>
<div class="line">    set(USE_LOCKFREE_THREAD_POOL ON CACHE BOOL &quot;&quot; FORCE)</div>
<div class="line">endif()</div>
<div class="line"> </div>
<div class="line">if(MESSAGING_ENABLE_MONITORING)</div>
<div class="line">    set(ENABLE_MONITORING ON CACHE BOOL &quot;&quot; FORCE)</div>
<div class="line">endif()</div>
<div class="line"> </div>
<div class="line">if(MESSAGING_ENABLE_LOGGING)</div>
<div class="line">    set(ENABLE_LOGGING ON CACHE BOOL &quot;&quot; FORCE)</div>
<div class="line">endif()</div>
<div class="line"> </div>
<div class="line">if(MESSAGING_ENABLE_TLS)</div>
<div class="line">    set(ENABLE_TLS ON CACHE BOOL &quot;&quot; FORCE)</div>
<div class="line">endif()</div>
<div class="line"> </div>
<div class="line"># ============================================================================</div>
<div class="line"># Messaging System Core Library</div>
<div class="line"># ============================================================================</div>
<div class="line"> </div>
<div class="line">add_library(messaging_system_core</div>
<div class="line">    src/core/message_bus.cpp</div>
<div class="line">    src/core/topic_router.cpp</div>
<div class="line">    src/core/message_processor.cpp</div>
<div class="line">    src/core/service_container.cpp</div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line">target_include_directories(messaging_system_core</div>
<div class="line">    PUBLIC</div>
<div class="line">        $&lt;BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}/include&gt;</div>
<div class="line">        $&lt;INSTALL_INTERFACE:include&gt;</div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line">target_link_libraries(messaging_system_core</div>
<div class="line">    PUBLIC</div>
<div class="line">        CommonSystem::common</div>
<div class="line">        ThreadSystem::Core</div>
<div class="line">        LoggerSystem::logger</div>
<div class="line">        MonitoringSystem::monitoring</div>
<div class="line">        ContainerSystem::container</div>
<div class="line">        DatabaseSystem::database</div>
<div class="line">        NetworkSystem::network</div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line">target_compile_features(messaging_system_core PUBLIC cxx_std_20)</div>
<div class="line"> </div>
<div class="line"># ============================================================================</div>
<div class="line"># Main Executable</div>
<div class="line"># ============================================================================</div>
<div class="line"> </div>
<div class="line">add_executable(messaging_system</div>
<div class="line">    src/main.cpp</div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line">target_link_libraries(messaging_system</div>
<div class="line">    PRIVATE</div>
<div class="line">        messaging_system_core</div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line"># ============================================================================</div>
<div class="line"># Tests</div>
<div class="line"># ============================================================================</div>
<div class="line"> </div>
<div class="line">if(MESSAGING_BUILD_TESTS)</div>
<div class="line">    enable_testing()</div>
<div class="line">    add_subdirectory(test)</div>
<div class="line">endif()</div>
<div class="line"> </div>
<div class="line"># ============================================================================</div>
<div class="line"># Benchmarks</div>
<div class="line"># ============================================================================</div>
<div class="line"> </div>
<div class="line">if(MESSAGING_BUILD_BENCHMARKS)</div>
<div class="line">    add_subdirectory(benchmarks)</div>
<div class="line">endif()</div>
<div class="line"> </div>
<div class="line"># ============================================================================</div>
<div class="line"># Examples</div>
<div class="line"># ============================================================================</div>
<div class="line"> </div>
<div class="line">if(MESSAGING_BUILD_EXAMPLES)</div>
<div class="line">    add_subdirectory(examples)</div>
<div class="line">endif()</div>
<div class="line"> </div>
<div class="line"># ============================================================================</div>
<div class="line"># Documentation</div>
<div class="line"># ============================================================================</div>
<div class="line"> </div>
<div class="line">if(MESSAGING_BUILD_DOCS)</div>
<div class="line">    find_package(Doxygen)</div>
<div class="line">    if(DOXYGEN_FOUND)</div>
<div class="line">        add_subdirectory(docs)</div>
<div class="line">    endif()</div>
<div class="line">endif()</div>
<div class="line"> </div>
<div class="line"># ============================================================================</div>
<div class="line"># Installation</div>
<div class="line"># ============================================================================</div>
<div class="line"> </div>
<div class="line">install(TARGETS messaging_system_core messaging_system</div>
<div class="line">    EXPORT messaging_system_targets</div>
<div class="line">    RUNTIME DESTINATION bin</div>
<div class="line">    LIBRARY DESTINATION lib</div>
<div class="line">    ARCHIVE DESTINATION lib</div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line">install(DIRECTORY include/</div>
<div class="line">    DESTINATION include</div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line">install(EXPORT messaging_system_targets</div>
<div class="line">    FILE messaging_system-targets.cmake</div>
<div class="line">    NAMESPACE MessagingSystem::</div>
<div class="line">    DESTINATION lib/cmake/messaging_system</div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line"># ============================================================================</div>
<div class="line"># Summary</div>
<div class="line"># ============================================================================</div>
<div class="line"> </div>
<div class="line">message(STATUS &quot;&quot;)</div>
<div class="line">message(STATUS &quot;=== Messaging System Configuration ===&quot;)</div>
<div class="line">message(STATUS &quot;Version: ${PROJECT_VERSION}&quot;)</div>
<div class="line">message(STATUS &quot;Build type: ${CMAKE_BUILD_TYPE}&quot;)</div>
<div class="line">message(STATUS &quot;Build profile: ${MESSAGING_BUILD_PROFILE}&quot;)</div>
<div class="line">message(STATUS &quot;&quot;)</div>
<div class="line">message(STATUS &quot;Features:&quot;)</div>
<div class="line">message(STATUS &quot;  Lock-free: ${MESSAGING_USE_LOCKFREE}&quot;)</div>
<div class="line">message(STATUS &quot;  Monitoring: ${MESSAGING_ENABLE_MONITORING}&quot;)</div>
<div class="line">message(STATUS &quot;  Logging: ${MESSAGING_ENABLE_LOGGING}&quot;)</div>
<div class="line">message(STATUS &quot;  Metrics: ${MESSAGING_ENABLE_METRICS}&quot;)</div>
<div class="line">message(STATUS &quot;  TLS: ${MESSAGING_ENABLE_TLS}&quot;)</div>
<div class="line">message(STATUS &quot;&quot;)</div>
<div class="line">message(STATUS &quot;Build options:&quot;)</div>
<div class="line">message(STATUS &quot;  Tests: ${MESSAGING_BUILD_TESTS}&quot;)</div>
<div class="line">message(STATUS &quot;  Benchmarks: ${MESSAGING_BUILD_BENCHMARKS}&quot;)</div>
<div class="line">message(STATUS &quot;  Examples: ${MESSAGING_BUILD_EXAMPLES}&quot;)</div>
<div class="line">message(STATUS &quot;  Documentation: ${MESSAGING_BUILD_DOCS}&quot;)</div>
<div class="line">message(STATUS &quot;&quot;)</div>
<div class="line">message(STATUS &quot;External systems: ${MESSAGING_USE_EXTERNAL_SYSTEMS}&quot;)</div>
<div class="line">if(MESSAGING_USE_EXTERNAL_SYSTEMS)</div>
<div class="line">    message(STATUS &quot;  Using FetchContent: ${MESSAGING_USE_FETCHCONTENT}&quot;)</div>
<div class="line">endif()</div>
<div class="line">message(STATUS &quot;======================================&quot;)</div>
<div class="line">message(STATUS &quot;&quot;)</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md790"></a>
Dependency Validation Script</h2>
<p><b>File:</b> <code>cmake/validate_dependencies.cmake</code></p>
<div class="fragment"><div class="line">function(validate_messaging_dependencies)</div>
<div class="line">    set(REQUIRED_TARGETS</div>
<div class="line">        CommonSystem::common</div>
<div class="line">        ThreadSystem::Core</div>
<div class="line">        LoggerSystem::logger</div>
<div class="line">        MonitoringSystem::monitoring</div>
<div class="line">        ContainerSystem::container</div>
<div class="line">        DatabaseSystem::database</div>
<div class="line">        NetworkSystem::network</div>
<div class="line">    )</div>
<div class="line"> </div>
<div class="line">    set(MISSING_TARGETS &quot;&quot;)</div>
<div class="line"> </div>
<div class="line">    foreach(target ${REQUIRED_TARGETS})</div>
<div class="line">        if(NOT TARGET ${target})</div>
<div class="line">            list(APPEND MISSING_TARGETS ${target})</div>
<div class="line">        endif()</div>
<div class="line">    endforeach()</div>
<div class="line"> </div>
<div class="line">    if(MISSING_TARGETS)</div>
<div class="line">        message(FATAL_ERROR</div>
<div class="line">            &quot;Required dependencies not found: ${MISSING_TARGETS}\n&quot;</div>
<div class="line">            &quot;Please install missing packages or enable FetchContent:\n&quot;</div>
<div class="line">            &quot;  cmake -DMESSAGING_USE_FETCHCONTENT=ON ..\n&quot;</div>
<div class="line">            &quot;\n&quot;</div>
<div class="line">            &quot;Or install packages:\n&quot;</div>
<div class="line">            &quot;  Ubuntu/Debian: apt-get install lib&lt;system&gt;-dev\n&quot;</div>
<div class="line">            &quot;  macOS: brew install &lt;system&gt;\n&quot;</div>
<div class="line">        )</div>
<div class="line">    endif()</div>
<div class="line"> </div>
<div class="line">    message(STATUS &quot;✓ All messaging_system dependencies validated&quot;)</div>
<div class="line">endfunction()</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md791"></a>
Task 1.2: Compiler Options and Feature Flags</h1>
<h2><a class="anchor" id="autotoc_md792"></a>
Flag Propagation Strategy</h2>
<p><b>Unified Configuration Table:</b></p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Messaging Flag   </th><th class="markdownTableHeadNone">Target System   </th><th class="markdownTableHeadNone">Target Flag   </th><th class="markdownTableHeadNone">Default    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>MESSAGING_USE_LOCKFREE</code>   </td><td class="markdownTableBodyNone">thread_system   </td><td class="markdownTableBodyNone"><code>USE_LOCKFREE_THREAD_POOL</code>   </td><td class="markdownTableBodyNone">OFF    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>MESSAGING_USE_LOCKFREE</code>   </td><td class="markdownTableBodyNone">logger_system   </td><td class="markdownTableBodyNone"><code>USE_LOCKFREE_LOGGER</code>   </td><td class="markdownTableBodyNone">OFF    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>MESSAGING_ENABLE_MONITORING</code>   </td><td class="markdownTableBodyNone">All systems   </td><td class="markdownTableBodyNone"><code>ENABLE_MONITORING</code>   </td><td class="markdownTableBodyNone">ON    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>MESSAGING_ENABLE_LOGGING</code>   </td><td class="markdownTableBodyNone">All systems   </td><td class="markdownTableBodyNone"><code>ENABLE_LOGGING</code>   </td><td class="markdownTableBodyNone">ON    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>MESSAGING_ENABLE_TLS</code>   </td><td class="markdownTableBodyNone">network_system   </td><td class="markdownTableBodyNone"><code>ENABLE_TLS</code>   </td><td class="markdownTableBodyNone">OFF   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md793"></a>
CMakePresets.json (Already created in Phase 0)</h2>
<p>Located at project root, defines presets for:</p><ul>
<li>default</li>
<li>debug</li>
<li>release</li>
<li>asan, tsan, ubsan</li>
<li>dev-fetchcontent</li>
<li>ci</li>
</ul>
<h1><a class="anchor" id="autotoc_md794"></a>
Task 1.3: Configuration Validation</h1>
<h2><a class="anchor" id="autotoc_md795"></a>
Validation Checklist</h2>
<p>Pre-build validation ensures:</p><ol type="1">
<li>All 7 external systems are available</li>
<li>Version compatibility (all v1.0+)</li>
<li>Required features enabled in dependencies</li>
<li>No conflicting options</li>
</ol>
<h2><a class="anchor" id="autotoc_md796"></a>
Post-build Verification</h2>
<div class="fragment"><div class="line"># Verify all external libraries linked</div>
<div class="line">ldd build/bin/messaging_system | grep -E &quot;(common|thread|logger|monitoring|container|database|network)&quot;</div>
<div class="line"> </div>
<div class="line"># Expected output:</div>
<div class="line"># libcommon.so.1 =&gt; /usr/lib/libcommon.so.1</div>
<div class="line"># libthread.so.1 =&gt; /usr/lib/libthread.so.1</div>
<div class="line"># ...</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md797"></a>
Task 1.4: Legacy Code Removal</h1>
<h2><a class="anchor" id="autotoc_md798"></a>
Execution Steps</h2>
<ol type="1">
<li><b>Backup current state</b> <div class="fragment"><div class="line">git checkout -b backup/pre-phase1</div>
<div class="line">git push origin backup/pre-phase1</div>
</div><!-- fragment --></li>
<li><b>Run archive script</b> <div class="fragment"><div class="line">./scripts/archive_legacy.sh</div>
</div><!-- fragment --></li>
<li><b>Verify archive</b> <div class="fragment"><div class="line">ls -la _archived/$(date +%Y%m%d)*</div>
</div><!-- fragment --></li>
<li><b>Update CMakeLists.txt</b><ul>
<li>Comment out internal add_subdirectory() calls</li>
<li>Add external system integration</li>
<li>Add validation calls</li>
</ul>
</li>
<li><b>Test build</b> <div class="fragment"><div class="line">cmake --preset dev-fetchcontent</div>
<div class="line">cmake --build --preset debug</div>
<div class="line">ctest --preset default</div>
</div><!-- fragment --></li>
<li><b>Commit changes</b> <div class="fragment"><div class="line">git add -A</div>
<div class="line">git commit -m &quot;Phase 1: External system integration complete&quot;</div>
</div><!-- fragment --></li>
</ol>
<h1><a class="anchor" id="autotoc_md799"></a>
Success Criteria</h1>
<h2><a class="anchor" id="autotoc_md800"></a>
Build Success</h2>
<ul>
<li>[ ] CMake configuration succeeds with find_package</li>
<li>[ ] CMake configuration succeeds with FetchContent</li>
<li>[ ] All targets build without errors</li>
<li>[ ] No warnings with -Wpedantic</li>
</ul>
<h2><a class="anchor" id="autotoc_md801"></a>
Functionality</h2>
<ul>
<li>[ ] All unit tests pass</li>
<li>[ ] Integration tests pass</li>
<li>[ ] Examples build and run</li>
</ul>
<h2><a class="anchor" id="autotoc_md802"></a>
Performance</h2>
<ul>
<li>[ ] No performance regression (benchmark comparison)</li>
<li>[ ] Binary size within 10% of baseline</li>
</ul>
<h2><a class="anchor" id="autotoc_md803"></a>
Documentation</h2>
<ul>
<li>[ ] Updated README with new build instructions</li>
<li>[ ] Migration guide completed</li>
<li>[ ] API documentation updated</li>
</ul>
<h1><a class="anchor" id="autotoc_md804"></a>
Implementation Timeline</h1>
<ul>
<li><b>Day 1:</b> Update CMakeLists.txt root</li>
<li><b>Day 2:</b> Create validation scripts, CMake modules</li>
<li><b>Day 3:</b> Test FetchContent mode</li>
<li><b>Day 4:</b> Test find_package mode</li>
<li><b>Day 5:</b> Archive legacy code, final testing</li>
</ul>
<h1><a class="anchor" id="autotoc_md805"></a>
Rollback Plan</h1>
<p>If Phase 1 fails:</p><ol type="1">
<li>Restore from <code>_archived/</code> directory</li>
<li>Revert CMakeLists.txt changes</li>
<li>Rebuild with internal systems</li>
<li>Document failure reasons</li>
<li>Adjust plan and retry</li>
</ol>
<h1><a class="anchor" id="autotoc_md806"></a>
Next Phase</h1>
<p>Upon successful completion, proceed to Phase 2: Messaging Core Redesign. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
