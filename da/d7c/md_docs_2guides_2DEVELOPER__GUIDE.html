<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Messaging System: Developer Guide</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Messaging System<span id="projectnumber">&#160;1.0.0</span>
   </div>
   <div id="projectbrief">High-Performance Cross-Platform Messaging Framework</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('da/d7c/md_docs_2guides_2DEVELOPER__GUIDE.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Developer Guide</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md850"></a> </p>
<h1><a class="anchor" id="autotoc_md851"></a>
Quick Start</h1>
<p>This guide helps developers get up and running with the Messaging System quickly and efficiently.</p>
<h2><a class="anchor" id="autotoc_md852"></a>
Prerequisites</h2>
<p>Before starting, ensure you have:</p><ul>
<li>C++20 compatible compiler (GCC 10+, Clang 12+, or MSVC 2019+)</li>
<li>CMake 3.16 or later</li>
<li>Git</li>
<li>PostgreSQL 12+ (optional, for database features)</li>
<li>Python 3.8+ (optional, for Python bindings)</li>
</ul>
<h2><a class="anchor" id="autotoc_md853"></a>
1. Clone and Setup</h2>
<div class="fragment"><div class="line"># Clone the repository</div>
<div class="line">git clone &lt;repository-url&gt; messaging_system</div>
<div class="line">cd messaging_system</div>
<div class="line"> </div>
<div class="line"># Initialize submodules (vcpkg)</div>
<div class="line">git submodule update --init --recursive</div>
<div class="line"> </div>
<div class="line"># Install system dependencies</div>
<div class="line">./scripts/dependency.sh</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md854"></a>
2. Build the Project</h2>
<div class="fragment"><div class="line"># Quick build with default settings</div>
<div class="line">./scripts/build.sh</div>
<div class="line"> </div>
<div class="line"># Build with specific options</div>
<div class="line">./scripts/build.sh --tests --release --parallel 8</div>
<div class="line"> </div>
<div class="line"># Manual CMake build</div>
<div class="line">mkdir build &amp;&amp; cd build</div>
<div class="line">cmake .. -DCMAKE_BUILD_TYPE=Release \</div>
<div class="line">         -DCMAKE_TOOLCHAIN_FILE=../vcpkg/scripts/buildsystems/vcpkg.cmake</div>
<div class="line">cmake --build . --parallel</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md855"></a>
3. Your First Application</h2>
<p>Create a simple messaging application:</p>
<div class="fragment"><div class="line"><span class="comment">// simple_app.cpp</span></div>
<div class="line"><span class="preprocessor">#include &lt;kcenon/messaging/core/message_bus.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;kcenon/messaging/services/network/network_service.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span>kcenon::messaging;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">    <span class="comment">// Initialize message bus</span></div>
<div class="line">    core::message_bus_config config;</div>
<div class="line">    config.worker_threads = 4;</div>
<div class="line">    core::message_bus bus(config);</div>
<div class="line">    bus.initialize();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Subscribe to messages</span></div>
<div class="line">    bus.subscribe(<span class="stringliteral">&quot;greeting&quot;</span>, [](<span class="keyword">const</span> core::message&amp; msg) {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Received: &quot;</span> &lt;&lt; msg.get_payload().get&lt;std::string&gt;(<span class="stringliteral">&quot;text&quot;</span>) &lt;&lt; std::endl;</div>
<div class="line">        <span class="keywordflow">return</span> core::message_status::processed;</div>
<div class="line">    });</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Publish a message</span></div>
<div class="line">    core::message_payload payload;</div>
<div class="line">    payload.set(<span class="stringliteral">&quot;text&quot;</span>, <span class="stringliteral">&quot;Hello, Messaging System!&quot;</span>);</div>
<div class="line">    bus.publish(<span class="stringliteral">&quot;greeting&quot;</span>, payload);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Keep running</span></div>
<div class="line">    std::this_thread::sleep_for(std::chrono::seconds(1));</div>
<div class="line">    bus.shutdown();</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><p>Compile and run: </p><div class="fragment"><div class="line">g++ -std=c++20 simple_app.cpp -lmessaging_core -lmessaging_services -o simple_app</div>
<div class="line">./simple_app</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md856"></a>
Development Setup</h1>
<h2><a class="anchor" id="autotoc_md857"></a>
IDE Configuration</h2>
<h3><a class="anchor" id="autotoc_md858"></a>
Visual Studio Code</h3>
<p><code>.vscode/settings.json</code>: </p><div class="fragment"><div class="line">{</div>
<div class="line">    &quot;cmake.configureSettings&quot;: {</div>
<div class="line">        &quot;CMAKE_BUILD_TYPE&quot;: &quot;Debug&quot;,</div>
<div class="line">        &quot;CMAKE_TOOLCHAIN_FILE&quot;: &quot;${workspaceFolder}/vcpkg/scripts/buildsystems/vcpkg.cmake&quot;</div>
<div class="line">    },</div>
<div class="line">    &quot;C_Cpp.default.cppStandard&quot;: &quot;c++20&quot;,</div>
<div class="line">    &quot;C_Cpp.default.includePath&quot;: [</div>
<div class="line">        &quot;${workspaceFolder}/libraries/*/include&quot;,</div>
<div class="line">        &quot;${workspaceFolder}/application_layer/include&quot;</div>
<div class="line">    ]</div>
<div class="line">}</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md859"></a>
CLion</h3>
<ol type="1">
<li>Open project and set CMake toolchain file</li>
<li>Add build configurations for Debug/Release</li>
<li>Set C++20 standard in CMake settings</li>
</ol>
<h3><a class="anchor" id="autotoc_md860"></a>
Visual Studio</h3>
<ol type="1">
<li>Open folder as CMake project</li>
<li>Configure CMake settings to use vcpkg toolchain</li>
<li>Select x64-Debug or x64-Release configuration</li>
</ol>
<h2><a class="anchor" id="autotoc_md861"></a>
Development Dependencies</h2>
<p>Install development tools:</p>
<div class="fragment"><div class="line"># Ubuntu/Debian</div>
<div class="line">sudo apt-get install -y \</div>
<div class="line">    build-essential \</div>
<div class="line">    cmake \</div>
<div class="line">    ninja-build \</div>
<div class="line">    gdb \</div>
<div class="line">    valgrind \</div>
<div class="line">    clang-format \</div>
<div class="line">    clang-tidy \</div>
<div class="line">    doxygen \</div>
<div class="line">    graphviz</div>
<div class="line"> </div>
<div class="line"># macOS</div>
<div class="line">brew install \</div>
<div class="line">    cmake \</div>
<div class="line">    ninja \</div>
<div class="line">    llvm \</div>
<div class="line">    doxygen \</div>
<div class="line">    graphviz</div>
<div class="line"> </div>
<div class="line"># Windows (with Chocolatey)</div>
<div class="line">choco install \</div>
<div class="line">    cmake \</div>
<div class="line">    ninja \</div>
<div class="line">    llvm \</div>
<div class="line">    doxygen.install</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md862"></a>
Project Structure</h1>
<h2><a class="anchor" id="autotoc_md863"></a>
Directory Layout</h2>
<div class="fragment"><div class="line">messaging_system/</div>
<div class="line">├── libraries/                  # Core system libraries</div>
<div class="line">│   ├── container_system/       # Data serialization</div>
<div class="line">│   ├── database_system/        # Database connectivity</div>
<div class="line">│   ├── network_system/         # Network communication</div>
<div class="line">│   ├── thread_system/          # Concurrency primitives</div>
<div class="line">│   ├── logger_system/          # Logging infrastructure</div>
<div class="line">│   └── monitoring_system/      # Metrics and monitoring</div>
<div class="line">├── application_layer/          # Application services</div>
<div class="line">│   ├── include/               # Public headers</div>
<div class="line">│   ├── src/                   # Implementation</div>
<div class="line">│   ├── samples/               # Example applications</div>
<div class="line">│   ├── tests/                 # Unit and integration tests</div>
<div class="line">│   └── python_bindings/       # Python API</div>
<div class="line">├── test/                      # System-wide tests</div>
<div class="line">├── scripts/                   # Build and utility scripts</div>
<div class="line">├── cmake/                     # CMake modules</div>
<div class="line">└── docs/                      # Documentation</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md864"></a>
Module Organization</h2>
<p>Each module follows this structure: </p><div class="fragment"><div class="line">module_name/</div>
<div class="line">├── include/                   # Public headers</div>
<div class="line">│   └── module_name/</div>
<div class="line">│       ├── module.h</div>
<div class="line">│       └── types.h</div>
<div class="line">├── src/                       # Implementation</div>
<div class="line">│   ├── module.cpp</div>
<div class="line">│   └── internal/</div>
<div class="line">│       └── helpers.cpp</div>
<div class="line">├── tests/                     # Module tests</div>
<div class="line">│   ├── unit/</div>
<div class="line">│   └── integration/</div>
<div class="line">├── benchmarks/                # Performance tests</div>
<div class="line">└── CMakeLists.txt</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md865"></a>
Coding Standards</h1>
<h2><a class="anchor" id="autotoc_md866"></a>
C++ Style Guide</h2>
<h3><a class="anchor" id="autotoc_md867"></a>
Naming Conventions</h3>
<div class="fragment"><div class="line"><span class="comment">// Classes: PascalCase</span></div>
<div class="line"><span class="keyword">class </span>MessageProcessor {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="comment">// Methods: snake_case</span></div>
<div class="line">    <span class="keywordtype">void</span> process_message(<span class="keyword">const</span> Message&amp; msg);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Member variables: snake_case with underscore suffix</span></div>
<div class="line">    <span class="keywordtype">size_t</span> message_count_;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Constants: UPPER_SNAKE_CASE</span></div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">size_t</span> MAX_BUFFER_SIZE = 1024;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Functions: snake_case</span></div>
<div class="line"><span class="keywordtype">void</span> send_notification(<span class="keyword">const</span> std::string&amp; message);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Namespaces: lowercase</span></div>
<div class="line"><span class="keyword">namespace </span>messaging {</div>
<div class="line"><span class="keyword">namespace </span>core {</div>
<div class="line">    <span class="comment">// ...</span></div>
<div class="line">}</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Enums: PascalCase for type, UPPER_SNAKE_CASE for values</span></div>
<div class="line"><span class="keyword">enum class</span> MessageType {</div>
<div class="line">    DATA_UPDATE,</div>
<div class="line">    HEARTBEAT,</div>
<div class="line">    ERROR_REPORT</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Templates: PascalCase for type parameters</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> MessageHandler&gt;</div>
<div class="line"><span class="keyword">class </span>Router {</div>
<div class="line">    <span class="comment">// ...</span></div>
<div class="line">};</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md868"></a>
File Organization</h3>
<div class="fragment"><div class="line"><span class="comment">// header_file.h</span></div>
<div class="line"><span class="preprocessor">#pragma once</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// System includes</span></div>
<div class="line"><span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Third-party includes</span></div>
<div class="line"><span class="preprocessor">#include &lt;boost/asio.hpp&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Project includes</span></div>
<div class="line"><span class="preprocessor">#include &quot;messaging/core/types.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span>messaging {</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Forward declarations</span></div>
<div class="line"><span class="keyword">class </span>MessageBus;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Type aliases</span></div>
<div class="line"><span class="keyword">using </span>MessagePtr = std::shared_ptr&lt;Message&gt;;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Constants</span></div>
<div class="line"><span class="keyword">constexpr</span> <span class="keywordtype">size_t</span> DEFAULT_QUEUE_SIZE = 1000;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Class definition</span></div>
<div class="line"><span class="keyword">class </span>MessageProcessor {</div>
<div class="line">    <span class="comment">// Public interface first</span></div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    MessageProcessor();</div>
<div class="line">    ~MessageProcessor();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> process(<span class="keyword">const</span> Message&amp; msg);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Private implementation</span></div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    <span class="keyword">struct </span>Impl;</div>
<div class="line">    std::unique_ptr&lt;Impl&gt; impl_;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">} <span class="comment">// namespace messaging</span></div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md869"></a>
Best Practices</h3>
<ol type="1">
<li><b>RAII (Resource Acquisition Is Initialization)</b> <div class="fragment"><div class="line"><span class="keyword">class </span>FileHandler {</div>
<div class="line">    std::unique_ptr&lt;std::FILE, <span class="keyword">decltype</span>(&amp;std::fclose)&gt; file_;</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    FileHandler(<span class="keyword">const</span> std::string&amp; path)</div>
<div class="line">        : file_(std::fopen(path.c_str(), <span class="stringliteral">&quot;r&quot;</span>), &amp;std::fclose) {</div>
<div class="line">        <span class="keywordflow">if</span> (!file_) {</div>
<div class="line">            <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Failed to open file&quot;</span>);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">// Automatic cleanup on destruction</span></div>
<div class="line">};</div>
</div><!-- fragment --></li>
<li><b>Move Semantics</b> <div class="fragment"><div class="line"><span class="keyword">class </span>LargeData {</div>
<div class="line">    std::vector&lt;uint8_t&gt; data_;</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="comment">// Move constructor</span></div>
<div class="line">    LargeData(LargeData&amp;&amp; other) noexcept</div>
<div class="line">        : data_(std::move(other.data_)) {}</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Move assignment</span></div>
<div class="line">    LargeData&amp; operator=(LargeData&amp;&amp; other) <span class="keyword">noexcept</span> {</div>
<div class="line">        <span class="keywordflow">if</span> (<span class="keyword">this</span> != &amp;other) {</div>
<div class="line">            data_ = std::move(other.data_);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line">    }</div>
<div class="line">};</div>
</div><!-- fragment --></li>
<li><b>Const Correctness</b> <div class="fragment"><div class="line"><span class="keyword">class </span>Container {</div>
<div class="line">    std::vector&lt;int&gt; data_;</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="comment">// Const methods don&#39;t modify state</span></div>
<div class="line">    <span class="keywordtype">size_t</span> size()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> data_.size(); }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Const and non-const overloads</span></div>
<div class="line">    <span class="keywordtype">int</span>&amp; operator[](<span class="keywordtype">size_t</span> idx) { <span class="keywordflow">return</span> data_[idx]; }</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; operator[](<span class="keywordtype">size_t</span> idx)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> data_[idx]; }</div>
<div class="line">};</div>
</div><!-- fragment --></li>
<li><b>Smart Pointers</b> <div class="fragment"><div class="line"><span class="comment">// Use unique_ptr for single ownership</span></div>
<div class="line">std::unique_ptr&lt;Connection&gt; create_connection();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Use shared_ptr for shared ownership</span></div>
<div class="line"><span class="keyword">class </span>Session : <span class="keyword">public</span> std::enable_shared_from_this&lt;Session&gt; {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keywordtype">void</span> start() {</div>
<div class="line">        <span class="keyword">auto</span> self = shared_from_this();</div>
<div class="line">        async_read([self](<span class="keyword">auto</span> ec, <span class="keyword">auto</span> bytes) {</div>
<div class="line">            <span class="comment">// Session kept alive during async operation</span></div>
<div class="line">        });</div>
<div class="line">    }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Use weak_ptr to break cycles</span></div>
<div class="line"><span class="keyword">class </span>Node {</div>
<div class="line">    std::shared_ptr&lt;Node&gt; child_;</div>
<div class="line">    std::weak_ptr&lt;Node&gt; parent_;  <span class="comment">// Breaks circular reference</span></div>
<div class="line">};</div>
</div><!-- fragment --></li>
<li><b>Error Handling</b> <div class="fragment"><div class="line"><span class="comment">// Use exceptions for exceptional conditions</span></div>
<div class="line"><span class="keywordtype">void</span> critical_operation() {</div>
<div class="line">    <span class="keywordflow">if</span> (!precondition_met()) {</div>
<div class="line">        <span class="keywordflow">throw</span> std::logic_error(<span class="stringliteral">&quot;Precondition failed&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Use optional for values that might not exist</span></div>
<div class="line">std::optional&lt;Config&gt; load_config(<span class="keyword">const</span> std::string&amp; path) {</div>
<div class="line">    <span class="keywordflow">if</span> (!file_exists(path)) {</div>
<div class="line">        <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> Config::from_file(path);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Use expected/result for operations that can fail</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><span class="keyword">using </span>Result = std::expected&lt;T, std::error_code&gt;;</div>
<div class="line"> </div>
<div class="line">Result&lt;Data&gt; parse_data(<span class="keyword">const</span> std::string&amp; input) {</div>
<div class="line">    <span class="keywordflow">if</span> (input.empty()) {</div>
<div class="line">        <span class="keywordflow">return</span> std::unexpected(ErrorCode::InvalidInput);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> Data{input};</div>
<div class="line">}</div>
</div><!-- fragment --></li>
</ol>
<h2><a class="anchor" id="autotoc_md870"></a>
Documentation Standards</h2>
<h3><a class="anchor" id="autotoc_md871"></a>
Code Documentation</h3>
<div class="fragment"><div class="line"> </div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> Handler&gt;</div>
<div class="line"><span class="keyword">class </span>MessageProcessor {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keywordtype">bool</span> register_handler(<span class="keyword">const</span> std::string&amp; topic, Handler handler);</div>
<div class="line">};</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md872"></a>
Comment Guidelines</h3>
<div class="fragment"><div class="line"><span class="comment">// Good: Explains WHY</span></div>
<div class="line"><span class="comment">// Use lock-free queue to avoid contention in high-throughput scenarios</span></div>
<div class="line">queue_.push_lock_free(item);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Bad: Explains WHAT (obvious from code)</span></div>
<div class="line"><span class="comment">// Push item to queue</span></div>
<div class="line">queue_.push(item);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Good: Complex algorithm explanation</span></div>
<div class="line"><span class="comment">// Binary search with interpolation for better cache locality.</span></div>
<div class="line"><span class="comment">// We estimate the position based on value distribution, reducing</span></div>
<div class="line"><span class="comment">// comparisons from O(log n) to O(log log n) in the average case.</span></div>
<div class="line"><span class="keywordtype">size_t</span> pos = interpolation_search(data, target);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Good: TODO with context</span></div>
<div class="line"><span class="comment">// TODO(john): Optimize for small arrays (&lt;100 elements) using linear search</span></div>
<div class="line"><span class="comment">// Benchmarks show 20% improvement for small datasets</span></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md873"></a>
Testing Guidelines</h1>
<h2><a class="anchor" id="autotoc_md874"></a>
Unit Testing</h2>
<h3><a class="anchor" id="autotoc_md875"></a>
Test Structure</h3>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;gtest/gtest.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;messaging/core/message.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Test fixture for shared setup</span></div>
<div class="line"><span class="keyword">class </span>MessageTest : <span class="keyword">public</span> ::testing::Test {</div>
<div class="line"><span class="keyword">protected</span>:</div>
<div class="line">    <span class="keywordtype">void</span> SetUp()<span class="keyword"> override </span>{</div>
<div class="line">        <span class="comment">// Common initialization</span></div>
<div class="line">        message_ = std::make_unique&lt;Message&gt;();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> TearDown()<span class="keyword"> override </span>{</div>
<div class="line">        <span class="comment">// Cleanup if needed</span></div>
<div class="line">        message_.reset();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    std::unique_ptr&lt;Message&gt; message_;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Basic test</span></div>
<div class="line">TEST_F(MessageTest, ConstructorInitializesCorrectly) {</div>
<div class="line">    EXPECT_EQ(message_-&gt;type(), MessageType::UNDEFINED);</div>
<div class="line">    EXPECT_TRUE(message_-&gt;payload().empty());</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Parameterized test</span></div>
<div class="line"><span class="keyword">class </span>MessageSerializationTest</div>
<div class="line">    : <span class="keyword">public</span> MessageTest,</div>
<div class="line">      <span class="keyword">public</span> ::testing::WithParamInterface&lt;SerializationFormat&gt; {};</div>
<div class="line"> </div>
<div class="line">TEST_P(MessageSerializationTest, SerializeDeserializeRoundTrip) {</div>
<div class="line">    <span class="keyword">auto</span> format = GetParam();</div>
<div class="line">    message_-&gt;set_content(<span class="stringliteral">&quot;test data&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> serialized = message_-&gt;serialize(format);</div>
<div class="line">    <span class="keyword">auto</span> deserialized = Message::deserialize(serialized, format);</div>
<div class="line"> </div>
<div class="line">    ASSERT_TRUE(deserialized.has_value());</div>
<div class="line">    EXPECT_EQ(deserialized-&gt;content(), <span class="stringliteral">&quot;test data&quot;</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">INSTANTIATE_TEST_SUITE_P(</div>
<div class="line">    Formats,</div>
<div class="line">    MessageSerializationTest,</div>
<div class="line">    ::testing::Values(</div>
<div class="line">        SerializationFormat::BINARY,</div>
<div class="line">        SerializationFormat::JSON,</div>
<div class="line">        SerializationFormat::PROTOBUF</div>
<div class="line">    )</div>
<div class="line">);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Death test for assertions</span></div>
<div class="line">TEST_F(MessageTest, NullPayloadCausesDeath) {</div>
<div class="line">    ASSERT_DEATH(message_-&gt;set_payload(<span class="keyword">nullptr</span>), <span class="stringliteral">&quot;Assertion.*null&quot;</span>);</div>
<div class="line">}</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md876"></a>
Test Coverage</h3>
<p>Aim for minimum 80% code coverage:</p>
<div class="fragment"><div class="line"># Build with coverage</div>
<div class="line">cmake .. -DCMAKE_BUILD_TYPE=Debug -DENABLE_COVERAGE=ON</div>
<div class="line">make</div>
<div class="line"> </div>
<div class="line"># Run tests</div>
<div class="line">ctest</div>
<div class="line"> </div>
<div class="line"># Generate coverage report</div>
<div class="line">lcov --capture --directory . --output-file coverage.info</div>
<div class="line">lcov --remove coverage.info &#39;/usr/*&#39; --output-file coverage.info</div>
<div class="line">lcov --list coverage.info</div>
<div class="line"> </div>
<div class="line"># HTML report</div>
<div class="line">genhtml coverage.info --output-directory coverage_report</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md877"></a>
Integration Testing</h2>
<div class="fragment"><div class="line"><span class="keyword">class </span>IntegrationTest : <span class="keyword">public</span> ::testing::Test {</div>
<div class="line"><span class="keyword">protected</span>:</div>
<div class="line">    <span class="keywordtype">void</span> SetUp()<span class="keyword"> override </span>{</div>
<div class="line">        <span class="comment">// Start services</span></div>
<div class="line">        server_ = std::make_unique&lt;Server&gt;(8080);</div>
<div class="line">        server_-&gt;start();</div>
<div class="line"> </div>
<div class="line">        client_ = std::make_unique&lt;Client&gt;();</div>
<div class="line">        client_-&gt;connect(<span class="stringliteral">&quot;localhost&quot;</span>, 8080);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> TearDown()<span class="keyword"> override </span>{</div>
<div class="line">        client_-&gt;disconnect();</div>
<div class="line">        server_-&gt;stop();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    std::unique_ptr&lt;Server&gt; server_;</div>
<div class="line">    std::unique_ptr&lt;Client&gt; client_;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">TEST_F(IntegrationTest, ClientServerCommunication) {</div>
<div class="line">    <span class="comment">// Send request</span></div>
<div class="line">    <span class="keyword">auto</span> request = create_test_request();</div>
<div class="line">    <span class="keyword">auto</span> future = client_-&gt;send_async(request);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Wait for response</span></div>
<div class="line">    <span class="keyword">auto</span> response = future.get();</div>
<div class="line">    ASSERT_TRUE(response.has_value());</div>
<div class="line">    EXPECT_EQ(response-&gt;status(), Status::SUCCESS);</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md878"></a>
Performance Testing</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;benchmark/benchmark.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> BM_MessageSerialization(benchmark::State&amp; state) {</div>
<div class="line">    Message msg;</div>
<div class="line">    msg.set_content(std::string(state.range(0), <span class="charliteral">&#39;x&#39;</span>));</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> _ : state) {</div>
<div class="line">        <span class="keyword">auto</span> serialized = msg.serialize();</div>
<div class="line">        benchmark::DoNotOptimize(serialized);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    state.SetBytesProcessed(state.iterations() * state.range(0));</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">BENCHMARK(BM_MessageSerialization)-&gt;Range(8, 8&lt;&lt;10);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> BM_LockFreeQueue(benchmark::State&amp; state) {</div>
<div class="line">    LockFreeQueue&lt;int&gt; queue(10000);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> _ : state) {</div>
<div class="line">        queue.push(42);</div>
<div class="line">        <span class="keywordtype">int</span> value;</div>
<div class="line">        queue.pop(value);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    state.SetItemsProcessed(state.iterations());</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">BENCHMARK(BM_LockFreeQueue)-&gt;Threads(1)-&gt;Threads(2)-&gt;Threads(4)-&gt;Threads(8);</div>
</div><!-- fragment --><p>Run benchmarks: </p><div class="fragment"><div class="line">./build/benchmarks/message_benchmark --benchmark_format=json &gt; results.json</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md879"></a>
Debugging</h1>
<h2><a class="anchor" id="autotoc_md880"></a>
Using GDB</h2>
<div class="fragment"><div class="line"># Build with debug symbols</div>
<div class="line">cmake .. -DCMAKE_BUILD_TYPE=Debug</div>
<div class="line">make</div>
<div class="line"> </div>
<div class="line"># Run with GDB</div>
<div class="line">gdb ./build/bin/my_application</div>
<div class="line"> </div>
<div class="line"># Common GDB commands</div>
<div class="line">(gdb) break MessageProcessor::process  # Set breakpoint</div>
<div class="line">(gdb) run                              # Start program</div>
<div class="line">(gdb) backtrace                        # Show call stack</div>
<div class="line">(gdb) print message_                   # Inspect variable</div>
<div class="line">(gdb) watch message_count_             # Watch variable changes</div>
<div class="line">(gdb) thread apply all backtrace       # All threads&#39; stacks</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md881"></a>
Using Valgrind</h2>
<p>Memory leak detection: </p><div class="fragment"><div class="line">valgrind --leak-check=full \</div>
<div class="line">         --show-leak-kinds=all \</div>
<div class="line">         --track-origins=yes \</div>
<div class="line">         --verbose \</div>
<div class="line">         --log-file=valgrind-out.txt \</div>
<div class="line">         ./build/bin/my_application</div>
</div><!-- fragment --><p>Race condition detection: </p><div class="fragment"><div class="line">valgrind --tool=helgrind ./build/bin/my_application</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md882"></a>
Using AddressSanitizer</h2>
<div class="fragment"><div class="line"># Build with AddressSanitizer</div>
<div class="line">cmake .. -DCMAKE_BUILD_TYPE=Debug \</div>
<div class="line">         -DCMAKE_CXX_FLAGS=&quot;-fsanitize=address -fno-omit-frame-pointer&quot;</div>
<div class="line">make</div>
<div class="line"> </div>
<div class="line"># Run with ASAN options</div>
<div class="line">ASAN_OPTIONS=detect_leaks=1:halt_on_error=0 ./build/bin/my_application</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md883"></a>
Using ThreadSanitizer</h2>
<div class="fragment"><div class="line"># Build with ThreadSanitizer</div>
<div class="line">cmake .. -DCMAKE_BUILD_TYPE=Debug \</div>
<div class="line">         -DCMAKE_CXX_FLAGS=&quot;-fsanitize=thread&quot;</div>
<div class="line">make</div>
<div class="line"> </div>
<div class="line"># Run with TSAN options</div>
<div class="line">TSAN_OPTIONS=halt_on_error=0:history_size=7 ./build/bin/my_application</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md884"></a>
Performance Profiling</h1>
<h2><a class="anchor" id="autotoc_md885"></a>
Using perf</h2>
<div class="fragment"><div class="line"># Record performance data</div>
<div class="line">perf record -g ./build/bin/my_application</div>
<div class="line"> </div>
<div class="line"># Generate report</div>
<div class="line">perf report</div>
<div class="line"> </div>
<div class="line"># Generate flame graph</div>
<div class="line">perf script | ./FlameGraph/stackcollapse-perf.pl | ./FlameGraph/flamegraph.pl &gt; flame.svg</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md886"></a>
Using Instruments (macOS)</h2>
<div class="fragment"><div class="line"># Time Profiler</div>
<div class="line">instruments -t &quot;Time Profiler&quot; -D trace.trace ./build/bin/my_application</div>
<div class="line"> </div>
<div class="line"># Allocations</div>
<div class="line">instruments -t &quot;Allocations&quot; -D alloc.trace ./build/bin/my_application</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md887"></a>
Using Intel VTune</h2>
<div class="fragment"><div class="line"># Hotspot analysis</div>
<div class="line">vtune -collect hotspots -result-dir vtune_results ./build/bin/my_application</div>
<div class="line"> </div>
<div class="line"># Threading analysis</div>
<div class="line">vtune -collect threading -result-dir vtune_threading ./build/bin/my_application</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md888"></a>
Contributing Guidelines</h1>
<h2><a class="anchor" id="autotoc_md889"></a>
Workflow</h2>
<ol type="1">
<li><b>Fork</b> the repository</li>
<li><b>Create</b> a feature branch <div class="fragment"><div class="line">git checkout -b feature/amazing-feature</div>
</div><!-- fragment --></li>
<li><b>Make</b> changes following coding standards</li>
<li><b>Test</b> your changes <div class="fragment"><div class="line">./scripts/build.sh --tests</div>
<div class="line">ctest --output-on-failure</div>
</div><!-- fragment --></li>
<li><b>Format</b> code <div class="fragment"><div class="line">find . -name &quot;*.cpp&quot; -o -name &quot;*.h&quot; | xargs clang-format -i</div>
</div><!-- fragment --></li>
<li><b>Commit</b> with descriptive message <div class="fragment"><div class="line">git commit -m &quot;feat(network): add WebSocket support</div>
<div class="line"> </div>
<div class="line">- Implement WebSocket protocol handler</div>
<div class="line">- Add connection upgrade mechanism</div>
<div class="line">- Include unit tests and documentation&quot;</div>
</div><!-- fragment --></li>
<li><b>Push</b> to your fork <div class="fragment"><div class="line">git push origin feature/amazing-feature</div>
</div><!-- fragment --></li>
<li><b>Create</b> Pull Request with:<ul>
<li>Clear description of changes</li>
<li>Link to related issues</li>
<li>Test results</li>
<li>Performance impact (if applicable)</li>
</ul>
</li>
</ol>
<h2><a class="anchor" id="autotoc_md890"></a>
Commit Message Format</h2>
<p>Follow Conventional Commits specification:</p>
<div class="fragment"><div class="line">&lt;type&gt;(&lt;scope&gt;): &lt;subject&gt;</div>
<div class="line"> </div>
<div class="line">&lt;body&gt;</div>
<div class="line"> </div>
<div class="line">&lt;footer&gt;</div>
</div><!-- fragment --><p>Types:</p><ul>
<li><code>feat</code>: New feature</li>
<li><code>fix</code>: Bug fix</li>
<li><code>docs</code>: Documentation changes</li>
<li><code>style</code>: Code style changes (formatting, etc.)</li>
<li><code>refactor</code>: Code refactoring</li>
<li><code>perf</code>: Performance improvements</li>
<li><code>test</code>: Test additions or fixes</li>
<li><code>build</code>: Build system changes</li>
<li><code>ci</code>: CI/CD changes</li>
<li><code>chore</code>: Other changes</li>
</ul>
<p>Example: </p><div class="fragment"><div class="line">feat(container): add SIMD optimization for numeric operations</div>
<div class="line"> </div>
<div class="line">Implement ARM NEON and x86 AVX vectorization for bulk numeric</div>
<div class="line">operations in containers. This provides ~3x speedup for large</div>
<div class="line">arrays.</div>
<div class="line"> </div>
<div class="line">Closes #123</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md891"></a>
Code Review Checklist</h2>
<p>Before submitting PR, ensure:</p>
<ul>
<li>[ ] Code follows project style guide</li>
<li>[ ] All tests pass</li>
<li>[ ] New tests added for new features</li>
<li>[ ] Documentation updated</li>
<li>[ ] No compiler warnings</li>
<li>[ ] No memory leaks (checked with Valgrind/ASAN)</li>
<li>[ ] Performance impact assessed</li>
<li>[ ] Security implications considered</li>
<li>[ ] Breaking changes documented</li>
<li>[ ] Changelog updated</li>
</ul>
<h1><a class="anchor" id="autotoc_md892"></a>
Build System</h1>
<h2><a class="anchor" id="autotoc_md893"></a>
CMake Configuration</h2>
<p>Basic configuration options:</p>
<div class="fragment"><div class="line"># Build type</div>
<div class="line">-DCMAKE_BUILD_TYPE=Debug|Release|RelWithDebInfo|MinSizeRel</div>
<div class="line"> </div>
<div class="line"># Feature flags</div>
<div class="line">-DUSE_UNIT_TEST=ON|OFF</div>
<div class="line">-DUSE_BENCHMARK=ON|OFF</div>
<div class="line">-DUSE_DATABASE=ON|OFF</div>
<div class="line">-DUSE_PYTHON_BINDING=ON|OFF</div>
<div class="line"> </div>
<div class="line"># Optimization flags</div>
<div class="line">-DENABLE_LTO=ON|OFF           # Link-time optimization</div>
<div class="line">-DENABLE_SIMD=ON|OFF          # SIMD optimizations</div>
<div class="line">-DENABLE_SANITIZERS=ON|OFF    # AddressSanitizer/ThreadSanitizer</div>
<div class="line"> </div>
<div class="line"># Custom paths</div>
<div class="line">-DCMAKE_INSTALL_PREFIX=/custom/path</div>
<div class="line">-DVCPKG_ROOT=/path/to/vcpkg</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md894"></a>
Creating New Modules</h2>
<ol type="1">
<li>Create module structure: <div class="fragment"><div class="line">mkdir -p libraries/my_module/{include/my_module,src,tests}</div>
</div><!-- fragment --></li>
<li>Create CMakeLists.txt: <div class="fragment"><div class="line"># libraries/my_module/CMakeLists.txt</div>
<div class="line">cmake_minimum_required(VERSION 3.16)</div>
<div class="line">project(my_module)</div>
<div class="line"> </div>
<div class="line"># Define library</div>
<div class="line">add_library(my_module</div>
<div class="line">    src/implementation.cpp</div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line"># Include directories</div>
<div class="line">target_include_directories(my_module</div>
<div class="line">    PUBLIC</div>
<div class="line">        $&lt;BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}/include&gt;</div>
<div class="line">        $&lt;INSTALL_INTERFACE:include&gt;</div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line"># Link dependencies</div>
<div class="line">target_link_libraries(my_module</div>
<div class="line">    PUBLIC</div>
<div class="line">        container_system</div>
<div class="line">        thread_system</div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line"># Set properties</div>
<div class="line">set_target_properties(my_module PROPERTIES</div>
<div class="line">    CXX_STANDARD 20</div>
<div class="line">    CXX_STANDARD_REQUIRED ON</div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line"># Tests</div>
<div class="line">if(USE_UNIT_TEST)</div>
<div class="line">    add_subdirectory(tests)</div>
<div class="line">endif()</div>
</div><!-- fragment --></li>
<li>Add to main CMakeLists.txt: <div class="fragment"><div class="line">add_subdirectory(libraries/my_module)</div>
</div><!-- fragment --></li>
</ol>
<h1><a class="anchor" id="autotoc_md895"></a>
Deployment</h1>
<h2><a class="anchor" id="autotoc_md896"></a>
Docker Deployment</h2>
<div class="fragment"><div class="line"><span class="preprocessor"># Dockerfile</span></div>
<div class="line">FROM ubuntu:22.04 AS builder</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor"># Install dependencies</span></div>
<div class="line">RUN apt-get update &amp;&amp; apt-get install -y \</div>
<div class="line">    build-essential \</div>
<div class="line">    cmake \</div>
<div class="line">    git \</div>
<div class="line">    postgresql-client</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor"># Build application</span></div>
<div class="line">WORKDIR /app</div>
<div class="line">COPY . .</div>
<div class="line">RUN mkdir build &amp;&amp; cd build &amp;&amp; \</div>
<div class="line">    cmake .. -DCMAKE_BUILD_TYPE=Release &amp;&amp; \</div>
<div class="line">    cmake --build . --parallel</div>
<div class="line"> </div>
<div class="line">FROM ubuntu:22.04</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor"># Install runtime dependencies</span></div>
<div class="line">RUN apt-get update &amp;&amp; apt-get install -y \</div>
<div class="line">    libpq5 \</div>
<div class="line">    &amp;&amp; rm -rf /var/lib/apt/lists<span class="comment">/*</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"># Copy application</span></div>
<div class="line"><span class="comment">COPY --from=builder /app/build/bin/* /usr/local/bin/</span></div>
<div class="line"><span class="comment">COPY --from=builder /app/build/lib/* /usr/local/lib/</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"># Configuration</span></div>
<div class="line"><span class="comment">ENV LD_LIBRARY_PATH=/usr/local/lib</span></div>
<div class="line"><span class="comment">EXPOSE 8080</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">CMD [&quot;/usr/local/bin/messaging_server&quot;]</span></div>
</div><!-- fragment --><p>Build and run: </p><div class="fragment"><div class="line">docker build -t messaging-system .</div>
<div class="line">docker run -p 8080:8080 messaging-system</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md897"></a>
Kubernetes Deployment</h2>
<div class="fragment"><div class="line"># deployment.yaml</div>
<div class="line">apiVersion: apps/v1</div>
<div class="line">kind: Deployment</div>
<div class="line">metadata:</div>
<div class="line">  name: messaging-system</div>
<div class="line">spec:</div>
<div class="line">  replicas: 3</div>
<div class="line">  selector:</div>
<div class="line">    matchLabels:</div>
<div class="line">      app: messaging-system</div>
<div class="line">  template:</div>
<div class="line">    metadata:</div>
<div class="line">      labels:</div>
<div class="line">        app: messaging-system</div>
<div class="line">    spec:</div>
<div class="line">      containers:</div>
<div class="line">      - name: messaging</div>
<div class="line">        image: messaging-system:latest</div>
<div class="line">        ports:</div>
<div class="line">        - containerPort: 8080</div>
<div class="line">        env:</div>
<div class="line">        - name: WORKER_THREADS</div>
<div class="line">          value: &quot;8&quot;</div>
<div class="line">        - name: DB_HOST</div>
<div class="line">          valueFrom:</div>
<div class="line">            secretKeyRef:</div>
<div class="line">              name: db-secret</div>
<div class="line">              key: host</div>
<div class="line">        resources:</div>
<div class="line">          requests:</div>
<div class="line">            memory: &quot;1Gi&quot;</div>
<div class="line">            cpu: &quot;500m&quot;</div>
<div class="line">          limits:</div>
<div class="line">            memory: &quot;2Gi&quot;</div>
<div class="line">            cpu: &quot;1000m&quot;</div>
<div class="line">        livenessProbe:</div>
<div class="line">          httpGet:</div>
<div class="line">            path: /health</div>
<div class="line">            port: 8080</div>
<div class="line">          initialDelaySeconds: 30</div>
<div class="line">          periodSeconds: 10</div>
<div class="line">        readinessProbe:</div>
<div class="line">          httpGet:</div>
<div class="line">            path: /ready</div>
<div class="line">            port: 8080</div>
<div class="line">          initialDelaySeconds: 5</div>
<div class="line">          periodSeconds: 5</div>
<div class="line">---</div>
<div class="line">apiVersion: v1</div>
<div class="line">kind: Service</div>
<div class="line">metadata:</div>
<div class="line">  name: messaging-service</div>
<div class="line">spec:</div>
<div class="line">  selector:</div>
<div class="line">    app: messaging-system</div>
<div class="line">  ports:</div>
<div class="line">  - port: 8080</div>
<div class="line">    targetPort: 8080</div>
<div class="line">  type: LoadBalancer</div>
</div><!-- fragment --><p>Deploy: </p><div class="fragment"><div class="line">kubectl apply -f deployment.yaml</div>
<div class="line">kubectl get pods -l app=messaging-system</div>
<div class="line">kubectl logs -f deployment/messaging-system</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md898"></a>
Security Best Practices</h1>
<h2><a class="anchor" id="autotoc_md899"></a>
Input Validation</h2>
<div class="fragment"><div class="line"><span class="keyword">class </span>InputValidator {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">static</span> <span class="keywordtype">bool</span> validate_message(<span class="keyword">const</span> Message&amp; msg) {</div>
<div class="line">        <span class="comment">// Check size limits</span></div>
<div class="line">        <span class="keywordflow">if</span> (msg.size() &gt; MAX_MESSAGE_SIZE) {</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Validate UTF-8 encoding</span></div>
<div class="line">        <span class="keywordflow">if</span> (!is_valid_utf8(msg.content())) {</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Check for injection attacks</span></div>
<div class="line">        <span class="keywordflow">if</span> (contains_sql_injection(msg.content())) {</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">size_t</span> MAX_MESSAGE_SIZE = 1024 * 1024;  <span class="comment">// 1MB</span></div>
<div class="line">};</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md900"></a>
Secure Communication</h2>
<div class="fragment"><div class="line"><span class="keyword">class </span>SecureChannel {</div>
<div class="line">    SSL_CTX* ctx_;</div>
<div class="line">    SSL* ssl_;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    SecureChannel() {</div>
<div class="line">        <span class="comment">// Initialize OpenSSL</span></div>
<div class="line">        SSL_library_init();</div>
<div class="line">        SSL_load_error_strings();</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Create context with TLS 1.3</span></div>
<div class="line">        ctx_ = SSL_CTX_new(TLS_method());</div>
<div class="line">        SSL_CTX_set_min_proto_version(ctx_, TLS1_3_VERSION);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Load certificates</span></div>
<div class="line">        SSL_CTX_use_certificate_file(ctx_, <span class="stringliteral">&quot;cert.pem&quot;</span>, SSL_FILETYPE_PEM);</div>
<div class="line">        SSL_CTX_use_PrivateKey_file(ctx_, <span class="stringliteral">&quot;key.pem&quot;</span>, SSL_FILETYPE_PEM);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Verify peer certificate</span></div>
<div class="line">        SSL_CTX_set_verify(ctx_, SSL_VERIFY_PEER, <span class="keyword">nullptr</span>);</div>
<div class="line">    }</div>
<div class="line">};</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md901"></a>
Rate Limiting</h2>
<div class="fragment"><div class="line"><span class="keyword">class </span>RateLimiter {</div>
<div class="line">    <span class="keyword">struct </span>ClientInfo {</div>
<div class="line">        std::atomic&lt;size_t&gt; request_count{0};</div>
<div class="line">        std::chrono::steady_clock::time_point window_start;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    std::unordered_map&lt;std::string, ClientInfo&gt; clients_;</div>
<div class="line">    std::mutex mutex_;</div>
<div class="line">    <span class="keywordtype">size_t</span> max_requests_per_window_ = 100;</div>
<div class="line">    std::chrono::seconds window_duration_{60};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keywordtype">bool</span> allow_request(<span class="keyword">const</span> std::string&amp; client_id) {</div>
<div class="line">        std::lock_guard&lt;std::mutex&gt; lock(mutex_);</div>
<div class="line">        <span class="keyword">auto</span> now = std::chrono::steady_clock::now();</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">auto</span>&amp; info = clients_[client_id];</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Reset window if expired</span></div>
<div class="line">        <span class="keywordflow">if</span> (now - info.window_start &gt; window_duration_) {</div>
<div class="line">            info.request_count = 0;</div>
<div class="line">            info.window_start = now;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Check rate limit</span></div>
<div class="line">        <span class="keywordflow">if</span> (info.request_count &gt;= max_requests_per_window_) {</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        info.request_count++;</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line">};</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md902"></a>
Troubleshooting Common Issues</h1>
<h2><a class="anchor" id="autotoc_md903"></a>
Build Issues</h2>
<p><b>Problem</b>: CMake cannot find dependencies </p><div class="fragment"><div class="line">CMake Error: Could not find PostgreSQL</div>
</div><!-- fragment --><p><b>Solution</b>: </p><div class="fragment"><div class="line"># Install PostgreSQL development files</div>
<div class="line">sudo apt-get install libpq-dev  # Ubuntu/Debian</div>
<div class="line">brew install postgresql         # macOS</div>
<div class="line"> </div>
<div class="line"># Or disable PostgreSQL support</div>
<div class="line">cmake .. -DUSE_DATABASE=OFF</div>
</div><!-- fragment --><p><b>Problem</b>: Compilation errors with C++20 features </p><div class="fragment"><div class="line">error: &#39;concepts&#39; is not a namespace-name</div>
</div><!-- fragment --><p><b>Solution</b>: </p><div class="fragment"><div class="line"># Update compiler</div>
<div class="line">sudo apt-get install gcc-11 g++-11</div>
<div class="line">export CXX=g++-11</div>
<div class="line"> </div>
<div class="line"># Or use Clang</div>
<div class="line">export CXX=clang++-12</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md904"></a>
Runtime Issues</h2>
<p><b>Problem</b>: Segmentation fault on startup </p><div class="fragment"><div class="line">Segmentation fault (core dumped)</div>
</div><!-- fragment --><p><b>Debugging steps</b>: </p><div class="fragment"><div class="line"># Generate core dump</div>
<div class="line">ulimit -c unlimited</div>
<div class="line">./my_application</div>
<div class="line"> </div>
<div class="line"># Analyze core dump</div>
<div class="line">gdb ./my_application core</div>
<div class="line">(gdb) bt</div>
<div class="line">(gdb) frame 0</div>
<div class="line">(gdb) print &lt;variable&gt;</div>
</div><!-- fragment --><p><b>Problem</b>: High memory usage </p><div class="fragment"><div class="line"># Monitor memory usage</div>
<div class="line">valgrind --tool=massif ./my_application</div>
<div class="line">ms_print massif.out.&lt;pid&gt;</div>
<div class="line"> </div>
<div class="line"># Or use built-in monitoring</div>
<div class="line">MESSAGING_ENABLE_MEMORY_TRACKING=1 ./my_application</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md905"></a>
Performance Issues</h2>
<p><b>Problem</b>: Poor throughput </p><div class="fragment"><div class="line"># Profile CPU usage</div>
<div class="line">perf top -p &lt;pid&gt;</div>
<div class="line"> </div>
<div class="line"># Check thread contention</div>
<div class="line">perf record -e sched:sched_switch -p &lt;pid&gt;</div>
<div class="line">perf report</div>
<div class="line"> </div>
<div class="line"># Monitor lock contention</div>
<div class="line">MESSAGING_ENABLE_LOCK_PROFILING=1 ./my_application</div>
</div><!-- fragment --><p><b>Solution</b>: Tune configuration </p><div class="fragment"><div class="line">[performance]</div>
<div class="line">worker_threads = 16          # Increase threads</div>
<div class="line">queue_size = 100000          # Larger queues</div>
<div class="line">batch_size = 100            # Process in batches</div>
<div class="line">enable_cpu_affinity = true  # Pin threads to CPUs</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
