<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Messaging System: Technical Implementation Details</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Messaging System<span id="projectnumber">&#160;1.0.0</span>
   </div>
   <div id="projectbrief">High-Performance Cross-Platform Messaging Framework</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d2/dac/md_libraries_2network__system_2docs_2TECHNICAL__IMPLEMENTATION__DETAILS.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Technical Implementation Details</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md2432"></a></p>
<h1><a class="anchor" id="autotoc_md2433"></a>
Network System Separation Technical Implementation Guide</h1>
<p><b>Date</b>: 2025-09-19 <b>Version</b>: 1.0.0 <b>Owner</b>: kcenon</p>
<hr  />
<h2><a class="anchor" id="autotoc_md2435"></a>
🏗️ Architecture Design</h2>
<h3><a class="anchor" id="autotoc_md2436"></a>
1. Module Layer Structure</h3>
<div class="fragment"><div class="line">┌─────────────────────────────────────┐</div>
<div class="line">│        Application Layer           │</div>
<div class="line">│   (messaging_system, other apps)   │</div>
<div class="line">└─────────────────┬───────────────────┘</div>
<div class="line">                  │</div>
<div class="line">┌─────────────────▼───────────────────┐</div>
<div class="line">│     Integration Layer               │</div>
<div class="line">│  ┌─────────────┬─────────────────┐  │</div>
<div class="line">│  │ messaging   │ container       │  │</div>
<div class="line">│  │ _bridge     │ _integration    │  │</div>
<div class="line">│  └─────────────┴─────────────────┘  │</div>
<div class="line">└─────────────────┬───────────────────┘</div>
<div class="line">                  │</div>
<div class="line">┌─────────────────▼───────────────────┐</div>
<div class="line">│     Network System Core             │</div>
<div class="line">│  ┌───────┬─────────┬─────────────┐  │</div>
<div class="line">│  │ Core  │ Session │ Internal    │  │</div>
<div class="line">│  │ API   │ Mgmt    │ Impl        │  │</div>
<div class="line">│  └───────┴─────────┴─────────────┘  │</div>
<div class="line">└─────────────────┬───────────────────┘</div>
<div class="line">                  │</div>
<div class="line">┌─────────────────▼───────────────────┐</div>
<div class="line">│     External Dependencies           │</div>
<div class="line">│  ASIO │ fmt │ thread_system │ etc.  │</div>
<div class="line">└─────────────────────────────────────┘</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md2437"></a>
2. Namespace Design</h3>
<div class="fragment"><div class="line"><span class="keyword">namespace </span><a class="code hl_namespace" href="../../d3/da6/namespacenetwork__system.html">network_system</a> {</div>
<div class="line">    <span class="comment">// Core API</span></div>
<div class="line">    <span class="keyword">namespace </span><a class="code hl_namespace" href="../../d7/dda/namespacekcenon_1_1logger_1_1core.html">core</a> {</div>
<div class="line">        <span class="keyword">class </span>messaging_client;</div>
<div class="line">        <span class="keyword">class </span>messaging_server;</div>
<div class="line">        <span class="keyword">class </span>network_config;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Session management</span></div>
<div class="line">    <span class="keyword">namespace </span>session {</div>
<div class="line">        <span class="keyword">class </span>messaging_session;</div>
<div class="line">        <span class="keyword">class </span>session_manager;</div>
<div class="line">        <span class="keyword">class </span>connection_pool;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Internal implementation (not exposed externally)</span></div>
<div class="line">    <span class="keyword">namespace </span><a class="code hl_enumvalue" href="../../de/d3f/namespacemonitoring__system.html#a85c35f5354bb46fdd8f4e39a0aa37c9ead1efad72dc5b17dc66a46767c32fff40">internal</a> {</div>
<div class="line">        <span class="keyword">class </span>tcp_socket;</div>
<div class="line">        <span class="keyword">class </span>send_coroutine;</div>
<div class="line">        <span class="keyword">class </span>message_pipeline;</div>
<div class="line">        <span class="keyword">class </span>protocol_handler;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// System integration</span></div>
<div class="line">    <span class="keyword">namespace </span>integration {</div>
<div class="line">        <span class="keyword">class </span><a class="code hl_typedef" href="../../d1/df3/namespacenetwork__module.html#a6a43c9da0c92eda3c4e9efaba087c220">messaging_bridge</a>;</div>
<div class="line">        <span class="keyword">class </span>container_integration;</div>
<div class="line">        <span class="keyword">class </span>thread_integration;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Compatibility namespace (for existing code)</span></div>
<div class="line">        <span class="keyword">namespace </span>compat {</div>
<div class="line">            <span class="keyword">namespace </span><a class="code hl_namespace" href="../../d1/df3/namespacenetwork__module.html">network_module</a> = <a class="code hl_namespace" href="../../d3/da6/namespacenetwork__system.html">network_system</a>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Utilities</span></div>
<div class="line">    <span class="keyword">namespace </span>utils {</div>
<div class="line">        <span class="keyword">class </span>network_utils;</div>
<div class="line">        <span class="keyword">class </span>address_resolver;</div>
<div class="line">        <span class="keyword">class </span>performance_monitor;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="anamespacekcenon_1_1logger_1_1core_html"><div class="ttname"><a href="../../d7/dda/namespacekcenon_1_1logger_1_1core.html">kcenon::logger::core</a></div><div class="ttdef"><b>Definition</b> <a href="../../d7/dd9/logger__system_2include_2kcenon_2logger_2compatibility_8h_source.html#l00008">compatibility.h:8</a></div></div>
<div class="ttc" id="anamespacemonitoring__system_html_a85c35f5354bb46fdd8f4e39a0aa37c9ead1efad72dc5b17dc66a46767c32fff40"><div class="ttname"><a href="../../de/d3f/namespacemonitoring__system.html#a85c35f5354bb46fdd8f4e39a0aa37c9ead1efad72dc5b17dc66a46767c32fff40">monitoring_system::otel_span_kind::internal</a></div><div class="ttdeci">@ internal</div></div>
<div class="ttc" id="anamespacenetwork__module_html"><div class="ttname"><a href="../../d1/df3/namespacenetwork__module.html">network_module</a></div><div class="ttdoc">Main namespace for all network-related functionality.</div><div class="ttdef"><b>Definition</b> <a href="../../d8/da3/core_2messaging__client_8cpp_source.html#l00041">messaging_client.cpp:42</a></div></div>
<div class="ttc" id="anamespacenetwork__module_html_a6a43c9da0c92eda3c4e9efaba087c220"><div class="ttname"><a href="../../d1/df3/namespacenetwork__module.html#a6a43c9da0c92eda3c4e9efaba087c220">network_module::messaging_bridge</a></div><div class="ttdeci">::network_system::integration::messaging_bridge messaging_bridge</div><div class="ttdef"><b>Definition</b> <a href="../../dd/ddf/network__system_2include_2network__system_2compatibility_8h_source.html#l00032">compatibility.h:32</a></div></div>
<div class="ttc" id="anamespacenetwork__system_html"><div class="ttname"><a href="../../d3/da6/namespacenetwork__system.html">network_system</a></div><div class="ttdoc">Main namespace for all Network System components.</div></div>
</div><!-- fragment --><hr  />
<h2><a class="anchor" id="autotoc_md2439"></a>
🔧 Core Component Implementation</h2>
<h3><a class="anchor" id="autotoc_md2440"></a>
1. messaging_bridge Class</h3>
<div class="fragment"><div class="line"><span class="comment">// include/network_system/integration/messaging_bridge.h</span></div>
<div class="line"><span class="preprocessor">#pragma once</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;network_system/core/messaging_client.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;network_system/core/messaging_server.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;network_system/utils/performance_monitor.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef BUILD_WITH_CONTAINER_SYSTEM</span></div>
<div class="line"><span class="preprocessor">#include &quot;container_system/value_container.h&quot;</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef BUILD_WITH_THREAD_SYSTEM</span></div>
<div class="line"><span class="preprocessor">#include &quot;thread_system/thread_pool.h&quot;</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span><a class="code hl_namespace" href="../../de/d14/namespacenetwork__system_1_1integration.html">network_system::integration</a> {</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>messaging_bridge {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="comment">// Constructor/Destructor</span></div>
<div class="line">    <span class="keyword">explicit</span> <a class="code hl_function" href="../../d2/db5/classnetwork__system_1_1integration_1_1messaging__bridge.html#ad7410660af9b801bba175c9f5d2e7e22">messaging_bridge</a>(<span class="keyword">const</span> std::string&amp; bridge_id = <span class="stringliteral">&quot;default&quot;</span>);</div>
<div class="line">    <a class="code hl_function" href="../../d2/db5/classnetwork__system_1_1integration_1_1messaging__bridge.html#afaa822864ec30a25227d0beb42d0a0a7">~messaging_bridge</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Delete copy and move constructors (singleton pattern)</span></div>
<div class="line">    <a class="code hl_function" href="../../d2/db5/classnetwork__system_1_1integration_1_1messaging__bridge.html#ad7410660af9b801bba175c9f5d2e7e22">messaging_bridge</a>(<span class="keyword">const</span> <a class="code hl_function" href="../../d2/db5/classnetwork__system_1_1integration_1_1messaging__bridge.html#ad7410660af9b801bba175c9f5d2e7e22">messaging_bridge</a>&amp;) = <span class="keyword">delete</span>;</div>
<div class="line">    <a class="code hl_function" href="../../d2/db5/classnetwork__system_1_1integration_1_1messaging__bridge.html#ad7410660af9b801bba175c9f5d2e7e22">messaging_bridge</a>&amp; operator=(<span class="keyword">const</span> <a class="code hl_function" href="../../d2/db5/classnetwork__system_1_1integration_1_1messaging__bridge.html#ad7410660af9b801bba175c9f5d2e7e22">messaging_bridge</a>&amp;) = <span class="keyword">delete</span>;</div>
<div class="line">    <a class="code hl_function" href="../../d2/db5/classnetwork__system_1_1integration_1_1messaging__bridge.html#ad7410660af9b801bba175c9f5d2e7e22">messaging_bridge</a>(<a class="code hl_function" href="../../d2/db5/classnetwork__system_1_1integration_1_1messaging__bridge.html#ad7410660af9b801bba175c9f5d2e7e22">messaging_bridge</a>&amp;&amp;) = <span class="keyword">delete</span>;</div>
<div class="line">    <a class="code hl_function" href="../../d2/db5/classnetwork__system_1_1integration_1_1messaging__bridge.html#ad7410660af9b801bba175c9f5d2e7e22">messaging_bridge</a>&amp; operator=(<a class="code hl_function" href="../../d2/db5/classnetwork__system_1_1integration_1_1messaging__bridge.html#ad7410660af9b801bba175c9f5d2e7e22">messaging_bridge</a>&amp;&amp;) = <span class="keyword">delete</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Server/Client factory</span></div>
<div class="line">    std::shared_ptr&lt;core::messaging_server&gt; <a class="code hl_function" href="../../d2/db5/classnetwork__system_1_1integration_1_1messaging__bridge.html#ab6f457cbf9c43c50da81072a4d24b7fc">create_server</a>(</div>
<div class="line">        <span class="keyword">const</span> std::string&amp; server_id,</div>
<div class="line">        <span class="keyword">const</span> core::server_config&amp; config = {}</div>
<div class="line">    );</div>
<div class="line"> </div>
<div class="line">    std::shared_ptr&lt;core::messaging_client&gt; <a class="code hl_function" href="../../d2/db5/classnetwork__system_1_1integration_1_1messaging__bridge.html#ac289b6a179eb133b5da0212e5f6d0b8d">create_client</a>(</div>
<div class="line">        <span class="keyword">const</span> std::string&amp; client_id,</div>
<div class="line">        <span class="keyword">const</span> core::client_config&amp; config = {}</div>
<div class="line">    );</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Compatibility API (for existing messaging_system code)</span></div>
<div class="line">    <span class="keyword">namespace </span>compat {</div>
<div class="line">        <span class="keyword">using </span><a class="code hl_typedef" href="../../d1/df3/namespacenetwork__module.html#a180d89ec18c1a3e3d6c12f313ac5e301">messaging_server</a> = core::messaging_server;</div>
<div class="line">        <span class="keyword">using </span><a class="code hl_typedef" href="../../d1/df3/namespacenetwork__module.html#af34f1897ea7250a7de994ad21b18eae4">messaging_client</a> = core::messaging_client;</div>
<div class="line">        <span class="keyword">using </span><a class="code hl_typedef" href="../../d1/df3/namespacenetwork__module.html#a2076467d062f17a3339d62db7e953254">messaging_session</a> = session::messaging_session;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Same function signatures as existing ones</span></div>
<div class="line">        std::shared_ptr&lt;messaging_server&gt; make_messaging_server(</div>
<div class="line">            <span class="keyword">const</span> std::string&amp; server_id</div>
<div class="line">        );</div>
<div class="line">        std::shared_ptr&lt;messaging_client&gt; make_messaging_client(</div>
<div class="line">            <span class="keyword">const</span> std::string&amp; client_id</div>
<div class="line">        );</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef BUILD_WITH_CONTAINER_SYSTEM</span></div>
<div class="line">    <span class="comment">// Container System integration</span></div>
<div class="line">    <span class="keywordtype">void</span> set_container_factory(</div>
<div class="line">        std::shared_ptr&lt;container_system::value_factory&gt; factory</div>
<div class="line">    );</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> enable_container_serialization(<span class="keywordtype">bool</span> enable = <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> MessageHandler&gt;</div>
<div class="line">    <span class="keywordtype">void</span> set_container_message_handler(MessageHandler&amp;&amp; handler) {</div>
<div class="line">        <span class="keyword">static_assert</span>(std::is_invocable_v&lt;MessageHandler,</div>
<div class="line">            std::shared_ptr&lt;container_system::value_container&gt;&gt;,</div>
<div class="line">            <span class="stringliteral">&quot;Handler must accept std::shared_ptr&lt;container_system::value_container&gt;&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        container_message_handler_ = std::forward&lt;MessageHandler&gt;(handler);</div>
<div class="line">    }</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef BUILD_WITH_THREAD_SYSTEM</span></div>
<div class="line">    <span class="comment">// Thread System integration</span></div>
<div class="line">    <span class="keywordtype">void</span> set_thread_pool(</div>
<div class="line">        std::shared_ptr&lt;thread_system::thread_pool&gt; pool</div>
<div class="line">    );</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> set_async_mode(<span class="keywordtype">bool</span> async = <span class="keyword">true</span>);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Configuration management</span></div>
<div class="line">    <span class="keyword">struct </span>bridge_config {</div>
<div class="line">        <span class="keywordtype">bool</span> <a class="code hl_variable" href="../../d1/d28/namespacetyped__kcenon_1_1thread_1_1config.html#aa29720756b8fd825e92ed9757eaa9671">enable_performance_monitoring</a> = <span class="keyword">true</span>;</div>
<div class="line">        <span class="keywordtype">bool</span> enable_message_logging = <span class="keyword">false</span>;</div>
<div class="line">        <span class="keywordtype">bool</span> enable_connection_pooling = <span class="keyword">true</span>;</div>
<div class="line">        <span class="keywordtype">size_t</span> max_connections_per_client = 10;</div>
<div class="line">        std::chrono::milliseconds connection_timeout{30000};</div>
<div class="line">        std::chrono::milliseconds message_timeout{5000};</div>
<div class="line">        <span class="keywordtype">size_t</span> message_buffer_size = 8192;</div>
<div class="line">        <span class="keywordtype">bool</span> enable_compression = <span class="keyword">false</span>;</div>
<div class="line">        <span class="keywordtype">bool</span> enable_encryption = <span class="keyword">false</span>;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> set_config(<span class="keyword">const</span> bridge_config&amp; config);</div>
<div class="line">    bridge_config get_config() <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Performance monitoring</span></div>
<div class="line">    <span class="keyword">struct </span><a class="code hl_typedef" href="../../da/d02/namespacekcenon_1_1logger.html#ace0c3551d9b46d3bc6736aec9e4131b9">performance_metrics</a> {</div>
<div class="line">        <span class="comment">// Connection statistics</span></div>
<div class="line">        std::atomic&lt;uint64_t&gt; total_connections{0};</div>
<div class="line">        std::atomic&lt;uint64_t&gt; active_connections{0};</div>
<div class="line">        std::atomic&lt;uint64_t&gt; failed_connections{0};</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Message statistics</span></div>
<div class="line">        std::atomic&lt;uint64_t&gt; <a class="code hl_variable" href="../../db/d6e/structnetwork__system_1_1integration_1_1messaging__bridge_1_1performance__metrics.html#ac55c4bab768fe6f19f4f14460d0d46de">messages_sent</a>{0};</div>
<div class="line">        std::atomic&lt;uint64_t&gt; <a class="code hl_variable" href="../../db/d6e/structnetwork__system_1_1integration_1_1messaging__bridge_1_1performance__metrics.html#a424db5ee40b7d28519f5eba119473bcd">messages_received</a>{0};</div>
<div class="line">        std::atomic&lt;uint64_t&gt; <a class="code hl_variable" href="../../db/d6e/structnetwork__system_1_1integration_1_1messaging__bridge_1_1performance__metrics.html#a4622a640b02af67d8c9a0f1c87c4bf84">bytes_sent</a>{0};</div>
<div class="line">        std::atomic&lt;uint64_t&gt; <a class="code hl_variable" href="../../db/d6e/structnetwork__system_1_1integration_1_1messaging__bridge_1_1performance__metrics.html#a3b4a4ec7fde28650da5fdf893476c1e7">bytes_received</a>{0};</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Performance statistics</span></div>
<div class="line">        std::atomic&lt;uint64_t&gt; avg_latency_us{0};</div>
<div class="line">        std::atomic&lt;uint64_t&gt; max_latency_us{0};</div>
<div class="line">        std::atomic&lt;uint64_t&gt; min_latency_us{UINT64_MAX};</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Error statistics</span></div>
<div class="line">        std::atomic&lt;uint64_t&gt; send_errors{0};</div>
<div class="line">        std::atomic&lt;uint64_t&gt; receive_errors{0};</div>
<div class="line">        std::atomic&lt;uint64_t&gt; timeout_errors{0};</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Time information</span></div>
<div class="line">        std::chrono::steady_clock::time_point <a class="code hl_variable" href="../../db/d6e/structnetwork__system_1_1integration_1_1messaging__bridge_1_1performance__metrics.html#a0bf08ef96494457b13f6edb64c610f98">start_time</a>;</div>
<div class="line">        std::chrono::steady_clock::time_point last_update;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_typedef" href="../../da/d02/namespacekcenon_1_1logger.html#ace0c3551d9b46d3bc6736aec9e4131b9">performance_metrics</a> <a class="code hl_function" href="../../d2/db5/classnetwork__system_1_1integration_1_1messaging__bridge.html#a8f391bcdb90b246dd9e9bb814325124f">get_metrics</a>() <span class="keyword">const</span>;</div>
<div class="line">    <span class="keywordtype">void</span> <a class="code hl_function" href="../../d2/db5/classnetwork__system_1_1integration_1_1messaging__bridge.html#afcfa051ba12aa6383aa64c65b8ae1b49">reset_metrics</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Event handlers</span></div>
<div class="line">    <span class="keyword">using </span>connection_event_handler = std::function&lt;void(</div>
<div class="line">        <span class="keyword">const</span> std::string&amp; endpoint, <span class="keywordtype">bool</span> connected)&gt;;</div>
<div class="line">    <span class="keyword">using </span>error_event_handler = std::function&lt;void(</div>
<div class="line">        <span class="keyword">const</span> std::string&amp; error_msg, <span class="keywordtype">int</span> error_code)&gt;;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> set_connection_event_handler(connection_event_handler handler);</div>
<div class="line">    <span class="keywordtype">void</span> set_error_event_handler(error_event_handler handler);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Lifecycle management</span></div>
<div class="line">    <span class="keywordtype">void</span> start();</div>
<div class="line">    <span class="keywordtype">void</span> stop();</div>
<div class="line">    <span class="keywordtype">bool</span> is_running() <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Debugging and diagnostics</span></div>
<div class="line">    std::string get_status_report() <span class="keyword">const</span>;</div>
<div class="line">    <span class="keywordtype">void</span> <a class="code hl_variable" href="../../d1/d28/namespacetyped__kcenon_1_1thread_1_1config.html#ae8d8123db9bc5eee20a2998e48c38118">enable_debug_logging</a>(<span class="keywordtype">bool</span> enable = <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    <span class="keyword">class </span>impl;</div>
<div class="line">    std::unique_ptr&lt;impl&gt; pimpl_;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">} <span class="comment">// namespace network_system::integration</span></div>
<div class="ttc" id="aclassnetwork__system_1_1integration_1_1messaging__bridge_html_a8f391bcdb90b246dd9e9bb814325124f"><div class="ttname"><a href="../../d2/db5/classnetwork__system_1_1integration_1_1messaging__bridge.html#a8f391bcdb90b246dd9e9bb814325124f">network_system::integration::messaging_bridge::get_metrics</a></div><div class="ttdeci">performance_metrics get_metrics() const</div><div class="ttdoc">Get current performance metrics.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d5c/messaging__bridge_8cpp_source.html#l00113">messaging_bridge.cpp:113</a></div></div>
<div class="ttc" id="aclassnetwork__system_1_1integration_1_1messaging__bridge_html_ab6f457cbf9c43c50da81072a4d24b7fc"><div class="ttname"><a href="../../d2/db5/classnetwork__system_1_1integration_1_1messaging__bridge.html#ab6f457cbf9c43c50da81072a4d24b7fc">network_system::integration::messaging_bridge::create_server</a></div><div class="ttdeci">std::shared_ptr&lt; core::messaging_server &gt; create_server(const std::string &amp;server_id)</div><div class="ttdoc">Create a messaging server with messaging_system compatible API.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d5c/messaging__bridge_8cpp_source.html#l00079">messaging_bridge.cpp:79</a></div></div>
<div class="ttc" id="aclassnetwork__system_1_1integration_1_1messaging__bridge_html_ac289b6a179eb133b5da0212e5f6d0b8d"><div class="ttname"><a href="../../d2/db5/classnetwork__system_1_1integration_1_1messaging__bridge.html#ac289b6a179eb133b5da0212e5f6d0b8d">network_system::integration::messaging_bridge::create_client</a></div><div class="ttdeci">std::shared_ptr&lt; core::messaging_client &gt; create_client(const std::string &amp;client_id)</div><div class="ttdoc">Create a messaging client with messaging_system compatible API.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d5c/messaging__bridge_8cpp_source.html#l00085">messaging_bridge.cpp:85</a></div></div>
<div class="ttc" id="aclassnetwork__system_1_1integration_1_1messaging__bridge_html_ad7410660af9b801bba175c9f5d2e7e22"><div class="ttname"><a href="../../d2/db5/classnetwork__system_1_1integration_1_1messaging__bridge.html#ad7410660af9b801bba175c9f5d2e7e22">network_system::integration::messaging_bridge::messaging_bridge</a></div><div class="ttdeci">messaging_bridge()</div><div class="ttdoc">Default constructor.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d5c/messaging__bridge_8cpp_source.html#l00073">messaging_bridge.cpp:73</a></div></div>
<div class="ttc" id="aclassnetwork__system_1_1integration_1_1messaging__bridge_html_afaa822864ec30a25227d0beb42d0a0a7"><div class="ttname"><a href="../../d2/db5/classnetwork__system_1_1integration_1_1messaging__bridge.html#afaa822864ec30a25227d0beb42d0a0a7">network_system::integration::messaging_bridge::~messaging_bridge</a></div><div class="ttdeci">~messaging_bridge()</div><div class="ttdoc">Destructor.</div></div>
<div class="ttc" id="aclassnetwork__system_1_1integration_1_1messaging__bridge_html_afcfa051ba12aa6383aa64c65b8ae1b49"><div class="ttname"><a href="../../d2/db5/classnetwork__system_1_1integration_1_1messaging__bridge.html#afcfa051ba12aa6383aa64c65b8ae1b49">network_system::integration::messaging_bridge::reset_metrics</a></div><div class="ttdeci">void reset_metrics()</div><div class="ttdoc">Reset performance metrics.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d5c/messaging__bridge_8cpp_source.html#l00118">messaging_bridge.cpp:118</a></div></div>
<div class="ttc" id="anamespacekcenon_1_1logger_html_ace0c3551d9b46d3bc6736aec9e4131b9"><div class="ttname"><a href="../../da/d02/namespacekcenon_1_1logger.html#ace0c3551d9b46d3bc6736aec9e4131b9">kcenon::logger::performance_metrics</a></div><div class="ttdeci">metrics::logger_performance_stats performance_metrics</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d8c/logger_8h_source.html#l00122">logger.h:122</a></div></div>
<div class="ttc" id="anamespacenetwork__module_html_a180d89ec18c1a3e3d6c12f313ac5e301"><div class="ttname"><a href="../../d1/df3/namespacenetwork__module.html#a180d89ec18c1a3e3d6c12f313ac5e301">network_module::messaging_server</a></div><div class="ttdeci">::network_system::core::messaging_server messaging_server</div><div class="ttdef"><b>Definition</b> <a href="../../dd/ddf/network__system_2include_2network__system_2compatibility_8h_source.html#l00025">compatibility.h:25</a></div></div>
<div class="ttc" id="anamespacenetwork__module_html_a2076467d062f17a3339d62db7e953254"><div class="ttname"><a href="../../d1/df3/namespacenetwork__module.html#a2076467d062f17a3339d62db7e953254">network_module::messaging_session</a></div><div class="ttdeci">::network_system::session::messaging_session messaging_session</div><div class="ttdef"><b>Definition</b> <a href="../../dd/ddf/network__system_2include_2network__system_2compatibility_8h_source.html#l00029">compatibility.h:29</a></div></div>
<div class="ttc" id="anamespacenetwork__module_html_af34f1897ea7250a7de994ad21b18eae4"><div class="ttname"><a href="../../d1/df3/namespacenetwork__module.html#af34f1897ea7250a7de994ad21b18eae4">network_module::messaging_client</a></div><div class="ttdeci">::network_system::core::messaging_client messaging_client</div><div class="ttdef"><b>Definition</b> <a href="../../dd/ddf/network__system_2include_2network__system_2compatibility_8h_source.html#l00026">compatibility.h:26</a></div></div>
<div class="ttc" id="anamespacenetwork__system_1_1integration_html"><div class="ttname"><a href="../../de/d14/namespacenetwork__system_1_1integration.html">network_system::integration</a></div><div class="ttdef"><b>Definition</b> <a href="../../dd/d45/container__integration_8h_source.html#l00024">container_integration.h:24</a></div></div>
<div class="ttc" id="anamespacetyped__kcenon_1_1thread_1_1config_html_aa29720756b8fd825e92ed9757eaa9671"><div class="ttname"><a href="../../d1/d28/namespacetyped__kcenon_1_1thread_1_1config.html#aa29720756b8fd825e92ed9757eaa9671">typed_kcenon::thread::config::enable_performance_monitoring</a></div><div class="ttdeci">constexpr bool enable_performance_monitoring</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4c/libraries_2thread__system_2src_2impl_2typed__pool_2config_8h_source.html#l00073">config.h:73</a></div></div>
<div class="ttc" id="anamespacetyped__kcenon_1_1thread_1_1config_html_ae8d8123db9bc5eee20a2998e48c38118"><div class="ttname"><a href="../../d1/d28/namespacetyped__kcenon_1_1thread_1_1config.html#ae8d8123db9bc5eee20a2998e48c38118">typed_kcenon::thread::config::enable_debug_logging</a></div><div class="ttdeci">constexpr bool enable_debug_logging</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d4c/libraries_2thread__system_2src_2impl_2typed__pool_2config_8h_source.html#l00072">config.h:72</a></div></div>
<div class="ttc" id="astructnetwork__system_1_1integration_1_1messaging__bridge_1_1performance__metrics_html_a0bf08ef96494457b13f6edb64c610f98"><div class="ttname"><a href="../../db/d6e/structnetwork__system_1_1integration_1_1messaging__bridge_1_1performance__metrics.html#a0bf08ef96494457b13f6edb64c610f98">network_system::integration::messaging_bridge::performance_metrics::start_time</a></div><div class="ttdeci">std::chrono::steady_clock::time_point start_time</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d64/messaging__bridge_8h_source.html#l00155">messaging_bridge.h:155</a></div></div>
<div class="ttc" id="astructnetwork__system_1_1integration_1_1messaging__bridge_1_1performance__metrics_html_a3b4a4ec7fde28650da5fdf893476c1e7"><div class="ttname"><a href="../../db/d6e/structnetwork__system_1_1integration_1_1messaging__bridge_1_1performance__metrics.html#a3b4a4ec7fde28650da5fdf893476c1e7">network_system::integration::messaging_bridge::performance_metrics::bytes_received</a></div><div class="ttdeci">uint64_t bytes_received</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d64/messaging__bridge_8h_source.html#l00152">messaging_bridge.h:152</a></div></div>
<div class="ttc" id="astructnetwork__system_1_1integration_1_1messaging__bridge_1_1performance__metrics_html_a424db5ee40b7d28519f5eba119473bcd"><div class="ttname"><a href="../../db/d6e/structnetwork__system_1_1integration_1_1messaging__bridge_1_1performance__metrics.html#a424db5ee40b7d28519f5eba119473bcd">network_system::integration::messaging_bridge::performance_metrics::messages_received</a></div><div class="ttdeci">uint64_t messages_received</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d64/messaging__bridge_8h_source.html#l00150">messaging_bridge.h:150</a></div></div>
<div class="ttc" id="astructnetwork__system_1_1integration_1_1messaging__bridge_1_1performance__metrics_html_a4622a640b02af67d8c9a0f1c87c4bf84"><div class="ttname"><a href="../../db/d6e/structnetwork__system_1_1integration_1_1messaging__bridge_1_1performance__metrics.html#a4622a640b02af67d8c9a0f1c87c4bf84">network_system::integration::messaging_bridge::performance_metrics::bytes_sent</a></div><div class="ttdeci">uint64_t bytes_sent</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d64/messaging__bridge_8h_source.html#l00151">messaging_bridge.h:151</a></div></div>
<div class="ttc" id="astructnetwork__system_1_1integration_1_1messaging__bridge_1_1performance__metrics_html_ac55c4bab768fe6f19f4f14460d0d46de"><div class="ttname"><a href="../../db/d6e/structnetwork__system_1_1integration_1_1messaging__bridge_1_1performance__metrics.html#ac55c4bab768fe6f19f4f14460d0d46de">network_system::integration::messaging_bridge::performance_metrics::messages_sent</a></div><div class="ttdeci">uint64_t messages_sent</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d64/messaging__bridge_8h_source.html#l00149">messaging_bridge.h:149</a></div></div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md2441"></a>
2. Core API Design</h3>
<div class="fragment"><div class="line"><span class="comment">// include/network_system/core/messaging_server.h</span></div>
<div class="line"><span class="preprocessor">#pragma once</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;network_system/session/messaging_session.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;functional&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span><a class="code hl_namespace" href="../../da/d6e/namespacenetwork__system_1_1core.html">network_system::core</a> {</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>server_config {</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> port = 8080;</div>
<div class="line">    std::string bind_address = <span class="stringliteral">&quot;0.0.0.0&quot;</span>;</div>
<div class="line">    <span class="keywordtype">size_t</span> max_connections = 1000;</div>
<div class="line">    <span class="keywordtype">size_t</span> message_size_limit = 1024 * 1024; <span class="comment">// 1MB</span></div>
<div class="line">    std::chrono::seconds timeout{30};</div>
<div class="line">    <span class="keywordtype">bool</span> enable_keep_alive = <span class="keyword">true</span>;</div>
<div class="line">    <span class="keywordtype">bool</span> enable_nodelay = <span class="keyword">true</span>;</div>
<div class="line">    <span class="keywordtype">size_t</span> receive_buffer_size = 8192;</div>
<div class="line">    <span class="keywordtype">size_t</span> send_buffer_size = 8192;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span><a class="code hl_typedef" href="../../d1/df3/namespacenetwork__module.html#a180d89ec18c1a3e3d6c12f313ac5e301">messaging_server</a> {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="comment">// Constructor</span></div>
<div class="line">    <span class="keyword">explicit</span> <a class="code hl_function" href="../../df/d9d/classnetwork__system_1_1core_1_1messaging__server.html#a797357b2538f2fb06f5c7cdbd5bd43cb">messaging_server</a>(<span class="keyword">const</span> std::string&amp; server_id);</div>
<div class="line">    <a class="code hl_function" href="../../df/d9d/classnetwork__system_1_1core_1_1messaging__server.html#a797357b2538f2fb06f5c7cdbd5bd43cb">messaging_server</a>(<span class="keyword">const</span> std::string&amp; server_id, <span class="keyword">const</span> server_config&amp; config);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Destructor</span></div>
<div class="line">    <a class="code hl_function" href="../../df/d9d/classnetwork__system_1_1core_1_1messaging__server.html#a682fbd41555435391edfde93e8d6b264">~messaging_server</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Delete copy/move</span></div>
<div class="line">    <a class="code hl_function" href="../../df/d9d/classnetwork__system_1_1core_1_1messaging__server.html#a797357b2538f2fb06f5c7cdbd5bd43cb">messaging_server</a>(<span class="keyword">const</span> messaging_server&amp;) = <span class="keyword">delete</span>;</div>
<div class="line">    <a class="code hl_function" href="../../df/d9d/classnetwork__system_1_1core_1_1messaging__server.html#a797357b2538f2fb06f5c7cdbd5bd43cb">messaging_server</a>&amp; operator=(<span class="keyword">const</span> messaging_server&amp;) = <span class="keyword">delete</span>;</div>
<div class="line">    <a class="code hl_function" href="../../df/d9d/classnetwork__system_1_1core_1_1messaging__server.html#a797357b2538f2fb06f5c7cdbd5bd43cb">messaging_server</a>(messaging_server&amp;&amp;) = <span class="keyword">delete</span>;</div>
<div class="line">    <a class="code hl_function" href="../../df/d9d/classnetwork__system_1_1core_1_1messaging__server.html#a797357b2538f2fb06f5c7cdbd5bd43cb">messaging_server</a>&amp; operator=(messaging_server&amp;&amp;) = <span class="keyword">delete</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Server lifecycle</span></div>
<div class="line">    <span class="keywordtype">bool</span> <a class="code hl_function" href="../../df/d9d/classnetwork__system_1_1core_1_1messaging__server.html#ad2af85cda76e084a70c310155bab972f">start_server</a>();</div>
<div class="line">    <span class="keywordtype">bool</span> <a class="code hl_function" href="../../df/d9d/classnetwork__system_1_1core_1_1messaging__server.html#ad2af85cda76e084a70c310155bab972f">start_server</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> port);</div>
<div class="line">    <span class="keywordtype">bool</span> <a class="code hl_function" href="../../df/d9d/classnetwork__system_1_1core_1_1messaging__server.html#ad2af85cda76e084a70c310155bab972f">start_server</a>(<span class="keyword">const</span> std::string&amp; bind_address, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> port);</div>
<div class="line">    <span class="keywordtype">void</span> <a class="code hl_function" href="../../df/d9d/classnetwork__system_1_1core_1_1messaging__server.html#a7421409c3bfe838b6ee29aa2dca3d670">stop_server</a>();</div>
<div class="line">    <span class="keywordtype">void</span> <a class="code hl_function" href="../../df/d9d/classnetwork__system_1_1core_1_1messaging__server.html#a784650b481ee58f141f95f092b68b0d6">wait_for_stop</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Status queries</span></div>
<div class="line">    <span class="keywordtype">bool</span> is_running() <span class="keyword">const</span>;</div>
<div class="line">    std::string server_id() <span class="keyword">const</span>;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> port() <span class="keyword">const</span>;</div>
<div class="line">    std::string bind_address() <span class="keyword">const</span>;</div>
<div class="line">    <span class="keywordtype">size_t</span> connection_count() <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Configuration management</span></div>
<div class="line">    <span class="keywordtype">void</span> set_config(<span class="keyword">const</span> server_config&amp; config);</div>
<div class="line">    server_config get_config() <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Event handler setup</span></div>
<div class="line">    <span class="keyword">using </span><a class="code hl_typedef" href="../../db/d06/namespacekcenon_1_1messaging_1_1core.html#a8c22dfb7d7aa1f22cdb4121e81c8de78">message_handler</a> = std::function&lt;void(</div>
<div class="line">        std::shared_ptr&lt;session::messaging_session&gt;,</div>
<div class="line">        <span class="keyword">const</span> std::string&amp;)&gt;;</div>
<div class="line">    <span class="keyword">using </span>connect_handler = std::function&lt;void(</div>
<div class="line">        std::shared_ptr&lt;session::messaging_session&gt;)&gt;;</div>
<div class="line">    <span class="keyword">using </span>disconnect_handler = std::function&lt;void(</div>
<div class="line">        std::shared_ptr&lt;session::messaging_session&gt;,</div>
<div class="line">        <span class="keyword">const</span> std::string&amp;)&gt;;</div>
<div class="line">    <span class="keyword">using </span>error_handler = std::function&lt;void(</div>
<div class="line">        <span class="keyword">const</span> std::string&amp;, <span class="keywordtype">int</span>)&gt;;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> set_message_handler(message_handler handler);</div>
<div class="line">    <span class="keywordtype">void</span> set_connect_handler(connect_handler handler);</div>
<div class="line">    <span class="keywordtype">void</span> set_disconnect_handler(disconnect_handler handler);</div>
<div class="line">    <span class="keywordtype">void</span> set_error_handler(error_handler handler);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Message broadcasting</span></div>
<div class="line">    <span class="keywordtype">void</span> broadcast_message(<span class="keyword">const</span> std::string&amp; message);</div>
<div class="line">    <span class="keywordtype">void</span> broadcast_to_group(<span class="keyword">const</span> std::string&amp; group_id, <span class="keyword">const</span> std::string&amp; message);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Session management</span></div>
<div class="line">    std::shared_ptr&lt;session::messaging_session&gt; get_session(</div>
<div class="line">        <span class="keyword">const</span> std::string&amp; session_id);</div>
<div class="line">    std::vector&lt;std::shared_ptr&lt;session::messaging_session&gt;&gt; get_all_sessions();</div>
<div class="line">    <span class="keywordtype">void</span> disconnect_session(<span class="keyword">const</span> std::string&amp; session_id);</div>
<div class="line">    <span class="keywordtype">void</span> disconnect_all_sessions();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Group management</span></div>
<div class="line">    <span class="keywordtype">void</span> add_session_to_group(<span class="keyword">const</span> std::string&amp; session_id,</div>
<div class="line">                              <span class="keyword">const</span> std::string&amp; group_id);</div>
<div class="line">    <span class="keywordtype">void</span> remove_session_from_group(<span class="keyword">const</span> std::string&amp; session_id,</div>
<div class="line">                                   <span class="keyword">const</span> std::string&amp; group_id);</div>
<div class="line">    std::vector&lt;std::string&gt; get_session_groups(<span class="keyword">const</span> std::string&amp; session_id);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Statistics</span></div>
<div class="line">    <span class="keyword">struct </span>server_statistics {</div>
<div class="line">        uint64_t total_connections = 0;</div>
<div class="line">        uint64_t current_connections = 0;</div>
<div class="line">        uint64_t messages_sent = 0;</div>
<div class="line">        uint64_t messages_received = 0;</div>
<div class="line">        uint64_t bytes_sent = 0;</div>
<div class="line">        uint64_t bytes_received = 0;</div>
<div class="line">        std::chrono::steady_clock::time_point start_time;</div>
<div class="line">        std::chrono::steady_clock::time_point last_activity;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    server_statistics get_statistics() <span class="keyword">const</span>;</div>
<div class="line">    <span class="keywordtype">void</span> reset_statistics();</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    <span class="keyword">class </span>impl;</div>
<div class="line">    std::unique_ptr&lt;impl&gt; pimpl_;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">} <span class="comment">// namespace network_system::core</span></div>
<div class="ttc" id="aclassnetwork__system_1_1core_1_1messaging__server_html_a682fbd41555435391edfde93e8d6b264"><div class="ttname"><a href="../../df/d9d/classnetwork__system_1_1core_1_1messaging__server.html#a682fbd41555435391edfde93e8d6b264">network_system::core::messaging_server::~messaging_server</a></div><div class="ttdeci">~messaging_server()</div><div class="ttdoc">Destructor. If the server is still running, stop_server() is invoked.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d0d/src_2core_2messaging__server_8cpp_source.html#l00047">messaging_server.cpp:47</a></div></div>
<div class="ttc" id="aclassnetwork__system_1_1core_1_1messaging__server_html_a7421409c3bfe838b6ee29aa2dca3d670"><div class="ttname"><a href="../../df/d9d/classnetwork__system_1_1core_1_1messaging__server.html#a7421409c3bfe838b6ee29aa2dca3d670">network_system::core::messaging_server::stop_server</a></div><div class="ttdeci">auto stop_server() -&gt; void</div><div class="ttdoc">Stops the server, closing the acceptor and all active sessions, then stops the io_context and joins t...</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d0d/src_2core_2messaging__server_8cpp_source.html#l00087">messaging_server.cpp:87</a></div></div>
<div class="ttc" id="aclassnetwork__system_1_1core_1_1messaging__server_html_a784650b481ee58f141f95f092b68b0d6"><div class="ttname"><a href="../../df/d9d/classnetwork__system_1_1core_1_1messaging__server.html#a784650b481ee58f141f95f092b68b0d6">network_system::core::messaging_server::wait_for_stop</a></div><div class="ttdeci">auto wait_for_stop() -&gt; void</div><div class="ttdoc">Blocks until stop_server() is called, allowing the caller to wait for a graceful shutdown in another ...</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d0d/src_2core_2messaging__server_8cpp_source.html#l00134">messaging_server.cpp:134</a></div></div>
<div class="ttc" id="aclassnetwork__system_1_1core_1_1messaging__server_html_a797357b2538f2fb06f5c7cdbd5bd43cb"><div class="ttname"><a href="../../df/d9d/classnetwork__system_1_1core_1_1messaging__server.html#a797357b2538f2fb06f5c7cdbd5bd43cb">network_system::core::messaging_server::messaging_server</a></div><div class="ttdeci">messaging_server(const std::string &amp;server_id)</div><div class="ttdoc">Constructs a messaging_server with an optional string server_id.</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d0d/src_2core_2messaging__server_8cpp_source.html#l00042">messaging_server.cpp:42</a></div></div>
<div class="ttc" id="aclassnetwork__system_1_1core_1_1messaging__server_html_ad2af85cda76e084a70c310155bab972f"><div class="ttname"><a href="../../df/d9d/classnetwork__system_1_1core_1_1messaging__server.html#ad2af85cda76e084a70c310155bab972f">network_system::core::messaging_server::start_server</a></div><div class="ttdeci">auto start_server(unsigned short port) -&gt; void</div><div class="ttdoc">Begins listening on the specified TCP port, creates a background thread to run I/O operations,...</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d0d/src_2core_2messaging__server_8cpp_source.html#l00049">messaging_server.cpp:49</a></div></div>
<div class="ttc" id="anamespacekcenon_1_1messaging_1_1core_html_a8c22dfb7d7aa1f22cdb4121e81c8de78"><div class="ttname"><a href="../../db/d06/namespacekcenon_1_1messaging_1_1core.html#a8c22dfb7d7aa1f22cdb4121e81c8de78">kcenon::messaging::core::message_handler</a></div><div class="ttdeci">std::function&lt; void(const message &amp;)&gt; message_handler</div><div class="ttdef"><b>Definition</b> <a href="../../d5/dd2/message__types_8h_source.html#l00133">message_types.h:133</a></div></div>
<div class="ttc" id="anamespacenetwork__system_1_1core_html"><div class="ttname"><a href="../../da/d6e/namespacenetwork__system_1_1core.html">network_system::core</a></div><div class="ttdef"><b>Definition</b> <a href="../../d9/dd6/include_2network__system_2core_2messaging__client_8h_source.html#l00050">messaging_client.h:51</a></div></div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md2442"></a>
3. Session Management</h3>
<div class="fragment"><div class="line"><span class="comment">// include/network_system/session/messaging_session.h</span></div>
<div class="line"><span class="preprocessor">#pragma once</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;chrono&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;functional&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;unordered_map&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span><a class="code hl_namespace" href="../../d3/dac/namespacenetwork__system_1_1session.html">network_system::session</a> {</div>
<div class="line"> </div>
<div class="line"><span class="keyword">enum class</span> session_state {</div>
<div class="line">    connecting,</div>
<div class="line">    connected,</div>
<div class="line">    disconnecting,</div>
<div class="line">    disconnected,</div>
<div class="line">    error</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>messaging_session {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="comment">// Destructor</span></div>
<div class="line">    <span class="keyword">virtual</span> <a class="code hl_function" href="../../d1/de6/classnetwork__system_1_1session_1_1messaging__session.html#a3f6d53762e47ca084aaca35892fdad79">~messaging_session</a>() = <span class="keywordflow">default</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Message send/receive</span></div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> send_message(<span class="keyword">const</span> std::string&amp; message) = 0;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> send_raw_data(<span class="keyword">const</span> std::vector&lt;uint8_t&gt;&amp; data) = 0;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> send_binary_message(<span class="keyword">const</span> <span class="keywordtype">void</span>* data, <span class="keywordtype">size_t</span> size) = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Session information</span></div>
<div class="line">    <span class="keyword">virtual</span> std::string session_id() <span class="keyword">const</span> = 0;</div>
<div class="line">    <span class="keyword">virtual</span> std::string client_id() <span class="keyword">const</span> = 0;</div>
<div class="line">    <span class="keyword">virtual</span> std::string remote_address() <span class="keyword">const</span> = 0;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> remote_port() <span class="keyword">const</span> = 0;</div>
<div class="line">    <span class="keyword">virtual</span> std::string local_address() <span class="keyword">const</span> = 0;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> local_port() <span class="keyword">const</span> = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Connection state</span></div>
<div class="line">    <span class="keyword">virtual</span> session_state state() <span class="keyword">const</span> = 0;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> is_connected() <span class="keyword">const</span> = 0;</div>
<div class="line">    <span class="keyword">virtual</span> std::chrono::steady_clock::time_point connect_time() <span class="keyword">const</span> = 0;</div>
<div class="line">    <span class="keyword">virtual</span> std::chrono::steady_clock::time_point last_activity() <span class="keyword">const</span> = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Session management</span></div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> disconnect() = 0;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> disconnect(<span class="keyword">const</span> std::string&amp; reason) = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Session data (key-value store)</span></div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> set_session_data(<span class="keyword">const</span> std::string&amp; key,</div>
<div class="line">                                  <span class="keyword">const</span> std::string&amp; value) = 0;</div>
<div class="line">    <span class="keyword">virtual</span> std::string get_session_data(<span class="keyword">const</span> std::string&amp; key) <span class="keyword">const</span> = 0;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> has_session_data(<span class="keyword">const</span> std::string&amp; key) <span class="keyword">const</span> = 0;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> remove_session_data(<span class="keyword">const</span> std::string&amp; key) = 0;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> clear_session_data() = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Session groups</span></div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> join_group(<span class="keyword">const</span> std::string&amp; group_id) = 0;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> leave_group(<span class="keyword">const</span> std::string&amp; group_id) = 0;</div>
<div class="line">    <span class="keyword">virtual</span> std::vector&lt;std::string&gt; get_groups() <span class="keyword">const</span> = 0;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> is_in_group(<span class="keyword">const</span> std::string&amp; group_id) <span class="keyword">const</span> = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Statistics</span></div>
<div class="line">    <span class="keyword">struct </span>session_statistics {</div>
<div class="line">        uint64_t messages_sent = 0;</div>
<div class="line">        uint64_t messages_received = 0;</div>
<div class="line">        uint64_t bytes_sent = 0;</div>
<div class="line">        uint64_t bytes_received = 0;</div>
<div class="line">        uint64_t errors_count = 0;</div>
<div class="line">        std::chrono::steady_clock::time_point last_message_time;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">virtual</span> session_statistics get_statistics() <span class="keyword">const</span> = 0;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> reset_statistics() = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Event handlers</span></div>
<div class="line">    <span class="keyword">using </span><a class="code hl_typedef" href="../../db/d06/namespacekcenon_1_1messaging_1_1core.html#a8c22dfb7d7aa1f22cdb4121e81c8de78">message_handler</a> = std::function&lt;void(<span class="keyword">const</span> std::string&amp;)&gt;;</div>
<div class="line">    <span class="keyword">using </span>state_change_handler = std::function&lt;void(session_state, session_state)&gt;;</div>
<div class="line">    <span class="keyword">using </span>error_handler = std::function&lt;void(<span class="keyword">const</span> std::string&amp;, <span class="keywordtype">int</span>)&gt;;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> set_message_handler(message_handler handler) = 0;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> set_state_change_handler(state_change_handler handler) = 0;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> set_error_handler(error_handler handler) = 0;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">protected</span>:</div>
<div class="line">    <a class="code hl_function" href="../../d1/de6/classnetwork__system_1_1session_1_1messaging__session.html#aa4cd94687ded0439560a22d65ce17833">messaging_session</a>() = <span class="keywordflow">default</span>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Factory functions</span></div>
<div class="line">std::shared_ptr&lt;messaging_session&gt; create_tcp_session(</div>
<div class="line">    <span class="keyword">const</span> std::string&amp; session_id,</div>
<div class="line">    <span class="keyword">const</span> std::string&amp; client_id</div>
<div class="line">);</div>
<div class="line"> </div>
<div class="line">} <span class="comment">// namespace network_system::session</span></div>
<div class="ttc" id="aclassnetwork__system_1_1session_1_1messaging__session_html_a3f6d53762e47ca084aaca35892fdad79"><div class="ttname"><a href="../../d1/de6/classnetwork__system_1_1session_1_1messaging__session.html#a3f6d53762e47ca084aaca35892fdad79">network_system::session::messaging_session::~messaging_session</a></div><div class="ttdeci">~messaging_session()</div><div class="ttdoc">Destructor; calls stop_session() if not already stopped.</div><div class="ttdef"><b>Definition</b> <a href="../../da/de3/src_2session_2messaging__session_8cpp_source.html#l00059">messaging_session.cpp:59</a></div></div>
<div class="ttc" id="aclassnetwork__system_1_1session_1_1messaging__session_html_aa4cd94687ded0439560a22d65ce17833"><div class="ttname"><a href="../../d1/de6/classnetwork__system_1_1session_1_1messaging__session.html#aa4cd94687ded0439560a22d65ce17833">network_system::session::messaging_session::messaging_session</a></div><div class="ttdeci">messaging_session(asio::ip::tcp::socket socket, std::string_view server_id)</div><div class="ttdoc">Constructs a session with a given socket and server_id.</div><div class="ttdef"><b>Definition</b> <a href="../../da/de3/src_2session_2messaging__session_8cpp_source.html#l00044">messaging_session.cpp:44</a></div></div>
<div class="ttc" id="anamespacenetwork__system_1_1session_html"><div class="ttname"><a href="../../d3/dac/namespacenetwork__system_1_1session.html">network_system::session</a></div><div class="ttdef"><b>Definition</b> <a href="../../dc/de4/include_2network__system_2core_2messaging__server_8h_source.html#l00049">messaging_server.h:49</a></div></div>
</div><!-- fragment --><hr  />
<h2><a class="anchor" id="autotoc_md2444"></a>
🔗 Dependency Management</h2>
<h3><a class="anchor" id="autotoc_md2445"></a>
1. CMake Module Files</h3>
<div class="fragment"><div class="line"># cmake/FindNetworkSystem.cmake</div>
<div class="line">find_package(PkgConfig QUIET)</div>
<div class="line"> </div>
<div class="line"># ASIO dependency</div>
<div class="line">find_package(asio CONFIG REQUIRED)</div>
<div class="line">if(NOT asio_FOUND)</div>
<div class="line">    message(FATAL_ERROR &quot;ASIO library is required for NetworkSystem&quot;)</div>
<div class="line">endif()</div>
<div class="line"> </div>
<div class="line"># fmt dependency</div>
<div class="line">find_package(fmt CONFIG REQUIRED)</div>
<div class="line">if(NOT fmt_FOUND)</div>
<div class="line">    message(FATAL_ERROR &quot;fmt library is required for NetworkSystem&quot;)</div>
<div class="line">endif()</div>
<div class="line"> </div>
<div class="line"># Check conditional dependencies</div>
<div class="line">if(BUILD_WITH_CONTAINER_SYSTEM)</div>
<div class="line">    find_package(ContainerSystem CONFIG)</div>
<div class="line">    if(NOT ContainerSystem_FOUND)</div>
<div class="line">        message(WARNING &quot;ContainerSystem not found, container integration disabled&quot;)</div>
<div class="line">        set(BUILD_WITH_CONTAINER_SYSTEM OFF)</div>
<div class="line">    endif()</div>
<div class="line">endif()</div>
<div class="line"> </div>
<div class="line">if(BUILD_WITH_THREAD_SYSTEM)</div>
<div class="line">    find_package(ThreadSystem CONFIG)</div>
<div class="line">    if(NOT ThreadSystem_FOUND)</div>
<div class="line">        message(WARNING &quot;ThreadSystem not found, thread integration disabled&quot;)</div>
<div class="line">        set(BUILD_WITH_THREAD_SYSTEM OFF)</div>
<div class="line">    endif()</div>
<div class="line">endif()</div>
<div class="line"> </div>
<div class="line"># Define library target</div>
<div class="line">if(NOT TARGET NetworkSystem::Core)</div>
<div class="line">    add_library(NetworkSystem::Core INTERFACE)</div>
<div class="line">    target_include_directories(NetworkSystem::Core INTERFACE</div>
<div class="line">        ${CMAKE_CURRENT_LIST_DIR}/../include</div>
<div class="line">    )</div>
<div class="line">    target_link_libraries(NetworkSystem::Core INTERFACE</div>
<div class="line">        asio::asio</div>
<div class="line">        fmt::fmt</div>
<div class="line">    )</div>
<div class="line"> </div>
<div class="line">    if(BUILD_WITH_CONTAINER_SYSTEM)</div>
<div class="line">        target_link_libraries(NetworkSystem::Core INTERFACE</div>
<div class="line">            ContainerSystem::Core</div>
<div class="line">        )</div>
<div class="line">        target_compile_definitions(NetworkSystem::Core INTERFACE</div>
<div class="line">            BUILD_WITH_CONTAINER_SYSTEM</div>
<div class="line">        )</div>
<div class="line">    endif()</div>
<div class="line"> </div>
<div class="line">    if(BUILD_WITH_THREAD_SYSTEM)</div>
<div class="line">        target_link_libraries(NetworkSystem::Core INTERFACE</div>
<div class="line">            ThreadSystem::Core</div>
<div class="line">        )</div>
<div class="line">        target_compile_definitions(NetworkSystem::Core INTERFACE</div>
<div class="line">            BUILD_WITH_THREAD_SYSTEM</div>
<div class="line">        )</div>
<div class="line">    endif()</div>
<div class="line">endif()</div>
<div class="line"> </div>
<div class="line"># Set variables</div>
<div class="line">set(NetworkSystem_FOUND TRUE)</div>
<div class="line">set(NetworkSystem_VERSION &quot;2.0.0&quot;)</div>
<div class="line">set(NetworkSystem_INCLUDE_DIRS ${CMAKE_CURRENT_LIST_DIR}/../include)</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md2446"></a>
2. pkg-config File</h3>
<div class="fragment"><div class="line"># network-system.pc.in</div>
<div class="line">prefix=@CMAKE_INSTALL_PREFIX@</div>
<div class="line">exec_prefix=${prefix}</div>
<div class="line">libdir=${exec_prefix}/@CMAKE_INSTALL_LIBDIR@</div>
<div class="line">includedir=${prefix}/@CMAKE_INSTALL_INCLUDEDIR@</div>
<div class="line"> </div>
<div class="line">Name: NetworkSystem</div>
<div class="line">Description: High-performance modular network system</div>
<div class="line">Version: @PROJECT_VERSION@</div>
<div class="line">Requires: asio fmt</div>
<div class="line">Requires.private: @PRIVATE_DEPENDENCIES@</div>
<div class="line">Libs: -L${libdir} -lNetworkSystem</div>
<div class="line">Libs.private: @PRIVATE_LIBS@</div>
<div class="line">Cflags: -I${includedir}</div>
</div><!-- fragment --><hr  />
<h2><a class="anchor" id="autotoc_md2448"></a>
🧪 Test Framework</h2>
<h3><a class="anchor" id="autotoc_md2449"></a>
1. Unit Test Structure</h3>
<div class="fragment"><div class="line"><span class="comment">// tests/unit/core/test_messaging_server.cpp</span></div>
<div class="line"><span class="preprocessor">#include &lt;gtest/gtest.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;network_system/core/messaging_server.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;network_system/core/messaging_client.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;test_utils/network_test_utils.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span>network_system::test {</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>MessagingServerTest : <span class="keyword">public</span> ::testing::Test {</div>
<div class="line"><span class="keyword">protected</span>:</div>
<div class="line">    <span class="keywordtype">void</span> SetUp()<span class="keyword"> override </span>{</div>
<div class="line">        server_config config;</div>
<div class="line">        config.port = test_utils::get_free_port();</div>
<div class="line">        config.max_connections = 10;</div>
<div class="line"> </div>
<div class="line">        server_ = std::make_shared&lt;core::messaging_server&gt;(<span class="stringliteral">&quot;test_server&quot;</span>, config);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Set test handlers</span></div>
<div class="line">        server_-&gt;set_message_handler([<span class="keyword">this</span>](<span class="keyword">auto</span> session, <span class="keyword">const</span> std::string&amp; msg) {</div>
<div class="line">            received_messages_.push_back(msg);</div>
<div class="line">            last_session_ = session;</div>
<div class="line">        });</div>
<div class="line"> </div>
<div class="line">        server_-&gt;set_connect_handler([<span class="keyword">this</span>](<span class="keyword">auto</span> session) {</div>
<div class="line">            connected_sessions_.push_back(session-&gt;session_id());</div>
<div class="line">        });</div>
<div class="line"> </div>
<div class="line">        server_-&gt;set_disconnect_handler([<span class="keyword">this</span>](<span class="keyword">auto</span> session, <span class="keyword">const</span> std::string&amp; reason) {</div>
<div class="line">            disconnected_sessions_.push_back(session-&gt;session_id());</div>
<div class="line">            disconnect_reasons_.push_back(reason);</div>
<div class="line">        });</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> TearDown()<span class="keyword"> override </span>{</div>
<div class="line">        <span class="keywordflow">if</span> (server_ &amp;&amp; server_-&gt;is_running()) {</div>
<div class="line">            server_-&gt;stop_server();</div>
<div class="line">        }</div>
<div class="line">        server_.reset();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    std::shared_ptr&lt;core::messaging_server&gt; server_;</div>
<div class="line">    std::vector&lt;std::string&gt; received_messages_;</div>
<div class="line">    std::vector&lt;std::string&gt; connected_sessions_;</div>
<div class="line">    std::vector&lt;std::string&gt; disconnected_sessions_;</div>
<div class="line">    std::vector&lt;std::string&gt; disconnect_reasons_;</div>
<div class="line">    std::shared_ptr&lt;session::messaging_session&gt; last_session_;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfb/application__layer_2tests_2integration_2test__messaging__integration_8cpp.html#afa9a03b8890cf589bc9d9246e1149b1b">TEST_F</a>(MessagingServerTest, ServerStartStop) {</div>
<div class="line">    EXPECT_FALSE(server_-&gt;is_running());</div>
<div class="line"> </div>
<div class="line">    EXPECT_TRUE(server_-&gt;start_server());</div>
<div class="line">    EXPECT_TRUE(server_-&gt;is_running());</div>
<div class="line"> </div>
<div class="line">    server_-&gt;stop_server();</div>
<div class="line">    EXPECT_FALSE(server_-&gt;is_running());</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfb/application__layer_2tests_2integration_2test__messaging__integration_8cpp.html#afa9a03b8890cf589bc9d9246e1149b1b">TEST_F</a>(MessagingServerTest, ClientConnection) {</div>
<div class="line">    ASSERT_TRUE(server_-&gt;start_server());</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> <a class="code hl_enumvalue" href="../../de/d3f/namespacemonitoring__system.html#a85c35f5354bb46fdd8f4e39a0aa37c9ea62608e08adc29a8d6dbc9754e659f125">client</a> = std::make_shared&lt;core::messaging_client&gt;(<span class="stringliteral">&quot;test_client&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">bool</span> <a class="code hl_enumvalue" href="../../d9/dda/namespacekcenon_1_1messaging_1_1integrations.html#a9709b17de9726ec32bb398f5868ce728a06aa6fa8bdc2078e7e1bd903e70c8f6a">connected</a> = <span class="keyword">false</span>;</div>
<div class="line">    <a class="code hl_enumvalue" href="../../de/d3f/namespacemonitoring__system.html#a85c35f5354bb46fdd8f4e39a0aa37c9ea62608e08adc29a8d6dbc9754e659f125">client</a>-&gt;set_connect_handler([&amp;connected]() {</div>
<div class="line">        <a class="code hl_enumvalue" href="../../d9/dda/namespacekcenon_1_1messaging_1_1integrations.html#a9709b17de9726ec32bb398f5868ce728a06aa6fa8bdc2078e7e1bd903e70c8f6a">connected</a> = <span class="keyword">true</span>;</div>
<div class="line">    });</div>
<div class="line"> </div>
<div class="line">    EXPECT_TRUE(<a class="code hl_enumvalue" href="../../de/d3f/namespacemonitoring__system.html#a85c35f5354bb46fdd8f4e39a0aa37c9ea62608e08adc29a8d6dbc9754e659f125">client</a>-&gt;start_client(<span class="stringliteral">&quot;127.0.0.1&quot;</span>, server_-&gt;port()));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Wait for connection</span></div>
<div class="line">    test_utils::wait_for_condition([&amp;connected]() { <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d9/dda/namespacekcenon_1_1messaging_1_1integrations.html#a9709b17de9726ec32bb398f5868ce728a06aa6fa8bdc2078e7e1bd903e70c8f6a">connected</a>; },</div>
<div class="line">                                   std::chrono::seconds(5));</div>
<div class="line"> </div>
<div class="line">    EXPECT_TRUE(connected);</div>
<div class="line">    EXPECT_EQ(1, connected_sessions_.size());</div>
<div class="line">    EXPECT_EQ(1, server_-&gt;connection_count());</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfb/application__layer_2tests_2integration_2test__messaging__integration_8cpp.html#afa9a03b8890cf589bc9d9246e1149b1b">TEST_F</a>(MessagingServerTest, MessageExchange) {</div>
<div class="line">    ASSERT_TRUE(server_-&gt;start_server());</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> <a class="code hl_enumvalue" href="../../de/d3f/namespacemonitoring__system.html#a85c35f5354bb46fdd8f4e39a0aa37c9ea62608e08adc29a8d6dbc9754e659f125">client</a> = std::make_shared&lt;core::messaging_client&gt;(<span class="stringliteral">&quot;test_client&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    std::string received_message;</div>
<div class="line">    <a class="code hl_enumvalue" href="../../de/d3f/namespacemonitoring__system.html#a85c35f5354bb46fdd8f4e39a0aa37c9ea62608e08adc29a8d6dbc9754e659f125">client</a>-&gt;set_message_handler([&amp;received_message](<span class="keyword">const</span> std::string&amp; msg) {</div>
<div class="line">        received_message = msg;</div>
<div class="line">    });</div>
<div class="line"> </div>
<div class="line">    ASSERT_TRUE(<a class="code hl_enumvalue" href="../../de/d3f/namespacemonitoring__system.html#a85c35f5354bb46fdd8f4e39a0aa37c9ea62608e08adc29a8d6dbc9754e659f125">client</a>-&gt;start_client(<span class="stringliteral">&quot;127.0.0.1&quot;</span>, server_-&gt;port()));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Wait for connection</span></div>
<div class="line">    test_utils::wait_for_condition([<span class="keyword">this</span>]() {</div>
<div class="line">        <span class="keywordflow">return</span> !connected_sessions_.empty();</div>
<div class="line">    }, std::chrono::seconds(5));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Send message from client to server</span></div>
<div class="line">    <span class="keyword">const</span> std::string test_message = <span class="stringliteral">&quot;Hello, Server!&quot;</span>;</div>
<div class="line">    <a class="code hl_enumvalue" href="../../de/d3f/namespacemonitoring__system.html#a85c35f5354bb46fdd8f4e39a0aa37c9ea62608e08adc29a8d6dbc9754e659f125">client</a>-&gt;send_message(test_message);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Wait for message reception</span></div>
<div class="line">    test_utils::wait_for_condition([<span class="keyword">this</span>]() {</div>
<div class="line">        <span class="keywordflow">return</span> !received_messages_.empty();</div>
<div class="line">    }, std::chrono::seconds(5));</div>
<div class="line"> </div>
<div class="line">    EXPECT_EQ(1, received_messages_.size());</div>
<div class="line">    EXPECT_EQ(test_message, received_messages_[0]);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Send response from server to client</span></div>
<div class="line">    <span class="keyword">const</span> std::string response_message = <span class="stringliteral">&quot;Hello, Client!&quot;</span>;</div>
<div class="line">    ASSERT_NE(<span class="keyword">nullptr</span>, last_session_);</div>
<div class="line">    last_session_-&gt;send_message(response_message);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Wait for response reception</span></div>
<div class="line">    test_utils::wait_for_condition([&amp;received_message, &amp;response_message]() {</div>
<div class="line">        <span class="keywordflow">return</span> received_message == response_message;</div>
<div class="line">    }, std::chrono::seconds(5));</div>
<div class="line"> </div>
<div class="line">    EXPECT_EQ(response_message, received_message);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfb/application__layer_2tests_2integration_2test__messaging__integration_8cpp.html#afa9a03b8890cf589bc9d9246e1149b1b">TEST_F</a>(MessagingServerTest, MaxConnectionsLimit) {</div>
<div class="line">    server_config config = server_-&gt;get_config();</div>
<div class="line">    config.max_connections = 2;</div>
<div class="line">    server_-&gt;set_config(config);</div>
<div class="line"> </div>
<div class="line">    ASSERT_TRUE(server_-&gt;start_server());</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create clients up to max connections</span></div>
<div class="line">    std::vector&lt;std::shared_ptr&lt;core::messaging_client&gt;&gt; clients;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; ++i) {</div>
<div class="line">        <span class="keyword">auto</span> <a class="code hl_enumvalue" href="../../de/d3f/namespacemonitoring__system.html#a85c35f5354bb46fdd8f4e39a0aa37c9ea62608e08adc29a8d6dbc9754e659f125">client</a> = std::make_shared&lt;core::messaging_client&gt;(</div>
<div class="line">            <span class="stringliteral">&quot;test_client_&quot;</span> + std::to_string(i));</div>
<div class="line">        clients.push_back(client);</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_enumvalue" href="../../de/d3f/namespacemonitoring__system.html#a85c35f5354bb46fdd8f4e39a0aa37c9ea62608e08adc29a8d6dbc9754e659f125">client</a>-&gt;start_client(<span class="stringliteral">&quot;127.0.0.1&quot;</span>, server_-&gt;port());</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Wait briefly</span></div>
<div class="line">    std::this_thread::sleep_for(std::chrono::milliseconds(100));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Verify max connections not exceeded</span></div>
<div class="line">    EXPECT_LE(server_-&gt;connection_count(), 2);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">} <span class="comment">// namespace network_system::test</span></div>
<div class="ttc" id="aapplication__layer_2tests_2integration_2test__messaging__integration_8cpp_html_afa9a03b8890cf589bc9d9246e1149b1b"><div class="ttname"><a href="../../d9/dfb/application__layer_2tests_2integration_2test__messaging__integration_8cpp.html#afa9a03b8890cf589bc9d9246e1149b1b">TEST_F</a></div><div class="ttdeci">TEST_F(MessagingIntegrationTest, EndToEndMessaging)</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dfb/application__layer_2tests_2integration_2test__messaging__integration_8cpp_source.html#l00038">test_messaging_integration.cpp:38</a></div></div>
<div class="ttc" id="anamespacekcenon_1_1messaging_1_1integrations_html_a9709b17de9726ec32bb398f5868ce728a06aa6fa8bdc2078e7e1bd903e70c8f6a"><div class="ttname"><a href="../../d9/dda/namespacekcenon_1_1messaging_1_1integrations.html#a9709b17de9726ec32bb398f5868ce728a06aa6fa8bdc2078e7e1bd903e70c8f6a">kcenon::messaging::integrations::external_system_status::connected</a></div><div class="ttdeci">@ connected</div></div>
<div class="ttc" id="anamespacemonitoring__system_html_a85c35f5354bb46fdd8f4e39a0aa37c9ea62608e08adc29a8d6dbc9754e659f125"><div class="ttname"><a href="../../de/d3f/namespacemonitoring__system.html#a85c35f5354bb46fdd8f4e39a0aa37c9ea62608e08adc29a8d6dbc9754e659f125">monitoring_system::otel_span_kind::client</a></div><div class="ttdeci">@ client</div></div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md2450"></a>
2. Integration Tests</h3>
<div class="fragment"><div class="line"><span class="comment">// tests/integration/test_container_integration.cpp</span></div>
<div class="line"><span class="preprocessor">#ifdef BUILD_WITH_CONTAINER_SYSTEM</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;gtest/gtest.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../d4/d64/messaging__bridge_8h.html">network_system/integration/messaging_bridge.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;container_system/value_container.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span>network_system::test {</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>ContainerIntegrationTest : <span class="keyword">public</span> ::testing::Test {</div>
<div class="line"><span class="keyword">protected</span>:</div>
<div class="line">    <span class="keywordtype">void</span> SetUp()<span class="keyword"> override </span>{</div>
<div class="line">        bridge_ = std::make_unique&lt;integration::messaging_bridge&gt;(<span class="stringliteral">&quot;test_bridge&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Set container_system factory</span></div>
<div class="line">        <span class="keyword">auto</span> factory = std::make_shared&lt;container_system::value_factory&gt;();</div>
<div class="line">        bridge_-&gt;set_container_factory(factory);</div>
<div class="line">        bridge_-&gt;enable_container_serialization(<span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Set container message handler</span></div>
<div class="line">        bridge_-&gt;set_container_message_handler([<span class="keyword">this</span>](<span class="keyword">auto</span> container) {</div>
<div class="line">            received_containers_.push_back(container);</div>
<div class="line">        });</div>
<div class="line"> </div>
<div class="line">        bridge_-&gt;start();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> TearDown()<span class="keyword"> override </span>{</div>
<div class="line">        <span class="keywordflow">if</span> (bridge_) {</div>
<div class="line">            bridge_-&gt;stop();</div>
<div class="line">        }</div>
<div class="line">        bridge_.reset();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    std::unique_ptr&lt;integration::messaging_bridge&gt; bridge_;</div>
<div class="line">    std::vector&lt;std::shared_ptr&lt;container_system::value_container&gt;&gt; received_containers_;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d9/dfb/application__layer_2tests_2integration_2test__messaging__integration_8cpp.html#afa9a03b8890cf589bc9d9246e1149b1b">TEST_F</a>(ContainerIntegrationTest, ContainerSerialization) {</div>
<div class="line">    <span class="keyword">auto</span> <a class="code hl_enumvalue" href="../../de/d3f/namespacemonitoring__system.html#a85c35f5354bb46fdd8f4e39a0aa37c9eacf1e8c14e54505f60aa10ceb8d5d8ab3">server</a> = bridge_-&gt;create_server(<span class="stringliteral">&quot;test_server&quot;</span>);</div>
<div class="line">    <span class="keyword">auto</span> <a class="code hl_enumvalue" href="../../de/d3f/namespacemonitoring__system.html#a85c35f5354bb46fdd8f4e39a0aa37c9ea62608e08adc29a8d6dbc9754e659f125">client</a> = bridge_-&gt;create_client(<span class="stringliteral">&quot;test_client&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    ASSERT_TRUE(<a class="code hl_enumvalue" href="../../de/d3f/namespacemonitoring__system.html#a85c35f5354bb46fdd8f4e39a0aa37c9eacf1e8c14e54505f60aa10ceb8d5d8ab3">server</a>-&gt;start_server(0)); <span class="comment">// Random port</span></div>
<div class="line">    ASSERT_TRUE(<a class="code hl_enumvalue" href="../../de/d3f/namespacemonitoring__system.html#a85c35f5354bb46fdd8f4e39a0aa37c9ea62608e08adc29a8d6dbc9754e659f125">client</a>-&gt;start_client(<span class="stringliteral">&quot;127.0.0.1&quot;</span>, <a class="code hl_enumvalue" href="../../de/d3f/namespacemonitoring__system.html#a85c35f5354bb46fdd8f4e39a0aa37c9eacf1e8c14e54505f60aa10ceb8d5d8ab3">server</a>-&gt;port()));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create container message</span></div>
<div class="line">    <span class="keyword">auto</span> <a class="code hl_enumvalue" href="../../de/d3f/namespacemonitoring__system.html#a8e692c8ceac634f141c23c45c3491aa8a5f0b6ebc4bea10285ba2b8a6ce78b863">container</a> = std::make_shared&lt;container_system::value_container&gt;();</div>
<div class="line">    <a class="code hl_enumvalue" href="../../de/d3f/namespacemonitoring__system.html#a8e692c8ceac634f141c23c45c3491aa8a5f0b6ebc4bea10285ba2b8a6ce78b863">container</a>-&gt;set_source(<span class="stringliteral">&quot;test_client&quot;</span>, <span class="stringliteral">&quot;main&quot;</span>);</div>
<div class="line">    <a class="code hl_enumvalue" href="../../de/d3f/namespacemonitoring__system.html#a8e692c8ceac634f141c23c45c3491aa8a5f0b6ebc4bea10285ba2b8a6ce78b863">container</a>-&gt;set_target(<span class="stringliteral">&quot;test_server&quot;</span>, <span class="stringliteral">&quot;handler&quot;</span>);</div>
<div class="line">    <a class="code hl_enumvalue" href="../../de/d3f/namespacemonitoring__system.html#a8e692c8ceac634f141c23c45c3491aa8a5f0b6ebc4bea10285ba2b8a6ce78b863">container</a>-&gt;set_message_type(<span class="stringliteral">&quot;test_message&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> values = std::vector&lt;std::shared_ptr&lt;container_system::value&gt;&gt;{</div>
<div class="line">        container_system::value_factory::create(<span class="stringliteral">&quot;text&quot;</span>,</div>
<div class="line">            container_system::string_value, <span class="stringliteral">&quot;Hello, Container!&quot;</span>),</div>
<div class="line">        container_system::value_factory::create(<span class="stringliteral">&quot;number&quot;</span>,</div>
<div class="line">            container_system::int32_value, <span class="stringliteral">&quot;42&quot;</span>)</div>
<div class="line">    };</div>
<div class="line">    <a class="code hl_enumvalue" href="../../de/d3f/namespacemonitoring__system.html#a8e692c8ceac634f141c23c45c3491aa8a5f0b6ebc4bea10285ba2b8a6ce78b863">container</a>-&gt;set_values(values);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Send container</span></div>
<div class="line">    std::string serialized = <a class="code hl_enumvalue" href="../../de/d3f/namespacemonitoring__system.html#a8e692c8ceac634f141c23c45c3491aa8a5f0b6ebc4bea10285ba2b8a6ce78b863">container</a>-&gt;serialize();</div>
<div class="line">    <a class="code hl_enumvalue" href="../../de/d3f/namespacemonitoring__system.html#a85c35f5354bb46fdd8f4e39a0aa37c9ea62608e08adc29a8d6dbc9754e659f125">client</a>-&gt;send_message(serialized);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Wait for reception</span></div>
<div class="line">    test_utils::wait_for_condition([<span class="keyword">this</span>]() {</div>
<div class="line">        <span class="keywordflow">return</span> !received_containers_.empty();</div>
<div class="line">    }, std::chrono::seconds(5));</div>
<div class="line"> </div>
<div class="line">    ASSERT_EQ(1, received_containers_.size());</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> received = received_containers_[0];</div>
<div class="line">    EXPECT_EQ(<span class="stringliteral">&quot;test_message&quot;</span>, received-&gt;message_type());</div>
<div class="line">    EXPECT_EQ(<span class="stringliteral">&quot;test_client&quot;</span>, received-&gt;source_id());</div>
<div class="line">    EXPECT_EQ(<span class="stringliteral">&quot;test_server&quot;</span>, received-&gt;target_id());</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> text_value = received-&gt;get_value(<span class="stringliteral">&quot;text&quot;</span>);</div>
<div class="line">    ASSERT_NE(<span class="keyword">nullptr</span>, text_value);</div>
<div class="line">    EXPECT_EQ(<span class="stringliteral">&quot;Hello, Container!&quot;</span>, text_value-&gt;to_string());</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> number_value = received-&gt;get_value(<span class="stringliteral">&quot;number&quot;</span>);</div>
<div class="line">    ASSERT_NE(<span class="keyword">nullptr</span>, number_value);</div>
<div class="line">    EXPECT_EQ(42, number_value-&gt;to_int32());</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">} <span class="comment">// namespace network_system::test</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#endif </span><span class="comment">// BUILD_WITH_CONTAINER_SYSTEM</span></div>
<div class="ttc" id="amessaging__bridge_8h_html"><div class="ttname"><a href="../../d4/d64/messaging__bridge_8h.html">messaging_bridge.h</a></div><div class="ttdoc">Bridge for messaging_system compatibility.</div></div>
<div class="ttc" id="anamespacemonitoring__system_html_a85c35f5354bb46fdd8f4e39a0aa37c9eacf1e8c14e54505f60aa10ceb8d5d8ab3"><div class="ttname"><a href="../../de/d3f/namespacemonitoring__system.html#a85c35f5354bb46fdd8f4e39a0aa37c9eacf1e8c14e54505f60aa10ceb8d5d8ab3">monitoring_system::otel_span_kind::server</a></div><div class="ttdeci">@ server</div></div>
<div class="ttc" id="anamespacemonitoring__system_html_a8e692c8ceac634f141c23c45c3491aa8a5f0b6ebc4bea10285ba2b8a6ce78b863"><div class="ttname"><a href="../../de/d3f/namespacemonitoring__system.html#a8e692c8ceac634f141c23c45c3491aa8a5f0b6ebc4bea10285ba2b8a6ce78b863">monitoring_system::otel_resource_type::container</a></div><div class="ttdeci">@ container</div></div>
</div><!-- fragment --><hr  />
<h2><a class="anchor" id="autotoc_md2452"></a>
📊 Performance Monitoring</h2>
<h3><a class="anchor" id="autotoc_md2453"></a>
1. Performance Metric Collection</h3>
<div class="fragment"><div class="line"><span class="comment">// include/network_system/utils/performance_monitor.h</span></div>
<div class="line"><span class="preprocessor">#pragma once</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;atomic&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;chrono&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;unordered_map&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span>network_system::utils {</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>performance_monitor {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">struct </span>metrics {</div>
<div class="line">        <span class="comment">// Connection metrics</span></div>
<div class="line">        std::atomic&lt;uint64_t&gt; total_connections{0};</div>
<div class="line">        std::atomic&lt;uint64_t&gt; active_connections{0};</div>
<div class="line">        std::atomic&lt;uint64_t&gt; failed_connections{0};</div>
<div class="line">        std::atomic&lt;uint64_t&gt; connections_per_second{0};</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Message metrics</span></div>
<div class="line">        std::atomic&lt;uint64_t&gt; messages_sent{0};</div>
<div class="line">        std::atomic&lt;uint64_t&gt; messages_received{0};</div>
<div class="line">        std::atomic&lt;uint64_t&gt; messages_per_second{0};</div>
<div class="line">        std::atomic&lt;uint64_t&gt; bytes_sent{0};</div>
<div class="line">        std::atomic&lt;uint64_t&gt; bytes_received{0};</div>
<div class="line">        std::atomic&lt;uint64_t&gt; bytes_per_second{0};</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Latency metrics (microseconds)</span></div>
<div class="line">        std::atomic&lt;uint64_t&gt; avg_latency_us{0};</div>
<div class="line">        std::atomic&lt;uint64_t&gt; min_latency_us{UINT64_MAX};</div>
<div class="line">        std::atomic&lt;uint64_t&gt; max_latency_us{0};</div>
<div class="line">        std::atomic&lt;uint64_t&gt; p95_latency_us{0};</div>
<div class="line">        std::atomic&lt;uint64_t&gt; p99_latency_us{0};</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Error metrics</span></div>
<div class="line">        std::atomic&lt;uint64_t&gt; send_errors{0};</div>
<div class="line">        std::atomic&lt;uint64_t&gt; receive_errors{0};</div>
<div class="line">        std::atomic&lt;uint64_t&gt; timeout_errors{0};</div>
<div class="line">        std::atomic&lt;uint64_t&gt; connection_errors{0};</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Memory metrics</span></div>
<div class="line">        std::atomic&lt;uint64_t&gt; memory_usage_bytes{0};</div>
<div class="line">        std::atomic&lt;uint64_t&gt; buffer_pool_size{0};</div>
<div class="line">        std::atomic&lt;uint64_t&gt; peak_memory_usage{0};</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Time information</span></div>
<div class="line">        std::chrono::steady_clock::time_point start_time;</div>
<div class="line">        std::chrono::steady_clock::time_point last_update;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Calculate uptime</span></div>
<div class="line">        std::chrono::milliseconds uptime()<span class="keyword"> const </span>{</div>
<div class="line">            <span class="keywordflow">return</span> std::chrono::duration_cast&lt;std::chrono::milliseconds&gt;(</div>
<div class="line">                std::chrono::steady_clock::now() - start_time);</div>
<div class="line">        }</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">static</span> performance_monitor&amp; instance();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Update metrics</span></div>
<div class="line">    <span class="keywordtype">void</span> record_connection(<span class="keywordtype">bool</span> success);</div>
<div class="line">    <span class="keywordtype">void</span> record_disconnection();</div>
<div class="line">    <span class="keywordtype">void</span> record_message_sent(<span class="keywordtype">size_t</span> bytes);</div>
<div class="line">    <span class="keywordtype">void</span> record_message_received(<span class="keywordtype">size_t</span> bytes);</div>
<div class="line">    <span class="keywordtype">void</span> record_latency(std::chrono::microseconds latency);</div>
<div class="line">    <span class="keywordtype">void</span> record_error(<span class="keyword">const</span> std::string&amp; error_type);</div>
<div class="line">    <span class="keywordtype">void</span> record_memory_usage(<span class="keywordtype">size_t</span> bytes);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Query metrics</span></div>
<div class="line">    metrics get_metrics() <span class="keyword">const</span>;</div>
<div class="line">    <span class="keywordtype">void</span> reset_metrics();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Real-time statistics calculation</span></div>
<div class="line">    <span class="keywordtype">void</span> update_realtime_stats();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Export metrics as JSON</span></div>
<div class="line">    std::string to_json() <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Generate performance report</span></div>
<div class="line">    std::string generate_report() <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    performance_monitor();</div>
<div class="line">    ~performance_monitor() = <span class="keywordflow">default</span>;</div>
<div class="line"> </div>
<div class="line">    performance_monitor(<span class="keyword">const</span> performance_monitor&amp;) = <span class="keyword">delete</span>;</div>
<div class="line">    performance_monitor&amp; operator=(<span class="keyword">const</span> performance_monitor&amp;) = <span class="keyword">delete</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">class </span>impl;</div>
<div class="line">    std::unique_ptr&lt;impl&gt; pimpl_;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">} <span class="comment">// namespace network_system::utils</span></div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md2454"></a>
2. Benchmark Tools</h3>
<div class="fragment"><div class="line"><span class="comment">// tests/performance/benchmark_network_performance.cpp</span></div>
<div class="line"><span class="preprocessor">#include &lt;benchmark/benchmark.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;network_system/core/messaging_server.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;network_system/core/messaging_client.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span>network_system::benchmark {</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>NetworkBenchmark {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    NetworkBenchmark() {</div>
<div class="line">        server_ = std::make_shared&lt;core::messaging_server&gt;(<span class="stringliteral">&quot;bench_server&quot;</span>);</div>
<div class="line">        server_-&gt;set_message_handler([](<span class="keyword">auto</span> session, <span class="keyword">const</span> std::string&amp; msg) {</div>
<div class="line">            <span class="comment">// Echo server</span></div>
<div class="line">            session-&gt;send_message(msg);</div>
<div class="line">        });</div>
<div class="line"> </div>
<div class="line">        server_-&gt;start_server(0); <span class="comment">// Random port</span></div>
<div class="line">        port_ = server_-&gt;port();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    ~NetworkBenchmark() {</div>
<div class="line">        server_-&gt;stop_server();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> get_port()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> port_; }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    std::shared_ptr&lt;core::messaging_server&gt; server_;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> port_;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> NetworkBenchmark* g_benchmark = <span class="keyword">nullptr</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> BM_SingleClientEcho(::benchmark::State&amp; state) {</div>
<div class="line">    <span class="keywordflow">if</span> (!g_benchmark) {</div>
<div class="line">        g_benchmark = <span class="keyword">new</span> NetworkBenchmark();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> <a class="code hl_enumvalue" href="../../de/d3f/namespacemonitoring__system.html#a85c35f5354bb46fdd8f4e39a0aa37c9ea62608e08adc29a8d6dbc9754e659f125">client</a> = std::make_shared&lt;core::messaging_client&gt;(<span class="stringliteral">&quot;bench_client&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    std::atomic&lt;int&gt; received_count{0};</div>
<div class="line">    <a class="code hl_enumvalue" href="../../de/d3f/namespacemonitoring__system.html#a85c35f5354bb46fdd8f4e39a0aa37c9ea62608e08adc29a8d6dbc9754e659f125">client</a>-&gt;set_message_handler([&amp;received_count](<span class="keyword">const</span> std::string&amp;) {</div>
<div class="line">        received_count++;</div>
<div class="line">    });</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_enumvalue" href="../../de/d3f/namespacemonitoring__system.html#a85c35f5354bb46fdd8f4e39a0aa37c9ea62608e08adc29a8d6dbc9754e659f125">client</a>-&gt;start_client(<span class="stringliteral">&quot;127.0.0.1&quot;</span>, g_benchmark-&gt;get_port());</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Wait for connection</span></div>
<div class="line">    std::this_thread::sleep_for(std::chrono::milliseconds(10));</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> std::string message = <span class="stringliteral">&quot;benchmark_message&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> _ : state) {</div>
<div class="line">        <a class="code hl_enumvalue" href="../../de/d3f/namespacemonitoring__system.html#a85c35f5354bb46fdd8f4e39a0aa37c9ea62608e08adc29a8d6dbc9754e659f125">client</a>-&gt;send_message(message);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Wait for response</span></div>
<div class="line">        <span class="keyword">auto</span> start = std::chrono::steady_clock::now();</div>
<div class="line">        <span class="keywordflow">while</span> (received_count.load() == 0) {</div>
<div class="line">            <span class="keyword">auto</span> now = std::chrono::steady_clock::now();</div>
<div class="line">            <span class="keywordflow">if</span> (now - start &gt; std::chrono::seconds(1)) {</div>
<div class="line">                state.SkipWithError(<span class="stringliteral">&quot;Timeout waiting for response&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line">            std::this_thread::sleep_for(std::chrono::microseconds(1));</div>
<div class="line">        }</div>
<div class="line">        received_count--;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    state.SetItemsProcessed(state.iterations());</div>
<div class="line">    state.SetBytesProcessed(state.iterations() * message.size() * 2); <span class="comment">// Send+receive</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> BM_MultipleClientsEcho(::benchmark::State&amp; state) {</div>
<div class="line">    <span class="keywordflow">if</span> (!g_benchmark) {</div>
<div class="line">        g_benchmark = <span class="keyword">new</span> NetworkBenchmark();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> num_clients = state.range(0);</div>
<div class="line">    std::vector&lt;std::shared_ptr&lt;core::messaging_client&gt;&gt; clients;</div>
<div class="line">    std::atomic&lt;int&gt; total_received{0};</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create and connect clients</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num_clients; ++i) {</div>
<div class="line">        <span class="keyword">auto</span> <a class="code hl_enumvalue" href="../../de/d3f/namespacemonitoring__system.html#a85c35f5354bb46fdd8f4e39a0aa37c9ea62608e08adc29a8d6dbc9754e659f125">client</a> = std::make_shared&lt;core::messaging_client&gt;(</div>
<div class="line">            <span class="stringliteral">&quot;bench_client_&quot;</span> + std::to_string(i));</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_enumvalue" href="../../de/d3f/namespacemonitoring__system.html#a85c35f5354bb46fdd8f4e39a0aa37c9ea62608e08adc29a8d6dbc9754e659f125">client</a>-&gt;set_message_handler([&amp;total_received](<span class="keyword">const</span> std::string&amp;) {</div>
<div class="line">            total_received++;</div>
<div class="line">        });</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_enumvalue" href="../../de/d3f/namespacemonitoring__system.html#a85c35f5354bb46fdd8f4e39a0aa37c9ea62608e08adc29a8d6dbc9754e659f125">client</a>-&gt;start_client(<span class="stringliteral">&quot;127.0.0.1&quot;</span>, g_benchmark-&gt;get_port());</div>
<div class="line">        clients.push_back(client);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Wait for all clients to connect</span></div>
<div class="line">    std::this_thread::sleep_for(std::chrono::milliseconds(100));</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> std::string message = <span class="stringliteral">&quot;benchmark_message&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> _ : state) {</div>
<div class="line">        <span class="comment">// Send messages from all clients simultaneously</span></div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; client : clients) {</div>
<div class="line">            <a class="code hl_enumvalue" href="../../de/d3f/namespacemonitoring__system.html#a85c35f5354bb46fdd8f4e39a0aa37c9ea62608e08adc29a8d6dbc9754e659f125">client</a>-&gt;send_message(message);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Wait for all responses</span></div>
<div class="line">        <span class="keyword">auto</span> start = std::chrono::steady_clock::now();</div>
<div class="line">        <span class="keywordflow">while</span> (total_received.load() &lt; num_clients) {</div>
<div class="line">            <span class="keyword">auto</span> now = std::chrono::steady_clock::now();</div>
<div class="line">            <span class="keywordflow">if</span> (now - start &gt; std::chrono::seconds(5)) {</div>
<div class="line">                state.SkipWithError(<span class="stringliteral">&quot;Timeout waiting for responses&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line">            std::this_thread::sleep_for(std::chrono::microseconds(10));</div>
<div class="line">        }</div>
<div class="line">        total_received -= num_clients;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    state.SetItemsProcessed(state.iterations() * num_clients);</div>
<div class="line">    state.SetBytesProcessed(state.iterations() * num_clients * message.size() * 2);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> BM_LargeMessageTransfer(::benchmark::State&amp; state) {</div>
<div class="line">    <span class="keywordflow">if</span> (!g_benchmark) {</div>
<div class="line">        g_benchmark = <span class="keyword">new</span> NetworkBenchmark();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> <a class="code hl_enumvalue" href="../../de/d3f/namespacemonitoring__system.html#a85c35f5354bb46fdd8f4e39a0aa37c9ea62608e08adc29a8d6dbc9754e659f125">client</a> = std::make_shared&lt;core::messaging_client&gt;(<span class="stringliteral">&quot;bench_client&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    std::atomic&lt;bool&gt; received{<span class="keyword">false</span>};</div>
<div class="line">    <a class="code hl_enumvalue" href="../../de/d3f/namespacemonitoring__system.html#a85c35f5354bb46fdd8f4e39a0aa37c9ea62608e08adc29a8d6dbc9754e659f125">client</a>-&gt;set_message_handler([&amp;received](<span class="keyword">const</span> std::string&amp;) {</div>
<div class="line">        received = <span class="keyword">true</span>;</div>
<div class="line">    });</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_enumvalue" href="../../de/d3f/namespacemonitoring__system.html#a85c35f5354bb46fdd8f4e39a0aa37c9ea62608e08adc29a8d6dbc9754e659f125">client</a>-&gt;start_client(<span class="stringliteral">&quot;127.0.0.1&quot;</span>, g_benchmark-&gt;get_port());</div>
<div class="line">    std::this_thread::sleep_for(std::chrono::milliseconds(10));</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">size_t</span> message_size = state.range(0);</div>
<div class="line">    <span class="keyword">const</span> std::string message(message_size, <span class="charliteral">&#39;X&#39;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> _ : state) {</div>
<div class="line">        received = <span class="keyword">false</span>;</div>
<div class="line">        <a class="code hl_enumvalue" href="../../de/d3f/namespacemonitoring__system.html#a85c35f5354bb46fdd8f4e39a0aa37c9ea62608e08adc29a8d6dbc9754e659f125">client</a>-&gt;send_message(message);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Wait for response</span></div>
<div class="line">        <span class="keyword">auto</span> start = std::chrono::steady_clock::now();</div>
<div class="line">        <span class="keywordflow">while</span> (!received.load()) {</div>
<div class="line">            <span class="keyword">auto</span> now = std::chrono::steady_clock::now();</div>
<div class="line">            <span class="keywordflow">if</span> (now - start &gt; std::chrono::seconds(5)) {</div>
<div class="line">                state.SkipWithError(<span class="stringliteral">&quot;Timeout waiting for response&quot;</span>);</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line">            std::this_thread::sleep_for(std::chrono::microseconds(10));</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    state.SetItemsProcessed(state.iterations());</div>
<div class="line">    state.SetBytesProcessed(state.iterations() * message_size * 2);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Register benchmarks</span></div>
<div class="line"><a class="code hl_function" href="../../da/dee/container__system_2tests_2benchmark__tests_8cpp.html#aa9aad26a36e5d915b00c94a95f68add2">BENCHMARK</a>(BM_SingleClientEcho)</div>
<div class="line">    -&gt;Unit(::benchmark::kMicrosecond)</div>
<div class="line">    -&gt;Iterations(10000);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../da/dee/container__system_2tests_2benchmark__tests_8cpp.html#aa9aad26a36e5d915b00c94a95f68add2">BENCHMARK</a>(BM_MultipleClientsEcho)</div>
<div class="line">    -&gt;Unit(::benchmark::kMicrosecond)</div>
<div class="line">    -&gt;Arg(1)-&gt;Arg(10)-&gt;Arg(50)-&gt;Arg(100)</div>
<div class="line">    -&gt;Iterations(1000);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../da/dee/container__system_2tests_2benchmark__tests_8cpp.html#aa9aad26a36e5d915b00c94a95f68add2">BENCHMARK</a>(BM_LargeMessageTransfer)</div>
<div class="line">    -&gt;Unit(::benchmark::kMicrosecond)</div>
<div class="line">    -&gt;Arg(1024)-&gt;Arg(8192)-&gt;Arg(65536)-&gt;Arg(1048576)</div>
<div class="line">    -&gt;Iterations(100);</div>
<div class="line"> </div>
<div class="line">} <span class="comment">// namespace network_system::benchmark</span></div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../da/dee/container__system_2tests_2benchmark__tests_8cpp.html#a5851750faa9cfec10f7cad1f3b89697e">BENCHMARK_MAIN</a>();</div>
<div class="ttc" id="acontainer__system_2tests_2benchmark__tests_8cpp_html_a5851750faa9cfec10f7cad1f3b89697e"><div class="ttname"><a href="../../da/dee/container__system_2tests_2benchmark__tests_8cpp.html#a5851750faa9cfec10f7cad1f3b89697e">BENCHMARK_MAIN</a></div><div class="ttdeci">BENCHMARK_MAIN()</div></div>
<div class="ttc" id="acontainer__system_2tests_2benchmark__tests_8cpp_html_aa9aad26a36e5d915b00c94a95f68add2"><div class="ttname"><a href="../../da/dee/container__system_2tests_2benchmark__tests_8cpp.html#aa9aad26a36e5d915b00c94a95f68add2">BENCHMARK</a></div><div class="ttdeci">BENCHMARK(BM_ValueCreation_Null)</div></div>
</div><!-- fragment --><hr  />
<p>This technical implementation details document provides a comprehensive guide for the <a class="el" href="../../d3/da6/namespacenetwork__system.html" title="Main namespace for all Network System components.">network_system</a> separation work. The next step would be to create migration scripts. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
