<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Messaging System: ADR-001: 로깅 아키텍처 - ILogger 인터페이스 vs logger_system</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Messaging System<span id="projectnumber">&#160;1.0.0</span>
   </div>
   <div id="projectbrief">High-Performance Cross-Platform Messaging Framework</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('dd/da0/md_docs_2adr_2001-logging-architecture__KO.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">ADR-001: 로깅 아키텍처 - ILogger 인터페이스 vs logger_system</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md26"></a> </p>
<h1><a class="anchor" id="autotoc_md27"></a>
상태</h1>
<p><b>승인됨</b> - 현재 구현이 올바름</p>
<h1><a class="anchor" id="autotoc_md28"></a>
배경</h1>
<p>messaging_system 프로젝트는 코드베이스 전반에 걸쳐 로깅을 사용합니다. 이 ADR은 로깅 통합 방식과 <code>common_system::ILogger</code> 및 <code>logger_system</code> 간의 관계에 대한 아키텍처 결정을 문서화합니다.</p>
<h2><a class="anchor" id="autotoc_md29"></a>
배경 설명</h2>
<p>프로젝트는 초기에 로깅 기능을 위해 <code>logger_system</code>에 직접 의존했습니다. 이로 인해 강한 결합과 잠재적인 순환 의존성 문제가 발생했으며, 특히 <code>thread_system</code>과 <code>logger_system</code> 사이에서 문제가 되었습니다.</p>
<h2><a class="anchor" id="autotoc_md30"></a>
문제 정의</h2>
<ol type="1">
<li><code>logger_system</code>에 대한 직접 의존성으로 인한 강한 결합</li>
<li>핵심 시스템 간 순환 의존성 가능성</li>
<li>테스트 시 전체 logger_system 초기화 필요</li>
<li>로깅이 필요 없는 애플리케이션도 전체 로거 구현을 포함해야 함</li>
</ol>
<h1><a class="anchor" id="autotoc_md31"></a>
결정</h1>
<p><code>logger_system</code> 직접 의존성 대신 <code>GlobalLoggerRegistry</code>를 통한 런타임 바인딩과 함께 <code>common_system::ILogger</code> 인터페이스를 사용합니다.</p>
<h2><a class="anchor" id="autotoc_md32"></a>
아키텍처 개요</h2>
<div class="fragment"><div class="line">messaging_system</div>
<div class="line">    |</div>
<div class="line">    v</div>
<div class="line">common::logging::log_info/error/debug (편의 함수)</div>
<div class="line">    |</div>
<div class="line">    v</div>
<div class="line">GlobalLoggerRegistry::instance() (스레드 안전 싱글톤)</div>
<div class="line">    |</div>
<div class="line">    v</div>
<div class="line">common::interfaces::ILogger (추상 인터페이스)</div>
<div class="line">    |</div>
<div class="line">    v (선택적 런타임 바인딩)</div>
<div class="line">logger_system::logger (구체적 구현)</div>
<div class="line">    |</div>
<div class="line">    v</div>
<div class="line">logger_adapter (ILogger 어댑터)</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md33"></a>
구현 세부사항</h2>
<h3><a class="anchor" id="autotoc_md34"></a>
1. ILogger 인터페이스 (&lt;tt&gt;common_system&lt;/tt&gt;)</h3>
<p>위치: <code>common_system/include/kcenon/common/interfaces/logger_interface.h</code></p>
<div class="fragment"><div class="line"><span class="keyword">class </span>ILogger {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> log(log_level level, std::string_view message,</div>
<div class="line">                     <span class="keyword">const</span> source_location&amp; loc = source_location::current()) = 0;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> log(<span class="keyword">const</span> log_entry&amp; entry) = 0;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> is_enabled(log_level level) <span class="keyword">const</span> = 0;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> set_level(log_level level) = 0;</div>
<div class="line">    <span class="keyword">virtual</span> log_level get_level() <span class="keyword">const</span> = 0;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> flush() = 0;</div>
<div class="line">};</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md35"></a>
2. GlobalLoggerRegistry (&lt;tt&gt;common_system&lt;/tt&gt;)</h3>
<p>위치: <code>common_system/include/kcenon/common/interfaces/global_logger_registry.h</code></p>
<p>기능:</p><ul>
<li>스레드 안전 싱글톤 (Meyer's 싱글톤 패턴)</li>
<li><code>register_logger()</code>, <code>get_logger()</code>를 통한 명명된 로거 관리</li>
<li><code>set_default_logger()</code>, <code>get_default_logger()</code>를 통한 기본 로거 관리</li>
<li><code>register_factory()</code>를 통한 팩토리 기반 지연 초기화</li>
<li>로거 없이도 안전한 작동을 위한 NullLogger 폴백</li>
</ul>
<h3><a class="anchor" id="autotoc_md36"></a>
3. 편의 함수 (&lt;tt&gt;common_system&lt;/tt&gt;)</h3>
<p>위치: <code>common_system/include/kcenon/common/logging/log_functions.h</code></p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>common::logging {</div>
<div class="line">    <span class="keywordtype">void</span> log_info(<span class="keyword">const</span> std::string&amp; message);</div>
<div class="line">    <span class="keywordtype">void</span> log_error(<span class="keyword">const</span> std::string&amp; message);</div>
<div class="line">    <span class="keywordtype">void</span> log_debug(<span class="keyword">const</span> std::string&amp; message);</div>
<div class="line">    <span class="keywordtype">void</span> log_warning(<span class="keyword">const</span> std::string&amp; message);</div>
<div class="line">    <span class="keywordtype">void</span> log_trace(<span class="keyword">const</span> std::string&amp; message);</div>
<div class="line">    <span class="keywordtype">void</span> log_critical(<span class="keyword">const</span> std::string&amp; message);</div>
<div class="line">}</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md37"></a>
4. CMake 의존성 구성</h3>
<p>위치: <code>messaging_system/CMakeLists.txt</code> (126-128행)</p>
<div class="fragment"><div class="line"># NOTE: logger_system is no longer a direct dependency (Issue #94).</div>
<div class="line"># Logging is now provided through common_system&#39;s ILogger interface</div>
<div class="line"># with runtime binding via GlobalLoggerRegistry.</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md38"></a>
결과</h1>
<h2><a class="anchor" id="autotoc_md39"></a>
긍정적</h2>
<ol type="1">
<li><b>제로 결합</b>: messaging_system은 logger_system에 대한 컴파일 타임 의존성이 없음</li>
<li><b>선택적 통합</b>: logger_system 설치 여부와 관계없이 작동</li>
<li><b>안전한 기본값</b>: 로거가 구성되지 않았을 때 NullLogger가 널 포인터 충돌 방지</li>
<li><b>유연한 바인딩</b>: 런타임에 다른 ILogger 구현을 바인딩 가능</li>
<li><b>순환 의존성 해결</b>: thread_system &lt;-&gt; logger_system 사이클 해소</li>
<li><b>테스트 용이성</b>: 전체 로거 초기화 없이 단위 테스트 실행 가능</li>
<li><b>바이너리 크기 감소</b>: 로깅을 사용하지 않는 애플리케이션은 logger_system을 포함하지 않음</li>
</ol>
<h2><a class="anchor" id="autotoc_md40"></a>
부정적</h2>
<ol type="1">
<li><b>런타임 오버헤드</b>: 직접 호출 대신 가상 함수 호출 (최소한의 영향)</li>
<li><b>구성 복잡성</b>: 애플리케이션 시작 시 명시적 로거 등록 필요</li>
<li><b>기능 제한</b>: 일부 logger_system 전용 기능은 직접 의존성 필요</li>
</ol>
<h2><a class="anchor" id="autotoc_md41"></a>
중립적</h2>
<ol type="1">
<li><b>문서화 필요</b>: 아키텍처에 대한 명확한 문서화 필요 (이 ADR)</li>
<li><b>마이그레이션 노력</b>: logger_system을 직접 사용하는 기존 코드 리팩토링 필요</li>
</ol>
<h1><a class="anchor" id="autotoc_md42"></a>
고려된 대안</h1>
<h2><a class="anchor" id="autotoc_md43"></a>
대안 A: logger_system 직접 의존성</h2>
<p><b>거부됨</b> 이유:</p><ul>
<li>강한 결합 생성</li>
<li>선택적 로깅 방지</li>
<li>순환 의존성 문제 발생</li>
</ul>
<h2><a class="anchor" id="autotoc_md44"></a>
대안 B: 템플릿을 통한 컴파일 타임 로거 선택</h2>
<p><b>거부됨</b> 이유:</p><ul>
<li>바이너리 크기 증가 (템플릿 인스턴스화)</li>
<li>런타임 구성 유연성 감소</li>
<li>더 복잡한 API</li>
</ul>
<h2><a class="anchor" id="autotoc_md45"></a>
대안 C: 매크로 기반 로깅</h2>
<p><b>거부됨</b> 이유:</p><ul>
<li>타입 안전성 부족</li>
<li>유지보수 어려움</li>
<li>C++20 기능과의 통합 어려움</li>
</ul>
<h1><a class="anchor" id="autotoc_md46"></a>
준수 사항</h1>
<h2><a class="anchor" id="autotoc_md47"></a>
현재 구현 상태</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">요구사항   </th><th class="markdownTableHeadNone">상태   </th><th class="markdownTableHeadNone">비고    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">ILogger 인터페이스 사용   </td><td class="markdownTableBodyNone">완료   </td><td class="markdownTableBodyNone">모든 로깅이 편의 함수를 통함    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">logger_system 직접 의존성 없음   </td><td class="markdownTableBodyNone">완료   </td><td class="markdownTableBodyNone">CMakeLists.txt 확인됨    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">GlobalLoggerRegistry 통합   </td><td class="markdownTableBodyNone">완료   </td><td class="markdownTableBodyNone">스레드 안전 싱글톤    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">NullLogger 폴백   </td><td class="markdownTableBodyNone">완료   </td><td class="markdownTableBodyNone">안전한 기본 동작    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">소스 위치 지원   </td><td class="markdownTableBodyNone">완료   </td><td class="markdownTableBodyNone">C++20 source_location   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md48"></a>
messaging_system에서의 사용 예시</h2>
<div class="fragment"><div class="line"><span class="comment">// src/impl/core/message_bus.cpp</span></div>
<div class="line"><span class="preprocessor">#include &lt;kcenon/common/logging/log_functions.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> message_bus::start() {</div>
<div class="line">    common::logging::log_info(<span class="stringliteral">&quot;Starting message bus with &quot;</span> +</div>
<div class="line">                               std::to_string(worker_count) + <span class="stringliteral">&quot; workers&quot;</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> message_bus::on_error(<span class="keyword">const</span> std::string&amp; error) {</div>
<div class="line">    common::logging::log_error(<span class="stringliteral">&quot;Failed to process message: &quot;</span> + error);</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md49"></a>
관련 결정</h1>
<ul>
<li><b>Issue #94</b>: logger_system 직접 의존성에서 마이그레이션</li>
<li><b>Issue #139</b>: 스레드 풀 아키텍처 결정 (유사한 패턴)</li>
</ul>
<h1><a class="anchor" id="autotoc_md50"></a>
참조</h1>
<ul>
<li><code>common_system/include/kcenon/common/interfaces/logger_interface.h</code></li>
<li><code>common_system/include/kcenon/common/interfaces/global_logger_registry.h</code></li>
<li><code>common_system/include/kcenon/common/logging/log_functions.h</code></li>
<li><code>messaging_system/CMakeLists.txt</code></li>
<li><code>messaging_system/include/kcenon/messaging/utils/integration_detector.h</code></li>
</ul>
<h1><a class="anchor" id="autotoc_md51"></a>
수정 이력</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">날짜   </th><th class="markdownTableHeadNone">버전   </th><th class="markdownTableHeadNone">작성자   </th><th class="markdownTableHeadNone">변경사항    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2025-12-10   </td><td class="markdownTableBodyNone">1.0   </td><td class="markdownTableBodyNone">-   </td><td class="markdownTableBodyNone">초기 ADR 작성   </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
